<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰ç«¯åŠŸèƒ½å•å…ƒæµ‹è¯•</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
        }
        .test-pass {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .test-fail {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .test-summary {
            font-weight: bold;
            font-size: 1.2em;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ° Cube Castle - å‰ç«¯å•å…ƒæµ‹è¯•</h1>
        <p>è¿è¡Œå‰ç«¯JavaScriptåŠŸèƒ½çš„å•å…ƒæµ‹è¯•</p>
        
        <button onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        
        <div id="testResults"></div>
        <div id="testSummary"></div>
    </div>

    <script>
        // æµ‹è¯•ç»“æœè®°å½•
        let testResults = [];
        
        // æµ‹è¯•è¾…åŠ©å‡½æ•°
        function assert(condition, message) {
            if (condition) {
                testResults.push({ pass: true, message: `âœ… ${message}` });
            } else {
                testResults.push({ pass: false, message: `âŒ ${message}` });
            }
        }
        
        function assertEqual(actual, expected, message) {
            assert(actual === expected, `${message} - æœŸæœ›: ${expected}, å®é™…: ${actual}`);
        }
        
        function assertNotNull(value, message) {
            assert(value !== null && value !== undefined, `${message} - å€¼ä¸åº”ä¸ºç©º`);
        }
        
        function assertType(value, expectedType, message) {
            assert(typeof value === expectedType, `${message} - æœŸæœ›ç±»å‹: ${expectedType}, å®é™…ç±»å‹: ${typeof value}`);
        }
        
        // æµ‹è¯•1: æµ‹è¯•å…¨å±€å˜é‡å’Œå¸¸é‡
        function testGlobalVariables() {
            console.log('å¼€å§‹æµ‹è¯•å…¨å±€å˜é‡...');
            
            // æµ‹è¯•æµè§ˆå™¨ç¯å¢ƒå˜é‡
            assertNotNull(window, 'æ£€æŸ¥windowå¯¹è±¡å­˜åœ¨');
            assertNotNull(document, 'æ£€æŸ¥documentå¯¹è±¡å­˜åœ¨');
            assertNotNull(fetch, 'æ£€æŸ¥fetch APIå­˜åœ¨');
            
            // æµ‹è¯•åŸºæœ¬æ•°æ®ç±»å‹
            assertEqual(typeof 'test', 'string', 'æµ‹è¯•å­—ç¬¦ä¸²ç±»å‹');
            assertEqual(typeof 123, 'number', 'æµ‹è¯•æ•°å­—ç±»å‹');
            assertEqual(typeof true, 'boolean', 'æµ‹è¯•å¸ƒå°”ç±»å‹');
        }
        
        // æµ‹è¯•2: æµ‹è¯•JSONå¤„ç†åŠŸèƒ½
        function testJSONHandling() {
            console.log('å¼€å§‹æµ‹è¯•JSONå¤„ç†...');
            
            const testData = {
                employee_number: 'EMP12345',
                first_name: 'å¼ ä¸‰',
                last_name: 'æ',
                email: 'zhangsan@example.com'
            };
            
            // æµ‹è¯•JSONåºåˆ—åŒ–
            let jsonString;
            try {
                jsonString = JSON.stringify(testData);
                assert(true, 'JSONåºåˆ—åŒ–æˆåŠŸ');
                assertType(jsonString, 'string', 'JSONåºåˆ—åŒ–ç»“æœç±»å‹');
            } catch (error) {
                assert(false, `JSONåºåˆ—åŒ–å¤±è´¥: ${error.message}`);
            }
            
            // æµ‹è¯•JSONååºåˆ—åŒ–
            try {
                const parsed = JSON.parse(jsonString);
                assert(true, 'JSONååºåˆ—åŒ–æˆåŠŸ');
                assertEqual(parsed.employee_number, testData.employee_number, 'JSONååºåˆ—åŒ–æ•°æ®æ­£ç¡®æ€§');
                assertEqual(parsed.email, testData.email, 'JSONååºåˆ—åŒ–é‚®ç®±å­—æ®µ');
            } catch (error) {
                assert(false, `JSONååºåˆ—åŒ–å¤±è´¥: ${error.message}`);
            }
        }
        
        // æµ‹è¯•3: æµ‹è¯•DOMæ“ä½œåŠŸèƒ½
        function testDOMOperations() {
            console.log('å¼€å§‹æµ‹è¯•DOMæ“ä½œ...');
            
            // åˆ›å»ºæµ‹è¯•å…ƒç´ 
            const testDiv = document.createElement('div');
            testDiv.id = 'testElement';
            testDiv.innerHTML = 'æµ‹è¯•å†…å®¹';
            document.body.appendChild(testDiv);
            
            // æµ‹è¯•å…ƒç´ æŸ¥æ‰¾
            const foundElement = document.getElementById('testElement');
            assertNotNull(foundElement, 'é€šè¿‡IDæŸ¥æ‰¾DOMå…ƒç´ ');
            assertEqual(foundElement.innerHTML, 'æµ‹è¯•å†…å®¹', 'DOMå…ƒç´ å†…å®¹æ­£ç¡®');
            
            // æµ‹è¯•å…ƒç´ ä¿®æ”¹
            foundElement.innerHTML = 'ä¿®æ”¹åçš„å†…å®¹';
            assertEqual(foundElement.innerHTML, 'ä¿®æ”¹åçš„å†…å®¹', 'DOMå…ƒç´ å†…å®¹ä¿®æ”¹');
            
            // æµ‹è¯•æ ·å¼æ“ä½œ
            foundElement.style.display = 'none';
            assertEqual(foundElement.style.display, 'none', 'DOMæ ·å¼ä¿®æ”¹');
            
            // æ¸…ç†æµ‹è¯•å…ƒç´ 
            document.body.removeChild(testDiv);
            assert(true, 'æ¸…ç†æµ‹è¯•DOMå…ƒç´ ');
        }
        
        // æµ‹è¯•4: æµ‹è¯•è¡¨å•éªŒè¯åŠŸèƒ½
        function testFormValidation() {
            console.log('å¼€å§‹æµ‹è¯•è¡¨å•éªŒè¯...');
            
            // æ¨¡æ‹Ÿè¡¨å•éªŒè¯å‡½æ•°
            function validateEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }
            
            function validateEmployeeName(name) {
                return name && name.trim().length > 0;
            }
            
            // æµ‹è¯•é‚®ç®±éªŒè¯
            assert(validateEmail('test@example.com'), 'æœ‰æ•ˆé‚®ç®±éªŒè¯é€šè¿‡');
            assert(!validateEmail('invalid-email'), 'æ— æ•ˆé‚®ç®±éªŒè¯å¤±è´¥');
            assert(!validateEmail(''), 'ç©ºé‚®ç®±éªŒè¯å¤±è´¥');
            
            // æµ‹è¯•å§“åéªŒè¯
            assert(validateEmployeeName('å¼ ä¸‰'), 'æœ‰æ•ˆå§“åéªŒè¯é€šè¿‡');
            assert(!validateEmployeeName(''), 'ç©ºå§“åéªŒè¯å¤±è´¥');
            assert(!validateEmployeeName('   '), 'ç©ºç™½å§“åéªŒè¯å¤±è´¥');
        }
        
        // æµ‹è¯•5: æµ‹è¯•å¼‚æ­¥æ“ä½œæ¨¡æ‹Ÿ
        function testAsyncOperations() {
            console.log('å¼€å§‹æµ‹è¯•å¼‚æ­¥æ“ä½œ...');
            
            return new Promise((resolve) => {
                // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
                setTimeout(() => {
                    assert(true, 'å¼‚æ­¥æ“ä½œæ‰§è¡ŒæˆåŠŸ');
                    
                    // æµ‹è¯•PromiseåŸºç¡€åŠŸèƒ½
                    Promise.resolve('test').then(value => {
                        assertEqual(value, 'test', 'Promise resolveæµ‹è¯•');
                        resolve();
                    });
                }, 100);
            });
        }
        
        // æµ‹è¯•6: æµ‹è¯•APIè¯·æ±‚æ ¼å¼
        function testAPIRequestFormat() {
            console.log('å¼€å§‹æµ‹è¯•APIè¯·æ±‚æ ¼å¼...');
            
            // æµ‹è¯•è¯·æ±‚æ•°æ®æ ¼å¼
            const employeeData = {
                employee_number: 'EMP' + Date.now(),
                first_name: 'æµ‹è¯•',
                last_name: 'ç”¨æˆ·',
                email: 'test@example.com',
                hire_date: new Date().toISOString().split('T')[0]
            };
            
            // éªŒè¯æ•°æ®æ ¼å¼
            assertType(employeeData.employee_number, 'string', 'å‘˜å·¥ç¼–å·ç±»å‹');
            assertType(employeeData.first_name, 'string', 'åå­—ç±»å‹');
            assertType(employeeData.email, 'string', 'é‚®ç®±ç±»å‹');
            assert(employeeData.hire_date.match(/^\d{4}-\d{2}-\d{2}$/), 'æ—¥æœŸæ ¼å¼æ­£ç¡®');
        }
        
        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        async function runAllTests() {
            testResults = [];
            console.log('å¼€å§‹è¿è¡Œå‰ç«¯å•å…ƒæµ‹è¯•...');
            
            const resultsDiv = document.getElementById('testResults');
            const summaryDiv = document.getElementById('testSummary');
            
            resultsDiv.innerHTML = '<h3>æµ‹è¯•ç»“æœï¼š</h3>';
            
            try {
                testGlobalVariables();
                testJSONHandling();
                testDOMOperations();
                testFormValidation();
                await testAsyncOperations();
                testAPIRequestFormat();
                
                // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
                let passCount = 0;
                let failCount = 0;
                
                testResults.forEach(result => {
                    const resultDiv = document.createElement('div');
                    resultDiv.className = result.pass ? 'test-result test-pass' : 'test-result test-fail';
                    resultDiv.textContent = result.message;
                    resultsDiv.appendChild(resultDiv);
                    
                    if (result.pass) {
                        passCount++;
                    } else {
                        failCount++;
                    }
                });
                
                // æ˜¾ç¤ºæµ‹è¯•æ€»ç»“
                const total = passCount + failCount;
                summaryDiv.innerHTML = `<div class="test-summary">
                    æµ‹è¯•å®Œæˆï¼æ€»è®¡: ${total} é¡¹æµ‹è¯•<br>
                    âœ… é€šè¿‡: ${passCount} é¡¹<br>
                    âŒ å¤±è´¥: ${failCount} é¡¹<br>
                    æˆåŠŸç‡: ${(passCount / total * 100).toFixed(1)}%
                </div>`;
                
                console.log(`å‰ç«¯å•å…ƒæµ‹è¯•å®Œæˆ: ${passCount}/${total} é€šè¿‡`);
                
            } catch (error) {
                resultsDiv.innerHTML += `<div class="test-result test-fail">æµ‹è¯•æ‰§è¡Œå‡ºé”™: ${error.message}</div>`;
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œæµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            console.log('å‰ç«¯æµ‹è¯•é¡µé¢å·²åŠ è½½');
        });
    </script>
</body>
</html>