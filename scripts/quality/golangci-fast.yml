run:
  timeout: 2m
  issues-exit-code: 1
  go: "1.24"
  env:
    - GOTOOLCHAIN=go1.24.9

linters:
  enable:
    - depguard
    - tagliatelle
  disable:
    # TODO-TEMPORARY(2025-11-30): depguard/tagliatelle 仅依赖 import graph，禁止 typecheck 噪音阻断本地 push
    - typecheck

linters-settings:
  depguard:
    rules:
      command-service-boundary:
        deny:
          - pkg: cube-castle/cmd/hrms-server/query/internal
            desc: "命令服务不得依赖查询服务内部实现"
          - pkg: cube-castle/cmd/hrms-server/query/internal/...
            desc: "命令服务不得依赖查询服务内部实现"
        files:
          - cmd/hrms-server/command/internal/...
      query-service-boundary:
        deny:
          - pkg: cube-castle/cmd/hrms-server/command/internal
            desc: "查询服务不得依赖命令服务内部实现"
          - pkg: cube-castle/cmd/hrms-server/command/internal/...
            desc: "查询服务不得依赖命令服务内部实现"
        files:
          - cmd/hrms-server/query/internal/...
  tagliatelle:
    case:
      json: camel

issues:
  exclude-use-default: false
  exclude-rules:
    - linters:
        - tagliatelle
      path: internal/auth/.*
      source: 'json:"(access_token|refresh_token|token_type|id_token|expires_in|authorization_endpoint|token_endpoint|end_session_endpoint|jwks_uri|tenant_id)"'
    - linters:
        - tagliatelle
      path: cmd/hrms-server/.*/internal/auth/.*
      source: 'json:"(access_token|refresh_token|token_type|id_token|expires_in|authorization_endpoint|token_endpoint|end_session_endpoint|jwks_uri|tenant_id)"'
    - linters:
        - tagliatelle
      path: cmd/hrms-server/.*/internal/authbff/oidc\.go
      source: 'json:"(access_token|refresh_token|token_type|id_token|expires_in|authorization_endpoint|token_endpoint|end_session_endpoint|jwks_uri|tenant_id)"'
    - linters:
        - tagliatelle
      path: internal/cache/.*
