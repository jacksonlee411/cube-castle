resource_name: person
namespace: hr.employees
version: "1.0.0"
description: "Employee person entity with basic information"

metadata:
  author: "Cube Castle Team"
  created_at: "2024-01-15T10:30:00Z"
  tags: ["hr", "employee", "person"]

data_structure:
  fields:
    - name: id
      type: UUID
      constraints:
        primary_key: true
        required: true
      description: "Unique identifier for the person"
    
    - name: employee_id
      type: String
      constraints:
        unique: true
        required: true
        max_length: 20
      description: "Employee ID in the system"
    
    - name: first_name
      type: String
      constraints:
        required: true
        max_length: 50
      description: "Person's first name"
    
    - name: last_name
      type: String
      constraints:
        required: true
        max_length: 50
      description: "Person's last name"
    
    - name: email
      type: String
      constraints:
        required: true
        unique: true
        format: email
        max_length: 100
      description: "Person's email address"
    
    - name: phone
      type: String
      constraints:
        max_length: 20
      description: "Person's phone number"
    
    - name: hire_date
      type: Date
      constraints:
        required: true
      description: "Date when person was hired"
    
    - name: department_id
      type: UUID
      constraints:
        foreign_key: "departments.id"
      description: "Reference to department"
    
    - name: position_id
      type: UUID
      constraints:
        foreign_key: "positions.id"
      description: "Reference to position"
    
    - name: manager_id
      type: UUID
      constraints:
        foreign_key: "persons.id"
      description: "Reference to manager (self-reference)"
    
    - name: status
      type: Enum
      enum_values: ["active", "inactive", "terminated"]
      constraints:
        required: true
        default: "active"
      description: "Employment status"
    
    - name: salary
      type: Decimal
      constraints:
        precision: 10
        scale: 2
      description: "Person's salary"
    
    - name: created_at
      type: Timestamp
      constraints:
        required: true
        auto_generate: true
      description: "Record creation timestamp"
    
    - name: updated_at
      type: Timestamp
      constraints:
        required: true
        auto_update: true
      description: "Record last update timestamp"

relationships:
  - name: department
    type: belongs_to
    target_entity: department
    foreign_key: department_id
    description: "Person belongs to a department"
  
  - name: position
    type: belongs_to
    target_entity: position
    foreign_key: position_id
    description: "Person has a position"
  
  - name: manager
    type: belongs_to
    target_entity: person
    foreign_key: manager_id
    description: "Person reports to a manager"
  
  - name: direct_reports
    type: has_many
    target_entity: person
    foreign_key: manager_id
    description: "Person manages other persons"

business_rules:
  - name: email_uniqueness
    type: uniqueness
    field: email
    description: "Email must be unique across all persons"
  
  - name: employee_id_format
    type: format
    field: employee_id
    pattern: "^EMP[0-9]{6}$"
    description: "Employee ID must follow EMP + 6 digits format"
  
  - name: hire_date_validation
    type: custom
    expression: "hire_date <= current_date"
    description: "Hire date cannot be in the future"

security_model:
  access_control: rbac
  data_classification: internal
  privacy_fields: ["salary", "phone"]
  audit_fields: ["created_at", "updated_at"]

temporal_behavior:
  temporality_paradigm: event_driven
  state_transition_model: discrete
  history_tracking: true
  effective_dating: true

api_configuration:
  rest_endpoints:
    - path: "/persons"
      methods: ["GET", "POST"]
      description: "List and create persons"
    
    - path: "/persons/{id}"
      methods: ["GET", "PUT", "DELETE"]
      description: "Get, update, delete specific person"
    
    - path: "/persons/{id}/direct-reports"
      methods: ["GET"]
      description: "Get person's direct reports"
  
  graphql_types:
    enabled: true
    mutations: true
    subscriptions: false