// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"errors"
	"fmt"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/schema/field"
	"github.com/gaogu/cube-castle/go-app/ent/position"
	"github.com/gaogu/cube-castle/go-app/ent/positionattributehistory"
	"github.com/gaogu/cube-castle/go-app/ent/predicate"
	"github.com/google/uuid"
)

// PositionAttributeHistoryUpdate is the builder for updating PositionAttributeHistory entities.
type PositionAttributeHistoryUpdate struct {
	config
	hooks    []Hook
	mutation *PositionAttributeHistoryMutation
}

// Where appends a list predicates to the PositionAttributeHistoryUpdate builder.
func (pahu *PositionAttributeHistoryUpdate) Where(ps ...predicate.PositionAttributeHistory) *PositionAttributeHistoryUpdate {
	pahu.mutation.Where(ps...)
	return pahu
}

// SetPositionID sets the "position_id" field.
func (pahu *PositionAttributeHistoryUpdate) SetPositionID(u uuid.UUID) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetPositionID(u)
	return pahu
}

// SetNillablePositionID sets the "position_id" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillablePositionID(u *uuid.UUID) *PositionAttributeHistoryUpdate {
	if u != nil {
		pahu.SetPositionID(*u)
	}
	return pahu
}

// SetPositionType sets the "position_type" field.
func (pahu *PositionAttributeHistoryUpdate) SetPositionType(s string) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetPositionType(s)
	return pahu
}

// SetNillablePositionType sets the "position_type" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillablePositionType(s *string) *PositionAttributeHistoryUpdate {
	if s != nil {
		pahu.SetPositionType(*s)
	}
	return pahu
}

// SetJobProfileID sets the "job_profile_id" field.
func (pahu *PositionAttributeHistoryUpdate) SetJobProfileID(u uuid.UUID) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetJobProfileID(u)
	return pahu
}

// SetNillableJobProfileID sets the "job_profile_id" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableJobProfileID(u *uuid.UUID) *PositionAttributeHistoryUpdate {
	if u != nil {
		pahu.SetJobProfileID(*u)
	}
	return pahu
}

// SetDepartmentID sets the "department_id" field.
func (pahu *PositionAttributeHistoryUpdate) SetDepartmentID(u uuid.UUID) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetDepartmentID(u)
	return pahu
}

// SetNillableDepartmentID sets the "department_id" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableDepartmentID(u *uuid.UUID) *PositionAttributeHistoryUpdate {
	if u != nil {
		pahu.SetDepartmentID(*u)
	}
	return pahu
}

// SetManagerPositionID sets the "manager_position_id" field.
func (pahu *PositionAttributeHistoryUpdate) SetManagerPositionID(u uuid.UUID) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetManagerPositionID(u)
	return pahu
}

// SetNillableManagerPositionID sets the "manager_position_id" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableManagerPositionID(u *uuid.UUID) *PositionAttributeHistoryUpdate {
	if u != nil {
		pahu.SetManagerPositionID(*u)
	}
	return pahu
}

// ClearManagerPositionID clears the value of the "manager_position_id" field.
func (pahu *PositionAttributeHistoryUpdate) ClearManagerPositionID() *PositionAttributeHistoryUpdate {
	pahu.mutation.ClearManagerPositionID()
	return pahu
}

// SetStatus sets the "status" field.
func (pahu *PositionAttributeHistoryUpdate) SetStatus(s string) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetStatus(s)
	return pahu
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableStatus(s *string) *PositionAttributeHistoryUpdate {
	if s != nil {
		pahu.SetStatus(*s)
	}
	return pahu
}

// SetBudgetedFte sets the "budgeted_fte" field.
func (pahu *PositionAttributeHistoryUpdate) SetBudgetedFte(f float64) *PositionAttributeHistoryUpdate {
	pahu.mutation.ResetBudgetedFte()
	pahu.mutation.SetBudgetedFte(f)
	return pahu
}

// SetNillableBudgetedFte sets the "budgeted_fte" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableBudgetedFte(f *float64) *PositionAttributeHistoryUpdate {
	if f != nil {
		pahu.SetBudgetedFte(*f)
	}
	return pahu
}

// AddBudgetedFte adds f to the "budgeted_fte" field.
func (pahu *PositionAttributeHistoryUpdate) AddBudgetedFte(f float64) *PositionAttributeHistoryUpdate {
	pahu.mutation.AddBudgetedFte(f)
	return pahu
}

// SetDetails sets the "details" field.
func (pahu *PositionAttributeHistoryUpdate) SetDetails(m map[string]interface{}) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetDetails(m)
	return pahu
}

// ClearDetails clears the value of the "details" field.
func (pahu *PositionAttributeHistoryUpdate) ClearDetails() *PositionAttributeHistoryUpdate {
	pahu.mutation.ClearDetails()
	return pahu
}

// SetEffectiveDate sets the "effective_date" field.
func (pahu *PositionAttributeHistoryUpdate) SetEffectiveDate(t time.Time) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetEffectiveDate(t)
	return pahu
}

// SetNillableEffectiveDate sets the "effective_date" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableEffectiveDate(t *time.Time) *PositionAttributeHistoryUpdate {
	if t != nil {
		pahu.SetEffectiveDate(*t)
	}
	return pahu
}

// SetEndDate sets the "end_date" field.
func (pahu *PositionAttributeHistoryUpdate) SetEndDate(t time.Time) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetEndDate(t)
	return pahu
}

// SetNillableEndDate sets the "end_date" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableEndDate(t *time.Time) *PositionAttributeHistoryUpdate {
	if t != nil {
		pahu.SetEndDate(*t)
	}
	return pahu
}

// ClearEndDate clears the value of the "end_date" field.
func (pahu *PositionAttributeHistoryUpdate) ClearEndDate() *PositionAttributeHistoryUpdate {
	pahu.mutation.ClearEndDate()
	return pahu
}

// SetChangeReason sets the "change_reason" field.
func (pahu *PositionAttributeHistoryUpdate) SetChangeReason(s string) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetChangeReason(s)
	return pahu
}

// SetNillableChangeReason sets the "change_reason" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableChangeReason(s *string) *PositionAttributeHistoryUpdate {
	if s != nil {
		pahu.SetChangeReason(*s)
	}
	return pahu
}

// ClearChangeReason clears the value of the "change_reason" field.
func (pahu *PositionAttributeHistoryUpdate) ClearChangeReason() *PositionAttributeHistoryUpdate {
	pahu.mutation.ClearChangeReason()
	return pahu
}

// SetChangedBy sets the "changed_by" field.
func (pahu *PositionAttributeHistoryUpdate) SetChangedBy(u uuid.UUID) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetChangedBy(u)
	return pahu
}

// SetNillableChangedBy sets the "changed_by" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableChangedBy(u *uuid.UUID) *PositionAttributeHistoryUpdate {
	if u != nil {
		pahu.SetChangedBy(*u)
	}
	return pahu
}

// SetChangeType sets the "change_type" field.
func (pahu *PositionAttributeHistoryUpdate) SetChangeType(s string) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetChangeType(s)
	return pahu
}

// SetNillableChangeType sets the "change_type" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableChangeType(s *string) *PositionAttributeHistoryUpdate {
	if s != nil {
		pahu.SetChangeType(*s)
	}
	return pahu
}

// ClearChangeType clears the value of the "change_type" field.
func (pahu *PositionAttributeHistoryUpdate) ClearChangeType() *PositionAttributeHistoryUpdate {
	pahu.mutation.ClearChangeType()
	return pahu
}

// SetSourceEventID sets the "source_event_id" field.
func (pahu *PositionAttributeHistoryUpdate) SetSourceEventID(u uuid.UUID) *PositionAttributeHistoryUpdate {
	pahu.mutation.SetSourceEventID(u)
	return pahu
}

// SetNillableSourceEventID sets the "source_event_id" field if the given value is not nil.
func (pahu *PositionAttributeHistoryUpdate) SetNillableSourceEventID(u *uuid.UUID) *PositionAttributeHistoryUpdate {
	if u != nil {
		pahu.SetSourceEventID(*u)
	}
	return pahu
}

// ClearSourceEventID clears the value of the "source_event_id" field.
func (pahu *PositionAttributeHistoryUpdate) ClearSourceEventID() *PositionAttributeHistoryUpdate {
	pahu.mutation.ClearSourceEventID()
	return pahu
}

// SetPosition sets the "position" edge to the Position entity.
func (pahu *PositionAttributeHistoryUpdate) SetPosition(p *Position) *PositionAttributeHistoryUpdate {
	return pahu.SetPositionID(p.ID)
}

// Mutation returns the PositionAttributeHistoryMutation object of the builder.
func (pahu *PositionAttributeHistoryUpdate) Mutation() *PositionAttributeHistoryMutation {
	return pahu.mutation
}

// ClearPosition clears the "position" edge to the Position entity.
func (pahu *PositionAttributeHistoryUpdate) ClearPosition() *PositionAttributeHistoryUpdate {
	pahu.mutation.ClearPosition()
	return pahu
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (pahu *PositionAttributeHistoryUpdate) Save(ctx context.Context) (int, error) {
	return withHooks(ctx, pahu.sqlSave, pahu.mutation, pahu.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (pahu *PositionAttributeHistoryUpdate) SaveX(ctx context.Context) int {
	affected, err := pahu.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (pahu *PositionAttributeHistoryUpdate) Exec(ctx context.Context) error {
	_, err := pahu.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (pahu *PositionAttributeHistoryUpdate) ExecX(ctx context.Context) {
	if err := pahu.Exec(ctx); err != nil {
		panic(err)
	}
}

// check runs all checks and user-defined validators on the builder.
func (pahu *PositionAttributeHistoryUpdate) check() error {
	if pahu.mutation.PositionCleared() && len(pahu.mutation.PositionIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "PositionAttributeHistory.position"`)
	}
	return nil
}

func (pahu *PositionAttributeHistoryUpdate) sqlSave(ctx context.Context) (n int, err error) {
	if err := pahu.check(); err != nil {
		return n, err
	}
	_spec := sqlgraph.NewUpdateSpec(positionattributehistory.Table, positionattributehistory.Columns, sqlgraph.NewFieldSpec(positionattributehistory.FieldID, field.TypeUUID))
	if ps := pahu.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := pahu.mutation.PositionType(); ok {
		_spec.SetField(positionattributehistory.FieldPositionType, field.TypeString, value)
	}
	if value, ok := pahu.mutation.JobProfileID(); ok {
		_spec.SetField(positionattributehistory.FieldJobProfileID, field.TypeUUID, value)
	}
	if value, ok := pahu.mutation.DepartmentID(); ok {
		_spec.SetField(positionattributehistory.FieldDepartmentID, field.TypeUUID, value)
	}
	if value, ok := pahu.mutation.ManagerPositionID(); ok {
		_spec.SetField(positionattributehistory.FieldManagerPositionID, field.TypeUUID, value)
	}
	if pahu.mutation.ManagerPositionIDCleared() {
		_spec.ClearField(positionattributehistory.FieldManagerPositionID, field.TypeUUID)
	}
	if value, ok := pahu.mutation.Status(); ok {
		_spec.SetField(positionattributehistory.FieldStatus, field.TypeString, value)
	}
	if value, ok := pahu.mutation.BudgetedFte(); ok {
		_spec.SetField(positionattributehistory.FieldBudgetedFte, field.TypeFloat64, value)
	}
	if value, ok := pahu.mutation.AddedBudgetedFte(); ok {
		_spec.AddField(positionattributehistory.FieldBudgetedFte, field.TypeFloat64, value)
	}
	if value, ok := pahu.mutation.Details(); ok {
		_spec.SetField(positionattributehistory.FieldDetails, field.TypeJSON, value)
	}
	if pahu.mutation.DetailsCleared() {
		_spec.ClearField(positionattributehistory.FieldDetails, field.TypeJSON)
	}
	if value, ok := pahu.mutation.EffectiveDate(); ok {
		_spec.SetField(positionattributehistory.FieldEffectiveDate, field.TypeTime, value)
	}
	if value, ok := pahu.mutation.EndDate(); ok {
		_spec.SetField(positionattributehistory.FieldEndDate, field.TypeTime, value)
	}
	if pahu.mutation.EndDateCleared() {
		_spec.ClearField(positionattributehistory.FieldEndDate, field.TypeTime)
	}
	if value, ok := pahu.mutation.ChangeReason(); ok {
		_spec.SetField(positionattributehistory.FieldChangeReason, field.TypeString, value)
	}
	if pahu.mutation.ChangeReasonCleared() {
		_spec.ClearField(positionattributehistory.FieldChangeReason, field.TypeString)
	}
	if value, ok := pahu.mutation.ChangedBy(); ok {
		_spec.SetField(positionattributehistory.FieldChangedBy, field.TypeUUID, value)
	}
	if value, ok := pahu.mutation.ChangeType(); ok {
		_spec.SetField(positionattributehistory.FieldChangeType, field.TypeString, value)
	}
	if pahu.mutation.ChangeTypeCleared() {
		_spec.ClearField(positionattributehistory.FieldChangeType, field.TypeString)
	}
	if value, ok := pahu.mutation.SourceEventID(); ok {
		_spec.SetField(positionattributehistory.FieldSourceEventID, field.TypeUUID, value)
	}
	if pahu.mutation.SourceEventIDCleared() {
		_spec.ClearField(positionattributehistory.FieldSourceEventID, field.TypeUUID)
	}
	if pahu.mutation.PositionCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   positionattributehistory.PositionTable,
			Columns: []string{positionattributehistory.PositionColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(position.FieldID, field.TypeUUID),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := pahu.mutation.PositionIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   positionattributehistory.PositionTable,
			Columns: []string{positionattributehistory.PositionColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(position.FieldID, field.TypeUUID),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if n, err = sqlgraph.UpdateNodes(ctx, pahu.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{positionattributehistory.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	pahu.mutation.done = true
	return n, nil
}

// PositionAttributeHistoryUpdateOne is the builder for updating a single PositionAttributeHistory entity.
type PositionAttributeHistoryUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *PositionAttributeHistoryMutation
}

// SetPositionID sets the "position_id" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetPositionID(u uuid.UUID) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetPositionID(u)
	return pahuo
}

// SetNillablePositionID sets the "position_id" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillablePositionID(u *uuid.UUID) *PositionAttributeHistoryUpdateOne {
	if u != nil {
		pahuo.SetPositionID(*u)
	}
	return pahuo
}

// SetPositionType sets the "position_type" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetPositionType(s string) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetPositionType(s)
	return pahuo
}

// SetNillablePositionType sets the "position_type" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillablePositionType(s *string) *PositionAttributeHistoryUpdateOne {
	if s != nil {
		pahuo.SetPositionType(*s)
	}
	return pahuo
}

// SetJobProfileID sets the "job_profile_id" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetJobProfileID(u uuid.UUID) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetJobProfileID(u)
	return pahuo
}

// SetNillableJobProfileID sets the "job_profile_id" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableJobProfileID(u *uuid.UUID) *PositionAttributeHistoryUpdateOne {
	if u != nil {
		pahuo.SetJobProfileID(*u)
	}
	return pahuo
}

// SetDepartmentID sets the "department_id" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetDepartmentID(u uuid.UUID) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetDepartmentID(u)
	return pahuo
}

// SetNillableDepartmentID sets the "department_id" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableDepartmentID(u *uuid.UUID) *PositionAttributeHistoryUpdateOne {
	if u != nil {
		pahuo.SetDepartmentID(*u)
	}
	return pahuo
}

// SetManagerPositionID sets the "manager_position_id" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetManagerPositionID(u uuid.UUID) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetManagerPositionID(u)
	return pahuo
}

// SetNillableManagerPositionID sets the "manager_position_id" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableManagerPositionID(u *uuid.UUID) *PositionAttributeHistoryUpdateOne {
	if u != nil {
		pahuo.SetManagerPositionID(*u)
	}
	return pahuo
}

// ClearManagerPositionID clears the value of the "manager_position_id" field.
func (pahuo *PositionAttributeHistoryUpdateOne) ClearManagerPositionID() *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ClearManagerPositionID()
	return pahuo
}

// SetStatus sets the "status" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetStatus(s string) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetStatus(s)
	return pahuo
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableStatus(s *string) *PositionAttributeHistoryUpdateOne {
	if s != nil {
		pahuo.SetStatus(*s)
	}
	return pahuo
}

// SetBudgetedFte sets the "budgeted_fte" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetBudgetedFte(f float64) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ResetBudgetedFte()
	pahuo.mutation.SetBudgetedFte(f)
	return pahuo
}

// SetNillableBudgetedFte sets the "budgeted_fte" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableBudgetedFte(f *float64) *PositionAttributeHistoryUpdateOne {
	if f != nil {
		pahuo.SetBudgetedFte(*f)
	}
	return pahuo
}

// AddBudgetedFte adds f to the "budgeted_fte" field.
func (pahuo *PositionAttributeHistoryUpdateOne) AddBudgetedFte(f float64) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.AddBudgetedFte(f)
	return pahuo
}

// SetDetails sets the "details" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetDetails(m map[string]interface{}) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetDetails(m)
	return pahuo
}

// ClearDetails clears the value of the "details" field.
func (pahuo *PositionAttributeHistoryUpdateOne) ClearDetails() *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ClearDetails()
	return pahuo
}

// SetEffectiveDate sets the "effective_date" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetEffectiveDate(t time.Time) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetEffectiveDate(t)
	return pahuo
}

// SetNillableEffectiveDate sets the "effective_date" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableEffectiveDate(t *time.Time) *PositionAttributeHistoryUpdateOne {
	if t != nil {
		pahuo.SetEffectiveDate(*t)
	}
	return pahuo
}

// SetEndDate sets the "end_date" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetEndDate(t time.Time) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetEndDate(t)
	return pahuo
}

// SetNillableEndDate sets the "end_date" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableEndDate(t *time.Time) *PositionAttributeHistoryUpdateOne {
	if t != nil {
		pahuo.SetEndDate(*t)
	}
	return pahuo
}

// ClearEndDate clears the value of the "end_date" field.
func (pahuo *PositionAttributeHistoryUpdateOne) ClearEndDate() *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ClearEndDate()
	return pahuo
}

// SetChangeReason sets the "change_reason" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetChangeReason(s string) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetChangeReason(s)
	return pahuo
}

// SetNillableChangeReason sets the "change_reason" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableChangeReason(s *string) *PositionAttributeHistoryUpdateOne {
	if s != nil {
		pahuo.SetChangeReason(*s)
	}
	return pahuo
}

// ClearChangeReason clears the value of the "change_reason" field.
func (pahuo *PositionAttributeHistoryUpdateOne) ClearChangeReason() *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ClearChangeReason()
	return pahuo
}

// SetChangedBy sets the "changed_by" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetChangedBy(u uuid.UUID) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetChangedBy(u)
	return pahuo
}

// SetNillableChangedBy sets the "changed_by" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableChangedBy(u *uuid.UUID) *PositionAttributeHistoryUpdateOne {
	if u != nil {
		pahuo.SetChangedBy(*u)
	}
	return pahuo
}

// SetChangeType sets the "change_type" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetChangeType(s string) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetChangeType(s)
	return pahuo
}

// SetNillableChangeType sets the "change_type" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableChangeType(s *string) *PositionAttributeHistoryUpdateOne {
	if s != nil {
		pahuo.SetChangeType(*s)
	}
	return pahuo
}

// ClearChangeType clears the value of the "change_type" field.
func (pahuo *PositionAttributeHistoryUpdateOne) ClearChangeType() *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ClearChangeType()
	return pahuo
}

// SetSourceEventID sets the "source_event_id" field.
func (pahuo *PositionAttributeHistoryUpdateOne) SetSourceEventID(u uuid.UUID) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.SetSourceEventID(u)
	return pahuo
}

// SetNillableSourceEventID sets the "source_event_id" field if the given value is not nil.
func (pahuo *PositionAttributeHistoryUpdateOne) SetNillableSourceEventID(u *uuid.UUID) *PositionAttributeHistoryUpdateOne {
	if u != nil {
		pahuo.SetSourceEventID(*u)
	}
	return pahuo
}

// ClearSourceEventID clears the value of the "source_event_id" field.
func (pahuo *PositionAttributeHistoryUpdateOne) ClearSourceEventID() *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ClearSourceEventID()
	return pahuo
}

// SetPosition sets the "position" edge to the Position entity.
func (pahuo *PositionAttributeHistoryUpdateOne) SetPosition(p *Position) *PositionAttributeHistoryUpdateOne {
	return pahuo.SetPositionID(p.ID)
}

// Mutation returns the PositionAttributeHistoryMutation object of the builder.
func (pahuo *PositionAttributeHistoryUpdateOne) Mutation() *PositionAttributeHistoryMutation {
	return pahuo.mutation
}

// ClearPosition clears the "position" edge to the Position entity.
func (pahuo *PositionAttributeHistoryUpdateOne) ClearPosition() *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.ClearPosition()
	return pahuo
}

// Where appends a list predicates to the PositionAttributeHistoryUpdate builder.
func (pahuo *PositionAttributeHistoryUpdateOne) Where(ps ...predicate.PositionAttributeHistory) *PositionAttributeHistoryUpdateOne {
	pahuo.mutation.Where(ps...)
	return pahuo
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (pahuo *PositionAttributeHistoryUpdateOne) Select(field string, fields ...string) *PositionAttributeHistoryUpdateOne {
	pahuo.fields = append([]string{field}, fields...)
	return pahuo
}

// Save executes the query and returns the updated PositionAttributeHistory entity.
func (pahuo *PositionAttributeHistoryUpdateOne) Save(ctx context.Context) (*PositionAttributeHistory, error) {
	return withHooks(ctx, pahuo.sqlSave, pahuo.mutation, pahuo.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (pahuo *PositionAttributeHistoryUpdateOne) SaveX(ctx context.Context) *PositionAttributeHistory {
	node, err := pahuo.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (pahuo *PositionAttributeHistoryUpdateOne) Exec(ctx context.Context) error {
	_, err := pahuo.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (pahuo *PositionAttributeHistoryUpdateOne) ExecX(ctx context.Context) {
	if err := pahuo.Exec(ctx); err != nil {
		panic(err)
	}
}

// check runs all checks and user-defined validators on the builder.
func (pahuo *PositionAttributeHistoryUpdateOne) check() error {
	if pahuo.mutation.PositionCleared() && len(pahuo.mutation.PositionIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "PositionAttributeHistory.position"`)
	}
	return nil
}

func (pahuo *PositionAttributeHistoryUpdateOne) sqlSave(ctx context.Context) (_node *PositionAttributeHistory, err error) {
	if err := pahuo.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(positionattributehistory.Table, positionattributehistory.Columns, sqlgraph.NewFieldSpec(positionattributehistory.FieldID, field.TypeUUID))
	id, ok := pahuo.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "PositionAttributeHistory.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := pahuo.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, positionattributehistory.FieldID)
		for _, f := range fields {
			if !positionattributehistory.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != positionattributehistory.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := pahuo.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := pahuo.mutation.PositionType(); ok {
		_spec.SetField(positionattributehistory.FieldPositionType, field.TypeString, value)
	}
	if value, ok := pahuo.mutation.JobProfileID(); ok {
		_spec.SetField(positionattributehistory.FieldJobProfileID, field.TypeUUID, value)
	}
	if value, ok := pahuo.mutation.DepartmentID(); ok {
		_spec.SetField(positionattributehistory.FieldDepartmentID, field.TypeUUID, value)
	}
	if value, ok := pahuo.mutation.ManagerPositionID(); ok {
		_spec.SetField(positionattributehistory.FieldManagerPositionID, field.TypeUUID, value)
	}
	if pahuo.mutation.ManagerPositionIDCleared() {
		_spec.ClearField(positionattributehistory.FieldManagerPositionID, field.TypeUUID)
	}
	if value, ok := pahuo.mutation.Status(); ok {
		_spec.SetField(positionattributehistory.FieldStatus, field.TypeString, value)
	}
	if value, ok := pahuo.mutation.BudgetedFte(); ok {
		_spec.SetField(positionattributehistory.FieldBudgetedFte, field.TypeFloat64, value)
	}
	if value, ok := pahuo.mutation.AddedBudgetedFte(); ok {
		_spec.AddField(positionattributehistory.FieldBudgetedFte, field.TypeFloat64, value)
	}
	if value, ok := pahuo.mutation.Details(); ok {
		_spec.SetField(positionattributehistory.FieldDetails, field.TypeJSON, value)
	}
	if pahuo.mutation.DetailsCleared() {
		_spec.ClearField(positionattributehistory.FieldDetails, field.TypeJSON)
	}
	if value, ok := pahuo.mutation.EffectiveDate(); ok {
		_spec.SetField(positionattributehistory.FieldEffectiveDate, field.TypeTime, value)
	}
	if value, ok := pahuo.mutation.EndDate(); ok {
		_spec.SetField(positionattributehistory.FieldEndDate, field.TypeTime, value)
	}
	if pahuo.mutation.EndDateCleared() {
		_spec.ClearField(positionattributehistory.FieldEndDate, field.TypeTime)
	}
	if value, ok := pahuo.mutation.ChangeReason(); ok {
		_spec.SetField(positionattributehistory.FieldChangeReason, field.TypeString, value)
	}
	if pahuo.mutation.ChangeReasonCleared() {
		_spec.ClearField(positionattributehistory.FieldChangeReason, field.TypeString)
	}
	if value, ok := pahuo.mutation.ChangedBy(); ok {
		_spec.SetField(positionattributehistory.FieldChangedBy, field.TypeUUID, value)
	}
	if value, ok := pahuo.mutation.ChangeType(); ok {
		_spec.SetField(positionattributehistory.FieldChangeType, field.TypeString, value)
	}
	if pahuo.mutation.ChangeTypeCleared() {
		_spec.ClearField(positionattributehistory.FieldChangeType, field.TypeString)
	}
	if value, ok := pahuo.mutation.SourceEventID(); ok {
		_spec.SetField(positionattributehistory.FieldSourceEventID, field.TypeUUID, value)
	}
	if pahuo.mutation.SourceEventIDCleared() {
		_spec.ClearField(positionattributehistory.FieldSourceEventID, field.TypeUUID)
	}
	if pahuo.mutation.PositionCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   positionattributehistory.PositionTable,
			Columns: []string{positionattributehistory.PositionColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(position.FieldID, field.TypeUUID),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := pahuo.mutation.PositionIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   positionattributehistory.PositionTable,
			Columns: []string{positionattributehistory.PositionColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(position.FieldID, field.TypeUUID),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	_node = &PositionAttributeHistory{config: pahuo.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, pahuo.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{positionattributehistory.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	pahuo.mutation.done = true
	return _node, nil
}
