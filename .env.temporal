# Cube Castle 时态管理服务环境变量配置
# 生成时间: 2025-08-12

# ===== 服务端口配置 =====
TEMPORAL_REST_PORT=9093
TEMPORAL_QUERY_PORT=8091  
TEMPORAL_SYNC_PORT=8092

# ===== 数据库配置 =====
# PostgreSQL (命令端)
DB_HOST=localhost
DB_PORT=5432
DB_USER=user
DB_PASSWORD=password
DB_NAME=cubecastle
DB_SSL_MODE=disable

# Neo4j (查询端)
NEO4J_URI=bolt://localhost:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=password
NEO4J_DATABASE=neo4j

# ===== 消息队列配置 =====
# Kafka + Debezium CDC
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_TOPIC=organization_db.public.organization_units
KAFKA_GROUP_ID=temporal-sync-service
KAFKA_AUTO_OFFSET_RESET=latest
KAFKA_ENABLE_AUTO_COMMIT=true

# ===== 缓存配置 =====
# Redis
REDIS_ADDR=localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_MAX_RETRIES=3
REDIS_DIAL_TIMEOUT=5s
REDIS_READ_TIMEOUT=3s
REDIS_WRITE_TIMEOUT=3s

# ===== 租户配置 =====
DEFAULT_TENANT_ID=3b99930c-4dc6-4cc9-8e4d-7d960a931cb9
TENANT_NAME=cube_castle_default

# ===== 日志配置 =====
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE_PATH=/var/log/cube-castle

# ===== 性能配置 =====
# 连接池
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# Neo4j连接池  
NEO4J_MAX_CONNECTION_POOL_SIZE=100
NEO4J_CONNECTION_ACQUISITION_TIMEOUT=60s

# HTTP服务器
HTTP_READ_TIMEOUT=15s
HTTP_WRITE_TIMEOUT=15s
HTTP_IDLE_TIMEOUT=60s

# ===== 健康检查配置 =====
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=5s
HEALTH_CHECK_RETRIES=3

# ===== 监控配置 =====
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics
TRACING_ENABLED=false

# ===== 安全配置 =====
# API认证 (生产环境必须配置)
API_KEY=
JWT_SECRET=
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3003

# TLS配置 (生产环境推荐)
TLS_ENABLED=false
TLS_CERT_FILE=
TLS_KEY_FILE=

# ===== 业务配置 =====
# 时态管理
TEMPORAL_RETENTION_DAYS=2555  # 7年保留期
TEMPORAL_DEFAULT_EFFECTIVE_DATE=today
TEMPORAL_AUTO_VERSION=true

# CDC同步
CDC_BATCH_SIZE=100
CDC_FLUSH_INTERVAL=1s
CDC_MAX_RETRIES=3
CDC_RETRY_BACKOFF=1s

# 缓存策略
CACHE_TTL=3600s
CACHE_INVALIDATION_STRATEGY=precise
CACHE_WARMING_ENABLED=true

# ===== 开发环境配置 =====
# 仅开发环境使用
DEBUG_ENABLED=false
PROFILE_ENABLED=false
PPROF_PORT=6060

# 测试数据
SEED_DATA_ENABLED=false
MOCK_EXTERNAL_SERVICES=false

# ===== Docker配置 =====
# 容器运行时配置
CONTAINER_TIMEZONE=Asia/Shanghai
CONTAINER_USER=appuser
CONTAINER_UID=1000
CONTAINER_GID=1000

# Docker网络
DOCKER_NETWORK=cube_castle_network
DOCKER_BRIDGE_IP=172.18.0.0/16

# 资源限制
MEMORY_LIMIT=512m
CPU_LIMIT=0.5