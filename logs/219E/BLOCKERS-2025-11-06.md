# 219E 阻塞记录（2025-11-06）

## 背景
- 本阶段需要运行 `make run-dev` 启动 Docker Compose（postgres、redis、rest-service、graphql-service），以便执行端到端场景、性能基准与回退演练。

## 实际情况
- 在代理环境中运行 `make run-dev` / `docker compose up` 时，Docker daemon socket 返回 `permission denied`：
  ```
  unable to get image 'cube-castle-rest-service': permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock
  ```
- 直接执行 `docker ps` 亦提示无权访问 `/var/run/docker.sock`，`sudo` 因 `no new privileges` 限制不可用。

## 影响
- 无法启动命令/查询服务，因此：
  - 端到端脚本（`tests/e2e/*`, `scripts/e2e/org-lifecycle-smoke.sh`）无法连接到 9090/8090。
  - 性能基准脚本 `scripts/perf/rest-benchmark.sh` 及 Playwright 套件无法运行。
  - 回退演练（基于运行中的容器）无法验证。

## 建议解决方案
1. 在宿主环境为当前用户赋予 Docker 访问权限（例如 `sudo usermod -aG docker $USER` 或调整 rootless docker 设置），并重启 Shell。
2. 或在具备权限的 CI/专用 runner 上执行 `make run-dev` + 219E 脚本，将日志回传本仓库。

## 临时行动
- 为保持计划推进，已新增以下脚本与日志目录，待 Docker 权限恢复后可直接执行：
  - `scripts/e2e/org-lifecycle-smoke.sh` — 组织/部门生命周期冒烟。
  - `scripts/perf/rest-benchmark.sh` — REST 接口性能基准。
  - `logs/219E/` — 存放后续 E2E、性能与回退记录。
