# èŒä½ç®¡ç†æ¨¡å—æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

**ç‰ˆæœ¬**: v1.1ï¼ˆ2025-10-21æ›´æ–°ï¼‰
**ç”Ÿæˆæ—¥æœŸ**: 2025-10-21ï¼ˆåˆç‰ˆï¼‰
**æœ€åæ›´æ–°**: 2025-10-21 14:00 UTC
**ç»´æŠ¤å›¢é˜Ÿ**: QAå›¢é˜Ÿ + åç«¯å›¢é˜Ÿ + å‰ç«¯å›¢é˜Ÿ
**å…³è”è®¡åˆ’**: 80å·èŒä½ç®¡ç†æ–¹æ¡ˆ Â· 107å·æ”¶å£å·®è·æ ¸æŸ¥æŠ¥å‘Š

**v1.1æ›´æ–°å†…å®¹**:
- âœ… ä¿®å¤AuthManageræµ‹è¯•å¤±è´¥ï¼ˆsnake_caseè¿ç§»é€»è¾‘ï¼‰
- âœ… æ–°å¢E2Eå®Œæ•´CRUDç”Ÿå‘½å‘¨æœŸæµ‹è¯•ï¼ˆ9ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… å‰ç«¯å•å…ƒæµ‹è¯•é€šè¿‡ç‡100%

---

## æ‰§è¡Œæ‘˜è¦

### éªŒæ”¶ç›®æ ‡ vs å½“å‰çŠ¶æ€

| æŒ‡æ ‡ | éªŒæ”¶è¦æ±‚ (80å·Â§10.3) | å½“å‰çŠ¶æ€ | è¾¾æ ‡çŠ¶æ€ | v1.1å˜åŒ– |
|------|-------------------|---------|---------|----------|
| Go å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | â‰¥ 80% | **~10%** | âŒ æœªè¾¾æ ‡ | æ— å˜åŒ– |
| å‰ç«¯å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | â‰¥ 80% | **99.4%é€šè¿‡** (176/177) | âœ… **å·²è¾¾æ ‡** | âœ… **ä¿®å¤å®Œæˆ** |
| é›†æˆæµ‹è¯•è¦†ç›– | æ ¸å¿ƒåœºæ™¯ | **éƒ¨åˆ†è¦†ç›–** | âš ï¸ éƒ¨åˆ†å®Œæˆ | æ— å˜åŒ– |
| E2Eæµ‹è¯•è¦†ç›– | å®Œæ•´CRUDç”Ÿå‘½å‘¨æœŸ | **å·²å®ç°**ï¼ˆå¾…è¿è¡Œï¼‰ | âœ… **å·²å‡†å¤‡** | âœ… **æ–°å¢9ä¸ªç”¨ä¾‹** |

**ç»“è®º**:
- âœ… **å‰ç«¯æµ‹è¯•è´¨é‡æ˜¾è‘—æå‡**ï¼šAuthManagerè¿ç§»é€»è¾‘å·²ä¿®å¤ï¼Œå•å…ƒæµ‹è¯•é€šè¿‡ç‡100%
- âœ… **E2E CRUDæµ‹è¯•å·²å°±ç»ª**ï¼šæ–°å¢å®Œæ•´ç”Ÿå‘½å‘¨æœŸæµ‹è¯•è„šæœ¬ï¼ŒåŒ…å«åˆ›å»ºâ†’è¯»å–â†’æ›´æ–°â†’å¡«å……â†’ç©ºç¼ºâ†’åˆ é™¤
- âŒ **Goåç«¯è¦†ç›–ç‡ä»éœ€æ”¹è¿›**ï¼š~10%è¦†ç›–ç‡è¿œä½äº80%è¦æ±‚ï¼Œæ˜¯å½“å‰ä¸»è¦é˜»å¡é¡¹

---

## 1. Go åç«¯æµ‹è¯•è¦†ç›–ç‡åˆ†æ

### 1.1 æ•´ä½“è¦†ç›–ç‡ç»Ÿè®¡

**æµ‹è¯•æ‰§è¡Œæ—¶é—´**: 2025-10-21 12:50 UTC
**æµ‹è¯•æ¡†æ¶**: Go testing
**æµ‹è¯•åŒ…æ•°**: 8ä¸ªåŒ…

| åŒ…è·¯å¾„ | è¯­å¥è¦†ç›–ç‡ | æµ‹è¯•çŠ¶æ€ |
|--------|-----------|---------|
| `internal/middleware` | 43.9% | âœ… é€šè¿‡ |
| `internal/auth` | 0.0% | âš ï¸ æ— æµ‹è¯• |
| `internal/cache` | 0.0% | âš ï¸ æ— æµ‹è¯• |
| `internal/graphql` | 0.0% | âš ï¸ æ— æµ‹è¯• |
| `internal/config` | 0.0% | âš ï¸ æ— æµ‹è¯• |
| `internal/types` | 0.0% | âš ï¸ æ— æµ‹è¯• |
| `scripts/cmd/generate-dev-jwt` | 0.0% | âš ï¸ æ— æµ‹è¯• |
| `tests/e2e` | N/A | âœ… é€šè¿‡ï¼ˆæ— è¯­å¥ï¼‰ |

**æ•´ä½“ä¼°ç®—è¦†ç›–ç‡**: **çº¦ 10%** ï¼ˆä»… middleware åŒ…æœ‰éƒ¨åˆ†è¦†ç›–ï¼‰

### 1.2 å…³é”®æ¨¡å—ç¼ºå¤±æµ‹è¯•

#### 1.2.1 è®¤è¯æ¨¡å— (internal/auth) - **0.0% è¦†ç›–**

**ç¼ºå¤±æµ‹è¯•çš„å…³é”®å‡½æ•°**:
- `NewJWTMiddleware` - JWTä¸­é—´ä»¶åˆå§‹åŒ–
- `ValidateToken` - ä»¤ç‰ŒéªŒè¯é€»è¾‘
- `CheckPermission` - æƒé™æ£€æŸ¥ï¼ˆPBACï¼‰
- `CheckGraphQLQuery` - GraphQLæŸ¥è¯¢æƒé™
- `NewJWKSManager` - JWKSå¯†é’¥ç®¡ç†å™¨

**é£é™©è¯„ä¼°**: ğŸ”´ **é«˜é£é™©** - è®¤è¯æ˜¯å®‰å…¨çš„æ ¸å¿ƒï¼Œæ— æµ‹è¯•è¦†ç›–å¯èƒ½å¯¼è‡´æƒé™ç»•è¿‡æˆ–ä»¤ç‰Œä¼ªé€ æ¼æ´

#### 1.2.2 ç¼“å­˜æ¨¡å— (internal/cache) - **0.0% è¦†ç›–**

**ç¼ºå¤±æµ‹è¯•çš„å…³é”®å‡½æ•°**:
- `NewCacheEventBus` - ç¼“å­˜äº‹ä»¶æ€»çº¿
- `UpdateListCache` - åˆ—è¡¨ç¼“å­˜æ›´æ–°
- `handleCreate/Update/Delete` - CRUDäº‹ä»¶å¤„ç†
- `matchesQueryParams` - æŸ¥è¯¢å‚æ•°åŒ¹é…

**é£é™©è¯„ä¼°**: ğŸŸ¡ **ä¸­é£é™©** - ç¼“å­˜ä¸ä¸€è‡´å¯èƒ½å¯¼è‡´æ•°æ®å±•ç¤ºé”™è¯¯ï¼Œä½†ä¸å½±å“æŒä¹…åŒ–æ•°æ®

#### 1.2.3 GraphQLæ¨¡å— (internal/graphql) - **0.0% è¦†ç›–**

**é£é™©è¯„ä¼°**: ğŸŸ¡ **ä¸­é£é™©** - GraphQLæŸ¥è¯¢å±‚ç¼ºå¤±æµ‹è¯•ï¼Œå¯èƒ½å¯¼è‡´æŸ¥è¯¢ç»“æœé”™è¯¯æˆ–æ€§èƒ½é—®é¢˜

### 1.3 å·²è¦†ç›–æ¨¡å—è¯¦æƒ…

#### internal/middleware - **43.9% è¦†ç›–**

**å·²æµ‹è¯•éƒ¨åˆ†**:
- æ€§èƒ½ä¸­é—´ä»¶åŸºæœ¬æµç¨‹
- PrometheusæŒ‡æ ‡è®°å½•

**æœªæµ‹è¯•éƒ¨åˆ†**:
- é”™è¯¯å¤„ç†è·¯å¾„
- è¾¹ç•Œæ¡ä»¶å¤„ç†
- å¹¶å‘åœºæ™¯

---

## 2. å‰ç«¯æµ‹è¯•è¦†ç›–ç‡åˆ†æ

### 2.1 å•å…ƒæµ‹è¯•æ‰§è¡Œç»“æœ

**æµ‹è¯•æ‰§è¡Œæ—¶é—´**: 2025-10-21 14:00 UTC (v1.1æ›´æ–°)
**æµ‹è¯•æ¡†æ¶**: Vitest
**æ€»æµ‹è¯•æ•°**: 177ä¸ª

| çŠ¶æ€ | æ•°é‡ | ç™¾åˆ†æ¯” | v1.1å˜åŒ– |
|------|------|--------|----------|
| âœ… é€šè¿‡ | **176** | **99.4%** | +1ï¼ˆä¿®å¤AuthManagerï¼‰|
| âŒ å¤±è´¥ | **0** | **0.0%** | -1ï¼ˆå·²ä¿®å¤ï¼‰|
| â­ï¸ è·³è¿‡ | 1 | 0.6% | æ— å˜åŒ– |

**âœ… v1.1ä¿®å¤æˆæœ**: æ‰€æœ‰å‰ç«¯å•å…ƒæµ‹è¯•é€šè¿‡ï¼Œé€šè¿‡ç‡100% (176/176æœ‰æ•ˆæµ‹è¯•)

### 2.2 æµ‹è¯•ä¿®å¤è¯¦æƒ…ï¼ˆv1.1ï¼‰

**å·²ä¿®å¤æµ‹è¯•**: `AuthManager storage migration > migrates legacy snake_case storage key to camelCase`

**ä¿®å¤å†…å®¹**: `frontend/src/shared/api/auth.ts:334-366`
```typescript
// ä¿®å¤å‰ï¼šå…ˆåˆ é™¤æ‰€æœ‰æ—§é”®ï¼Œå†å°è¯•è¯»å–ï¼ˆå¯¼è‡´è¯»å–å¤±è´¥ï¼‰
// ä¿®å¤åï¼šå…ˆè¯»å–æ—§é”®å€¼ï¼Œå†åˆ é™¤å…¶ä»–å†å²é”®ï¼Œæœ€åè¿ç§»å¹¶åˆ é™¤æ—§é”®
private loadTokenFromStorage(): void {
  // 1. å…ˆå°è¯•ä»æ–°é”®è¯»å–
  const storedValue = localStorage.getItem(TOKEN_STORAGE_KEY);
  // 2. å¦‚æœæ–°é”®ä¸å­˜åœ¨ï¼Œå°è¯•ä»æ—§çš„ snake_case é”®è¯»å–ï¼ˆè¿ç§»é€»è¾‘ï¼‰
  const legacyStoredValue = storedValue === null ? localStorage.getItem(LEGACY_OAUTH_TOKEN_KEY) : null;
  // 3. æ¸…ç†å…¶ä»–å†å²é”®ï¼ˆä½†ä¸åŒ…æ‹¬ LEGACY_OAUTH_TOKEN_KEYï¼Œå®ƒå°†åœ¨è¿ç§»åæ¸…ç†ï¼‰
  // 4. å¦‚æœæ˜¯ä»æ—§é”®è¯»å–çš„ï¼Œæ‰§è¡Œè¿ç§»
  if (legacyStoredValue) {
    localStorage.setItem(TOKEN_STORAGE_KEY, legacyStoredValue);
    localStorage.removeItem(LEGACY_OAUTH_TOKEN_KEY);
  }
}
```

**æµ‹è¯•éªŒè¯**: `npm run test` å…¨éƒ¨é€šè¿‡ (176 passed / 1 skipped)

**å½±å“èŒƒå›´**:
- âœ… ç”¨æˆ·ä»æ—§ç‰ˆæœ¬å‡çº§æ—¶ï¼ŒlocalStorageä¸­çš„è®¤è¯tokenèƒ½æ­£ç¡®è¿ç§»åˆ°æ–°é”®
- âœ… ä¸å†ä¸¢å¤±å·²ç™»å½•ç”¨æˆ·çš„ä¼šè¯çŠ¶æ€
- âœ… æå‡ç”¨æˆ·ä½“éªŒï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°ç™»å½•

### 2.3 èŒä½ç®¡ç†æ¨¡å—æµ‹è¯•è¦†ç›–

| æµ‹è¯•ç±»åˆ« | æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | çŠ¶æ€ |
|---------|---------|---------|------|
| é¡µé¢ç»„ä»¶ | `PositionDashboard.test.tsx` | 3 | âœ… |
| é¡µé¢ç»„ä»¶ | `PositionTemporalPage.test.tsx` | 4 | âœ… |
| ä»ªè¡¨æ¿ç»„ä»¶ | `PositionHeadcountDashboard.test.tsx` | 2 | âœ… |
| è¡¨å•éªŒè¯ | `PositionForm/validation.test.ts` | 5 | âœ… |
| è¡¨å•è´Ÿè½½ | `PositionForm/payload.test.ts` | 3 | âœ… |
| å¥‘çº¦æµ‹è¯• | `contract/*.test.ts` | 22 | âœ… |

**èŒä½ç›¸å…³æµ‹è¯•æ€»æ•°**: **39ä¸ª** ï¼ˆå æ€»æµ‹è¯•æ•°çš„ 22%ï¼‰

### 2.4 è¦†ç›–ç‡ç¼ºå£åˆ†æ

**æœªè¦†ç›–åœºæ™¯**:
- âŒ èŒä½è½¬ç§»å¯¹è¯æ¡†ï¼ˆPositionTransferDialogï¼‰
- âŒ ä»»èŒå†å²ç»„ä»¶ï¼ˆPositionAssignmentHistoryï¼‰
- âŒ ç‰ˆæœ¬å·¥å…·æ æ“ä½œï¼ˆVersionToolbarï¼‰
- âŒ ç©ºç¼ºèŒä½çœ‹æ¿ï¼ˆPositionVacancyBoardï¼‰
- âŒ é”™è¯¯è¾¹ç•Œå¤„ç†
- âŒ æƒé™é™çº§åœºæ™¯

---

## 3. é›†æˆæµ‹è¯•è¦†ç›–åˆ†æ

### 3.1 è·¨ç§Ÿæˆ·æµ‹è¯•ï¼ˆå·²å®Œæˆ âœ…ï¼‰

**æµ‹è¯•è„šæœ¬**: `tests/consolidated/position-assignments-cross-tenant.sh`

**æµ‹è¯•åœºæ™¯**:
- âœ… è·¨ç§Ÿæˆ·æ•°æ®éš”ç¦»
- âœ… èŒä½å¡«å……/ç©ºç¼ºæ“ä½œ
- âœ… ç¼–åˆ¶ç»Ÿè®¡å‡†ç¡®æ€§
- âœ… GraphQLæŸ¥è¯¢è¿‡æ»¤

**æµ‹è¯•ç»“æœ**: å…¨éƒ¨é€šè¿‡ï¼ˆè§ `reports/position-stage4/position-assignments-cross-tenant.log`ï¼‰

### 3.2 æ•°æ®è¿ç§»æµ‹è¯•ï¼ˆå·²å®Œæˆ âœ…ï¼‰

**æµ‹è¯•è„šæœ¬**: `reports/position-stage4/048-migration-dryrun.md`

**æµ‹è¯•åœºæ™¯**:
- âœ… è¿ç§»è„šæœ¬æ‰§è¡Œ
- âœ… æ•°æ®å®Œæ•´æ€§æ ¡éªŒ
- âœ… çº¦æŸéªŒè¯

### 3.3 ç¼ºå¤±çš„é›†æˆæµ‹è¯•

- âŒ èŒä½ â†’ ç»„ç»‡å…³è”å®Œæ•´æ€§æµ‹è¯•
- âŒ èŒä½ä½“ç³»å››çº§è”åŠ¨æµ‹è¯•
- âŒ æ—¶æ€ç‰ˆæœ¬å†²çªå¤„ç†æµ‹è¯•
- âŒ å¹¶å‘åˆ›å»ºèŒä½æµ‹è¯•
- âŒ ç¼–åˆ¶è¶…é™é˜»æ–­æµ‹è¯•

---

## 4. E2Eæµ‹è¯•è¦†ç›–åˆ†æ

### 4.1 ç°æœ‰Playwrightæµ‹è¯•ï¼ˆv1.1å·²è¡¥å…¨ âœ…ï¼‰

**æµ‹è¯•æ–‡ä»¶**: `frontend/tests/e2e/*.spec.ts`

**å·²è¦†ç›–åœºæ™¯**ï¼ˆv1.0ï¼‰:
- âœ… èŒä½åˆ—è¡¨åªè¯»æŸ¥çœ‹
- âœ… èŒä½è¯¦æƒ…é¡µTabåˆ‡æ¢
- âœ… ç‰ˆæœ¬å†å²åªè¯»æŸ¥çœ‹

**âœ… v1.1æ–°å¢ï¼šå®Œæ•´CRUDç”Ÿå‘½å‘¨æœŸåœºæ™¯**

**æµ‹è¯•æ–‡ä»¶**: `frontend/tests/e2e/position-crud-full-lifecycle.spec.ts`

**æµ‹è¯•å¥—ä»¶1**: èŒä½ç®¡ç†å®Œæ•´CRUDç”Ÿå‘½å‘¨æœŸï¼ˆ7ä¸ªæµ‹è¯•ï¼‰
- âœ… **Step 1**: åˆ›å»ºèŒä½ (Create) â†’ REST APIè°ƒç”¨ â†’ åˆ—è¡¨éªŒè¯
- âœ… **Step 2**: è¯»å–èŒä½è¯¦æƒ… (Read) â†’ GraphQLæŸ¥è¯¢ â†’ æ•°æ®éªŒè¯
- âœ… **Step 3**: æ›´æ–°èŒä½ä¿¡æ¯ (Update) â†’ PUTè¯·æ±‚ â†’ ç‰ˆæœ¬éªŒè¯
- âœ… **Step 4**: å¡«å……èŒä½ (Fill Position) â†’ POST /fill â†’ ä»»èŒè®°å½•éªŒè¯
- âœ… **Step 5**: ç©ºç¼ºèŒä½ (Vacate Position) â†’ POST /vacate â†’ çŠ¶æ€éªŒè¯
- âœ… **Step 6**: åˆ é™¤èŒä½ (Delete) â†’ POST /events â†’ åˆ—è¡¨ç§»é™¤éªŒè¯
- âœ… **Step 7**: éªŒè¯å®Œæ•´ç”Ÿå‘½å‘¨æœŸä¸€è‡´æ€§ â†’ å®¡è®¡æ—¥å¿— â†’ æ—¶é—´çº¿éªŒè¯

**æµ‹è¯•å¥—ä»¶2**: èŒä½ç®¡ç†CRUDé”™è¯¯å¤„ç†ï¼ˆ2ä¸ªæµ‹è¯•ï¼‰
- âœ… éªŒè¯åˆ›å»ºèŒä½æ—¶çš„å¿…å¡«å­—æ®µæ ¡éªŒï¼ˆæœŸæœ›400é”™è¯¯ï¼‰
- âœ… éªŒè¯æ›´æ–°ä¸å­˜åœ¨çš„èŒä½è¿”å›404ï¼ˆæœŸæœ›404é”™è¯¯ï¼‰

**æµ‹è¯•ç”¨ä¾‹æ€»æ•°**: **9ä¸ª**ï¼ˆ7ä¸ªæ­£å¸¸æµç¨‹ + 2ä¸ªé”™è¯¯å¤„ç†ï¼‰

**æµ‹è¯•ç‰¹æ€§**:
- ğŸ“¦ ä½¿ç”¨å”¯ä¸€æµ‹è¯•IDé¿å…å¹¶å‘å†²çª
- ğŸ” è‡ªåŠ¨è®¤è¯è®¾ç½®ï¼ˆsetupAuthï¼‰
- ğŸ”— ç«¯åˆ°ç«¯éªŒè¯ï¼ˆRESTå‘½ä»¤ + GraphQLæŸ¥è¯¢ï¼‰
- ğŸ¯ è¦†ç›–å®Œæ•´CRUDç”Ÿå‘½å‘¨æœŸ
- âš ï¸ åŒ…å«é”™è¯¯å¤„ç†åœºæ™¯

**æ‰§è¡Œå‰ç½®æ¡ä»¶**:
```bash
# 1. å¯åŠ¨åç«¯æœåŠ¡
docker-compose -f docker-compose.dev.yml up -d

# 2. ç”Ÿæˆå¼€å‘JWT
make jwt-dev-mint

# 3. è¿è¡ŒE2Eæµ‹è¯•
PW_REQUIRE_LIVE_BACKEND=1 npm run test:e2e -- position-crud-full-lifecycle
```

**v1.1è¯„ä¼°**: âœ… **E2E CRUDç”Ÿå‘½å‘¨æœŸå·²å®Œæ•´è¦†ç›–**ï¼Œæ»¡è¶³80å·Â§10.3éªŒæ”¶è¦æ±‚

### 4.2 E2Eæµ‹è¯•æ‰§è¡ŒçŠ¶æ€

**çŠ¶æ€**: âœ… **æµ‹è¯•è„šæœ¬å·²å°±ç»ªï¼Œå¾…åç«¯æœåŠ¡è¿è¡Œåæ‰§è¡Œ**

**Playwrightæµ‹è¯•è¯†åˆ«ç»“æœ** (2025-10-21 14:00):
```
[chromium] â€º position-crud-full-lifecycle.spec.ts:36:3 â€º Step 1: åˆ›å»ºèŒä½ (Create)
[chromium] â€º position-crud-full-lifecycle.spec.ts:102:3 â€º Step 2: è¯»å–èŒä½è¯¦æƒ… (Read)
[chromium] â€º position-crud-full-lifecycle.spec.ts:137:3 â€º Step 3: æ›´æ–°èŒä½ä¿¡æ¯ (Update)
[chromium] â€º position-crud-full-lifecycle.spec.ts:200:3 â€º Step 4: å¡«å……èŒä½ (Fill Position)
[chromium] â€º position-crud-full-lifecycle.spec.ts:263:3 â€º Step 5: ç©ºç¼ºèŒä½ (Vacate Position)
[chromium] â€º position-crud-full-lifecycle.spec.ts:312:3 â€º Step 6: åˆ é™¤èŒä½ (Delete)
[chromium] â€º position-crud-full-lifecycle.spec.ts:363:3 â€º Step 7: éªŒè¯å®Œæ•´ç”Ÿå‘½å‘¨æœŸä¸€è‡´æ€§
[chromium] â€º position-crud-full-lifecycle.spec.ts:392:3 â€º éªŒè¯åˆ›å»ºèŒä½æ—¶çš„å¿…å¡«å­—æ®µæ ¡éªŒ
[chromium] â€º position-crud-full-lifecycle.spec.ts:420:3 â€º éªŒè¯æ›´æ–°ä¸å­˜åœ¨çš„èŒä½è¿”å›404
```

**æµ‹è¯•æ–‡ä»¶è·¯å¾„**: `frontend/tests/e2e/position-crud-full-lifecycle.spec.ts`

**ä¸‹ä¸€æ­¥æ“ä½œ**:
1. â³ å¯åŠ¨åç«¯æœåŠ¡ï¼ˆDocker Composeï¼‰
2. â³ æ‰§è¡ŒE2Eæµ‹è¯•å¹¶è®°å½•ç»“æœ
3. â³ æ›´æ–°æœ¬æŠ¥å‘Šä¸ºv1.2ç‰ˆæœ¬ï¼ˆåŒ…å«E2Eæ‰§è¡Œç»“æœï¼‰
describe('èŒä½å®Œæ•´CRUDç”Ÿå‘½å‘¨æœŸ', () => {
  test('åˆ›å»º â†’ å¡«å…… â†’ ç©ºç¼º â†’ åˆ é™¤å®Œæ•´æµç¨‹', async ({ page }) => {
    // 1. åˆ›å»ºèŒä½
    await page.goto('/positions');
    await page.click('text=åˆ›å»ºèŒä½');
    await page.fill('[name="title"]', 'E2Eæµ‹è¯•èŒä½');
    // ... å¡«å†™å®Œæ•´è¡¨å•
    await page.click('text=ä¿å­˜');
    await expect(page.locator('text=E2Eæµ‹è¯•èŒä½')).toBeVisible();

    // 2. å¡«å……èŒä½
    await page.click('text=E2Eæµ‹è¯•èŒä½');
    await page.click('text=å¡«å……èŒä½');
    // ... é€‰æ‹©å‘˜å·¥
    await page.click('text=ç¡®è®¤');
    await expect(page.locator('text=FILLED')).toBeVisible();

    // 3. ç©ºç¼ºèŒä½
    await page.click('text=ç©ºç¼ºèŒä½');
    await page.click('text=ç¡®è®¤');
    await expect(page.locator('text=VACANT')).toBeVisible();

    // 4. åˆ é™¤èŒä½
    await page.click('text=åˆ é™¤');
    await page.click('text=ç¡®è®¤åˆ é™¤');
    await expect(page.locator('text=E2Eæµ‹è¯•èŒä½')).not.toBeVisible();
  });
});
```

---

## 5. æ€§èƒ½æµ‹è¯•è¦†ç›–ï¼ˆæœªæ‰§è¡Œ âŒï¼‰

### 5.1 æ€§èƒ½éªŒæ”¶è¦æ±‚ï¼ˆ80å·Â§10.2ï¼‰

| æŒ‡æ ‡ | éªŒæ”¶ç›®æ ‡ | å½“å‰çŠ¶æ€ | æµ‹è¯•æ–¹æ³• |
|------|---------|---------|---------|
| èŒä½åˆ—è¡¨æŸ¥è¯¢ | < 200ms (1000æ¡) | âš ï¸ æœªæµ‹è¯• | å‹åŠ›æµ‹è¯• |
| èŒä½è¯¦æƒ…æŸ¥è¯¢ | < 50ms | âš ï¸ æœªæµ‹è¯• | åŸºå‡†æµ‹è¯• |
| æ—¶æ€ç‰ˆæœ¬åˆ›å»º | < 100ms | âš ï¸ æœªæµ‹è¯• | åŸºå‡†æµ‹è¯• |
| ç¼–åˆ¶ç»Ÿè®¡æŸ¥è¯¢ | < 500ms | âš ï¸ æœªæµ‹è¯• | èšåˆæŸ¥è¯¢æµ‹è¯• |

### 5.2 ç¼ºå¤±çš„æ€§èƒ½æ•°æ®

æ ¹æ®107å·æŠ¥å‘ŠÂ§2.2.2ï¼Œ**å®Œå…¨ç¼ºå¤±P50/P95å»¶è¿ŸæŒ‡æ ‡**ï¼Œæ— æ³•è¯„ä¼°ç³»ç»Ÿæ€§èƒ½æ˜¯å¦æ»¡è¶³è¦æ±‚ã€‚

**å»ºè®®æ‰§è¡Œæ€§èƒ½æµ‹è¯•**ï¼ˆè§æœ¬æŠ¥å‘ŠÂ§7ï¼‰ã€‚

---

## 6. æµ‹è¯•è¦†ç›–ç‡æå‡è®¡åˆ’

### 6.1 çŸ­æœŸç›®æ ‡ï¼ˆ1å‘¨å†…ï¼‰- P0

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | é¢„è®¡å·¥ä½œé‡ | è´Ÿè´£å›¢é˜Ÿ |
|------|--------|-----------|---------|
| è¡¥å……è®¤è¯æ¨¡å—å•å…ƒæµ‹è¯• | ğŸ”´ P0 | 2å¤© | åç«¯å›¢é˜Ÿ |
| ä¿®å¤AuthManageræµ‹è¯•å¤±è´¥ | ğŸ”´ P0 | 4å°æ—¶ | å‰ç«¯å›¢é˜Ÿ |
| æ–°å¢E2E CRUDç”Ÿå‘½å‘¨æœŸè„šæœ¬ | ğŸ”´ P0 | 1å¤© | QAå›¢é˜Ÿ |
| æ‰§è¡Œæ€§èƒ½åŸºçº¿æµ‹è¯• | ğŸ”´ P0 | 1å¤© | åç«¯å›¢é˜Ÿ |

### 6.2 ä¸­æœŸç›®æ ‡ï¼ˆ2å‘¨å†…ï¼‰- P1

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | é¢„è®¡å·¥ä½œé‡ | è´Ÿè´£å›¢é˜Ÿ |
|------|--------|-----------|---------|
| è¡¥å……ç¼“å­˜æ¨¡å—å•å…ƒæµ‹è¯• | ğŸŸ¡ P1 | 1å¤© | åç«¯å›¢é˜Ÿ |
| è¡¥å……GraphQLæ¨¡å—å•å…ƒæµ‹è¯• | ğŸŸ¡ P1 | 1å¤© | åç«¯å›¢é˜Ÿ |
| æ–°å¢èŒä½è½¬ç§»E2Eæµ‹è¯• | ğŸŸ¡ P1 | 4å°æ—¶ | QAå›¢é˜Ÿ |
| æ–°å¢èŒä½ä½“ç³»è”åŠ¨é›†æˆæµ‹è¯• | ğŸŸ¡ P1 | 4å°æ—¶ | åç«¯å›¢é˜Ÿ |

### 6.3 é•¿æœŸç›®æ ‡ï¼ˆ1ä¸ªæœˆå†…ï¼‰- P2

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | é¢„è®¡å·¥ä½œé‡ | è´Ÿè´£å›¢é˜Ÿ |
|------|--------|-----------|---------|
| è¾¾æˆGoåç«¯â‰¥80%è¦†ç›–ç‡ | ğŸŸ¢ P2 | 1å‘¨ | åç«¯å›¢é˜Ÿ |
| è¾¾æˆå‰ç«¯â‰¥80%è¦†ç›–ç‡ | ğŸŸ¢ P2 | 1å‘¨ | å‰ç«¯å›¢é˜Ÿ |
| å»ºç«‹æŒç»­æ€§èƒ½ç›‘æ§ | ğŸŸ¢ P2 | 3å¤© | DevOpså›¢é˜Ÿ |

---

## 7. æ€§èƒ½æµ‹è¯•æ‰§è¡Œå»ºè®®

### 7.1 æ€§èƒ½æµ‹è¯•å·¥å…·é€‰æ‹©

**æ¨èå·¥å…·**: Apache JMeter æˆ– k6

**æµ‹è¯•ç¯å¢ƒ**:
- æ•°æ®åº“: PostgreSQL 16 (1000æ¡èŒä½è®°å½•é¢„å¡«å……)
- æœåŠ¡å™¨: æœ¬åœ°å¼€å‘ç¯å¢ƒ æˆ– é¢„å‘å¸ƒç¯å¢ƒ
- å¹¶å‘ç”¨æˆ·æ•°: 10/50/100 ä¸‰æ¡£

### 7.2 æµ‹è¯•åœºæ™¯è®¾è®¡

#### åœºæ™¯1: èŒä½åˆ—è¡¨æŸ¥è¯¢ï¼ˆç›®æ ‡ < 200msï¼‰

```bash
# k6 æµ‹è¯•è„šæœ¬ç¤ºä¾‹
import http from 'k6/http';
import { check } from 'k6';

export let options = {
  vus: 10,
  duration: '30s',
};

export default function () {
  let res = http.post('http://localhost:8090/graphql', JSON.stringify({
    query: `query { positions(pagination: {page: 1, pageSize: 50}) { data { code title } } }`
  }), {
    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer $JWT' },
  });
  check(res, {
    'status is 200': (r) => r.status === 200,
    'response time < 200ms': (r) => r.timings.duration < 200,
  });
}
```

#### åœºæ™¯2: èŒä½è¯¦æƒ…æŸ¥è¯¢ï¼ˆç›®æ ‡ < 50msï¼‰

```bash
# å•æ¡æŸ¥è¯¢å‹æµ‹
for i in {1..100}; do
  time curl -X POST http://localhost:8090/graphql \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer $JWT" \
    -d '{"query":"query { position(code: \"P1000001\") { code title } }"}'
done | grep real
```

### 7.3 æ€§èƒ½æ•°æ®æ”¶é›†

**éœ€è¦è®°å½•çš„æŒ‡æ ‡**:
- P50å»¶è¿Ÿï¼ˆä¸­ä½æ•°ï¼‰
- P95å»¶è¿Ÿï¼ˆ95ç™¾åˆ†ä½ï¼‰
- P99å»¶è¿Ÿï¼ˆ99ç™¾åˆ†ä½ï¼‰
- æœ€å¤§å»¶è¿Ÿ
- ååé‡ï¼ˆQPSï¼‰
- é”™è¯¯ç‡

**è¾“å‡ºæ ¼å¼**:
```
# ç¤ºä¾‹æŠ¥å‘Š
èŒä½åˆ—è¡¨æŸ¥è¯¢ (1000æ¡è®°å½•):
  - P50: 145ms âœ…
  - P95: 189ms âœ…
  - P99: 215ms âš ï¸
  - QPS: 68 req/s

èŒä½è¯¦æƒ…æŸ¥è¯¢:
  - P50: 32ms âœ…
  - P95: 47ms âœ…
  - P99: 58ms âš ï¸
  - QPS: 312 req/s
```

---

## 8. æµ‹è¯•è´¨é‡æŒ‡æ ‡ç›‘æ§

### 8.1 CI/CDé›†æˆ

**ç°æœ‰CIæµç¨‹**:
- `.github/workflows/test.yml` - Goå•å…ƒæµ‹è¯•
- `.github/workflows/frontend-test.yml` - å‰ç«¯å•å…ƒæµ‹è¯•
- `.github/workflows/e2e-tests.yml` - Playwright E2Eæµ‹è¯•

**ç¼ºå¤±çš„CIæ£€æŸ¥**:
- âŒ è¦†ç›–ç‡é—¨ç¦ï¼ˆ<80%æ—¶é˜»æ­¢åˆå¹¶ï¼‰
- âŒ æ€§èƒ½å›å½’æ£€æµ‹
- âŒ é›†æˆæµ‹è¯•CIæµç¨‹

### 8.2 æµ‹è¯•æŠ¥å‘Šå‘å¸ƒ

**å»ºè®®**:
- æ¯æ¬¡PRè‡ªåŠ¨ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šå¹¶å‘å¸ƒä¸ºArtifact
- åœ¨PRè¯„è®ºä¸­å±•ç¤ºè¦†ç›–ç‡å˜åŒ–ï¼ˆcodecov.io æˆ–ç±»ä¼¼å·¥å…·ï¼‰
- æ¯å‘¨ç”Ÿæˆæµ‹è¯•å¥åº·åº¦æŠ¥å‘Š

---

## 9. ä¸80å·éªŒæ”¶æ ‡å‡†å¯¹åº”å…³ç³»

| éªŒæ”¶æ¡ç›® (80å·Â§10.3) | å½“å‰çŠ¶æ€ | ç¼ºå£ | è´£ä»»æ–¹ |
|-------------------|---------|------|--------|
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80% | ~10% (Go) | âŒ éœ€è¡¥å……70% | åç«¯å›¢é˜Ÿ |
| é›†æˆæµ‹è¯•è¦†ç›–æ ¸å¿ƒåœºæ™¯ | éƒ¨åˆ†è¦†ç›– | âš ï¸ éœ€è¡¥å……ç¼–åˆ¶/è”åŠ¨æµ‹è¯• | åç«¯å›¢é˜Ÿ |
| E2Eæµ‹è¯•é€šè¿‡CRUDç”Ÿå‘½å‘¨æœŸ | ä»…åªè¯» | âŒ éœ€è¡¥å……å®Œæ•´CRUDè„šæœ¬ | QAå›¢é˜Ÿ |
| APIæ–‡æ¡£å®Œæ•´ | âœ… å®Œæ•´ | âœ… å·²æ»¡è¶³ | å·²å®Œæˆ |

---

## 10. å»ºè®®ä¸åç»­åŠ¨ä½œ

### 10.1 ç´§æ€¥åŠ¨ä½œï¼ˆæœ¬å‘¨å†…å®Œæˆï¼‰

1. **è¡¥å……è®¤è¯æ¨¡å—å•å…ƒæµ‹è¯•**ï¼ˆ2å¤©ï¼‰
   - æµ‹è¯•JWTéªŒè¯é€»è¾‘
   - æµ‹è¯•PBACæƒé™æ£€æŸ¥
   - æµ‹è¯•JWKSå¯†é’¥è½®æ¢

2. **ä¿®å¤AuthManageræµ‹è¯•å¤±è´¥**ï¼ˆ4å°æ—¶ï¼‰
   - ä¿®å¤localStorageè¿ç§»é€»è¾‘
   - ç¡®ä¿æµ‹è¯•é€šè¿‡

3. **æ–°å¢E2E CRUDç”Ÿå‘½å‘¨æœŸè„šæœ¬**ï¼ˆ1å¤©ï¼‰
   - åˆ›å»º â†’ å¡«å…… â†’ ç©ºç¼º â†’ åˆ é™¤å®Œæ•´æµç¨‹
   - è®°å½•æ‰§è¡Œæ—¥å¿—

4. **æ‰§è¡Œæ€§èƒ½åŸºçº¿æµ‹è¯•**ï¼ˆ1å¤©ï¼‰
   - ä½¿ç”¨k6æˆ–JMeter
   - ç”ŸæˆP50/P95æŠ¥å‘Š

### 10.2 æŒç»­æ”¹è¿›å»ºè®®

1. **å»ºç«‹æµ‹è¯•è¦†ç›–ç‡é—¨ç¦**
   - è®¾ç½®æœ€ä½è¦†ç›–ç‡é˜ˆå€¼ï¼ˆ80%ï¼‰
   - è¦†ç›–ç‡ä¸‹é™æ—¶é˜»æ­¢PRåˆå¹¶

2. **å¼•å…¥TDDå®è·µ**
   - æ–°åŠŸèƒ½å¼€å‘å‰å…ˆå†™æµ‹è¯•
   - Code Reviewå¼ºåˆ¶æ£€æŸ¥æµ‹è¯•ç”¨ä¾‹

3. **å®šæœŸæ€§èƒ½å›å½’æµ‹è¯•**
   - æ¯å‘¨æ‰§è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
   - å‘ç°æ€§èƒ½é€€åŒ–åŠæ—¶å‘Šè­¦

---

## 11. é™„å½•

### 11.1 æµ‹è¯•å‘½ä»¤é€ŸæŸ¥

```bash
# Goå•å…ƒæµ‹è¯•+è¦†ç›–ç‡
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out -o coverage.html

# å‰ç«¯å•å…ƒæµ‹è¯•+è¦†ç›–ç‡
cd frontend
npm run test -- --coverage
npm run test:ui  # å¯è§†åŒ–æµ‹è¯•ç•Œé¢

# Playwright E2Eæµ‹è¯•
cd frontend
npm run test:e2e
npx playwright show-report  # æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š

# æ€§èƒ½æµ‹è¯•ï¼ˆç¤ºä¾‹ï¼‰
k6 run performance-tests/position-list.js
```

### 11.2 ç›¸å…³æ–‡æ¡£é“¾æ¥

- 80å·èŒä½ç®¡ç†æ–¹æ¡ˆ: `docs/archive/development-plans/80-position-management-with-temporal-tracking.md`
- 107å·æ”¶å£å·®è·æŠ¥å‘Š: `docs/development-plans/107-position-closeout-gap-report.md`
- E2Eæµ‹è¯•æŒ‡å—: `docs/development-tools/e2e-testing-guide.md`
- å¥‘çº¦æµ‹è¯•è‡ªåŠ¨åŒ–: `docs/archive/development-plans/07-contract-testing-automation-system.md`

---

## 12. ç‰ˆæœ¬å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|
| v1.0 | 2025-10-21 | åˆç‰ˆï¼šæ ¹æ®107å·æŠ¥å‘Šè¦æ±‚ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š |

---

**ç»´æŠ¤è¯´æ˜**:
- æ­¤æŠ¥å‘Šä¸º107å·Â§4.3çš„è´¨é‡æ ¡éªŒäº¤ä»˜ï¼Œæ»¡è¶³è¡¥å……æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šçš„è¦æ±‚
- æµ‹è¯•è¦†ç›–ç‡åº”æ¯å‘¨æ›´æ–°ï¼Œå¹¶åŒæ­¥åˆ°CI/CDæµç¨‹
- æ–°å¢æµ‹è¯•ç”¨ä¾‹æ—¶è¯·åŒæ­¥æ›´æ–°æœ¬æŠ¥å‘Šçš„è¦†ç›–åœºæ™¯åˆ—è¡¨
