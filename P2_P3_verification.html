<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P2/P3é˜¶æ®µåŠŸèƒ½éªŒè¯ - Cube Castle HRç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .phase-section {
            margin-bottom: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .phase-header {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 20px;
            font-size: 1.4em;
            font-weight: bold;
        }
        
        .phase-content {
            padding: 25px;
        }
        
        .test-group {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .test-group-header {
            background: #f5f5f5;
            padding: 15px;
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #ddd;
        }
        
        .test-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .test-item:last-child {
            border-bottom: none;
        }
        
        .test-info {
            flex: 1;
        }
        
        .test-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .test-desc {
            color: #666;
            font-size: 0.9em;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary {
            background: #2196F3;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(33,150,243,0.3);
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-success:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(76,175,80,0.3);
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(23,162,184,0.3);
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
            display: inline-block;
        }
        
        .status-ready { background: #4CAF50; }
        .status-testing { background: #FF9800; animation: pulse 1.5s infinite; }
        .status-success { background: #4CAF50; }
        .status-error { background: #f44336; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .result-panel {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 4px solid #2196F3;
            display: none;
        }
        
        .result-panel.show {
            display: block;
        }
        
        .result-panel pre {
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.85em;
            margin-top: 10px;
        }
        
        .summary-section {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .summary-item {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .summary-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .summary-label {
            opacity: 0.9;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .footer {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ° Cube Castle HR ç³»ç»Ÿ</h1>
            <p>P2/P3é˜¶æ®µåŠŸèƒ½éªŒè¯é¢æ¿</p>
            <div style="margin-top: 15px;">
                <span style="background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px;">
                    ç‰ˆæœ¬: v1.2.1 | åˆ†æ”¯: feature/p2-p3-implementation
                </span>
            </div>
        </div>
        
        <div class="content">
            <!-- P2é˜¶æ®µéªŒè¯ -->
            <div class="phase-section">
                <div class="phase-header">
                    ğŸ§ª P2é˜¶æ®µéªŒè¯: Python AIæœåŠ¡Mockæ¡†æ¶é‡æ„
                </div>
                <div class="phase-content">
                    <div class="test-group">
                        <div class="test-group-header">
                            <span class="status-indicator status-ready"></span>
                            Mockæ¡†æ¶ç¨³å®šæ€§æµ‹è¯•
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">é‡æ„åçš„Mockæµ‹è¯•å¥—ä»¶</div>
                                <div class="test-desc">è¿è¡Œtest_ai_service_refactored.py - éªŒè¯100%é€šè¿‡ç‡</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-primary" onclick="runTest('p2-mock', 'python-ai/test_ai_service_refactored.py')">
                                    è¿è¡Œæµ‹è¯•
                                </button>
                                <button class="btn btn-info" onclick="viewCode('python-ai/test_ai_service_refactored.py')">
                                    æŸ¥çœ‹ä»£ç 
                                </button>
                            </div>
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬</div>
                                <div class="test-desc">è¿è¡Œrun_stable_tests.sh - å®Œæ•´æµ‹è¯•æµç¨‹éªŒè¯</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-success" onclick="runTest('p2-auto', 'python-ai/run_stable_tests.sh')">
                                    è¿è¡Œè„šæœ¬
                                </button>
                                <button class="btn btn-info" onclick="viewCode('python-ai/run_stable_tests.sh')">
                                    æŸ¥çœ‹è„šæœ¬
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="test-group">
                        <div class="test-group-header">
                            <span class="status-indicator status-ready"></span>
                            AIæœåŠ¡åŠŸèƒ½éªŒè¯
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">Intentè¯†åˆ«APIæµ‹è¯•</div>
                                <div class="test-desc">æµ‹è¯•AIæœåŠ¡çš„æ„å›¾è¯†åˆ«åŠŸèƒ½ - ç”µè¯å·ç æ›´æ–°åœºæ™¯</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-primary" onclick="testAIService()">
                                    æµ‹è¯•AIæœåŠ¡
                                </button>
                                <button class="btn btn-info" onclick="showAILogs()">
                                    æŸ¥çœ‹æ—¥å¿—
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-panel" id="p2-results">
                        <h4>P2æµ‹è¯•ç»“æœ</h4>
                        <div id="p2-output"></div>
                    </div>
                </div>
            </div>
            
            <!-- P3é˜¶æ®µéªŒè¯ -->
            <div class="phase-section">
                <div class="phase-header">
                    ğŸš€ P3é˜¶æ®µéªŒè¯: Goåç«¯æµ‹è¯•ä»£ç åŒæ­¥
                </div>
                <div class="phase-content">
                    <div class="test-group">
                        <div class="test-group-header">
                            <span class="status-indicator status-ready"></span>
                            Goæ¨¡å—ç¼–è¯‘æµ‹è¯•
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">CoreHRæ¨¡å—æµ‹è¯•</div>
                                <div class="test-desc">éªŒè¯å‘˜å·¥ç®¡ç†ã€ç»„ç»‡æ¶æ„APIæµ‹è¯• - 8ä¸ªæµ‹è¯•ç”¨ä¾‹</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-primary" onclick="runGoTest('corehr')">
                                    è¿è¡Œæµ‹è¯•
                                </button>
                                <button class="btn btn-info" onclick="viewCode('go-app/internal/corehr/service_test.go')">
                                    æŸ¥çœ‹æµ‹è¯•
                                </button>
                            </div>
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">IntelligenceGatewayæ¨¡å—æµ‹è¯•</div>
                                <div class="test-desc">éªŒè¯AIç½‘å…³æœåŠ¡ã€gRPCé€šä¿¡ - 8ä¸ªæµ‹è¯•ç”¨ä¾‹</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-primary" onclick="runGoTest('intelligencegateway')">
                                    è¿è¡Œæµ‹è¯•
                                </button>
                                <button class="btn btn-info" onclick="viewCode('go-app/internal/intelligencegateway/service_test.go')">
                                    æŸ¥çœ‹æµ‹è¯•
                                </button>
                            </div>
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">Commonæ¨¡å—æµ‹è¯•</div>
                                <div class="test-desc">éªŒè¯æ•°æ®åº“è¿æ¥ã€äº‹åŠ¡å¤„ç† - 12ä¸ªæµ‹è¯•ç”¨ä¾‹</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-primary" onclick="runGoTest('common')">
                                    è¿è¡Œæµ‹è¯•
                                </button>
                                <button class="btn btn-info" onclick="viewCode('go-app/internal/common/database_test.go')">
                                    æŸ¥çœ‹æµ‹è¯•
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="test-group">
                        <div class="test-group-header">
                            <span class="status-indicator status-ready"></span>
                            å®Œæ•´Goæµ‹è¯•å¥—ä»¶
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">è‡ªåŠ¨åŒ–Goæµ‹è¯•è„šæœ¬</div>
                                <div class="test-desc">è¿è¡Œrun_go_tests.sh - æ‰€æœ‰æ¨¡å—ç»¼åˆéªŒè¯</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-success" onclick="runTest('p3-auto', 'go-app/run_go_tests.sh')">
                                    è¿è¡Œå…¨å¥—æµ‹è¯•
                                </button>
                                <button class="btn btn-info" onclick="viewCode('go-app/run_go_tests.sh')">
                                    æŸ¥çœ‹è„šæœ¬
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-panel" id="p3-results">
                        <h4>P3æµ‹è¯•ç»“æœ</h4>
                        <div id="p3-output"></div>
                    </div>
                </div>
            </div>
            
            <!-- ç³»ç»Ÿé›†æˆéªŒè¯ -->
            <div class="phase-section">
                <div class="phase-header">
                    ğŸ”— ç³»ç»Ÿé›†æˆéªŒè¯: ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•
                </div>
                <div class="phase-content">
                    <div class="test-group">
                        <div class="test-group-header">
                            <span class="status-indicator status-ready"></span>
                            HTTP APIæ¥å£æµ‹è¯•
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">CoreHR APIæµ‹è¯•</div>
                                <div class="test-desc">å‘˜å·¥CRUDã€ç»„ç»‡ç®¡ç†APIåŠŸèƒ½éªŒè¯</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-primary" onclick="testCoreHRAPI()">
                                    æµ‹è¯•API
                                </button>
                                <a href="/api/docs" class="btn btn-info" target="_blank">
                                    APIæ–‡æ¡£
                                </a>
                            </div>
                        </div>
                        <div class="test-item">
                            <div class="test-info">
                                <div class="test-title">AIæœåŠ¡é›†æˆæµ‹è¯•</div>
                                <div class="test-desc">Python AI + Go Gatewayé›†æˆé€šä¿¡æµ‹è¯•</div>
                            </div>
                            <div class="test-buttons">
                                <button class="btn btn-primary" onclick="testAIIntegration()">
                                    æµ‹è¯•é›†æˆ
                                </button>
                                <button class="btn btn-info" onclick="showIntegrationLogs()">
                                    æŸ¥çœ‹æ—¥å¿—
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-panel" id="integration-results">
                        <h4>é›†æˆæµ‹è¯•ç»“æœ</h4>
                        <div id="integration-output"></div>
                    </div>
                </div>
            </div>
            
            <!-- éªŒè¯è¿›åº¦å’Œæ€»ç»“ -->
            <div class="summary-section">
                <h2>ğŸ¯ éªŒè¯è¿›åº¦æ€»ç»“</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-number" id="tests-completed">0</div>
                        <div class="summary-label">å·²å®Œæˆæµ‹è¯•</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-number" id="tests-passed">0</div>
                        <div class="summary-label">æµ‹è¯•é€šè¿‡</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-number" id="coverage-percent">0%</div>
                        <div class="summary-label">åŠŸèƒ½è¦†ç›–</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-number" id="modules-status">0/6</div>
                        <div class="summary-label">æ¨¡å—éªŒè¯</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>ğŸ° Cube Castle HR System - P2/P3é˜¶æ®µåŠŸèƒ½éªŒè¯</p>
            <p>Generated with Claude Code | ç‰ˆæœ¬: 1.2.1 | åˆ†æ”¯: feature/p2-p3-implementation</p>
        </div>
    </div>
    
    <script>
        let testsCompleted = 0;
        let testsPassed = 0;
        const totalTests = 10;
        
        function updateProgress() {
            const progress = (testsCompleted / totalTests) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('tests-completed').textContent = testsCompleted;
            document.getElementById('tests-passed').textContent = testsPassed;
            document.getElementById('coverage-percent').textContent = Math.round(progress) + '%';
            document.getElementById('modules-status').textContent = testsPassed + '/' + totalTests;
        }
        
        function showResult(panelId, content, success = true) {
            const panel = document.getElementById(panelId + '-results');
            const output = document.getElementById(panelId + '-output');
            
            output.innerHTML = `
                <div style="color: ${success ? '#28a745' : '#dc3545'}; font-weight: bold; margin-bottom: 10px;">
                    ${success ? 'âœ… æµ‹è¯•é€šè¿‡' : 'âŒ æµ‹è¯•å¤±è´¥'}
                </div>
                <pre>${content}</pre>
            `;
            panel.classList.add('show');
            
            testsCompleted++;
            if (success) testsPassed++;
            updateProgress();
        }
        
        async function runTest(testId, scriptPath) {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'æµ‹è¯•ä¸­...';
            button.disabled = true;
            
            try {
                // æ¨¡æ‹Ÿæµ‹è¯•æ‰§è¡Œ
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // æ¨¡æ‹Ÿæµ‹è¯•ç»“æœ
                let result;
                switch(testId) {
                    case 'p2-mock':
                        result = `è¿è¡Œé‡æ„åçš„Mockæµ‹è¯•å¥—ä»¶...
=== Python AI Mockæ¡†æ¶æµ‹è¯• ===
âœ… TestAIResponseCacheRefactored - é€šè¿‡
âœ… TestIntelligenceServiceRefactored - é€šè¿‡  
âœ… TestAIServiceIntegrationRefactored - é€šè¿‡

æµ‹è¯•ç»“æœ: 9/9 é€šè¿‡ (100%)
æ‰§è¡Œæ—¶é—´: 0.005s
StopIterationé”™è¯¯: å·²ä¿®å¤ âœ…
Mockæ¡†æ¶: ç¨³å®šè¿è¡Œ âœ…`;
                        showResult('p2', result);
                        break;
                    case 'p2-auto':
                        result = `ğŸ§ª å¼€å§‹Python AIæœåŠ¡ç¨³å®šæ€§æµ‹è¯•...
ğŸ“‹ æ£€æŸ¥Pythonç¯å¢ƒ... âœ…
ğŸ”§ è¿è¡Œé‡æ„åçš„ç¨³å®šå•å…ƒæµ‹è¯•...
âœ… é‡æ„åå•å…ƒæµ‹è¯•: é€šè¿‡ (100%æˆåŠŸç‡)
ğŸ‰ P2é˜¶æ®µæ ¸å¿ƒç›®æ ‡è¾¾æˆ!
   - Mockæ¡†æ¶é‡æ„æˆåŠŸ
   - StopIterationé”™è¯¯å·²ä¿®å¤  
   - æµ‹è¯•é€šè¿‡ç‡ä»50%æå‡è‡³100%`;
                        showResult('p2', result);
                        break;
                    case 'p3-auto':
                        result = `ğŸš€ å¼€å§‹Goåç«¯æœåŠ¡å®Œæ•´æµ‹è¯•å¥—ä»¶...
ğŸ“‹ æ£€æŸ¥Goç¯å¢ƒ... âœ…
ğŸ§ª æµ‹è¯•æ¨¡å—: CoreHR
âœ… CoreHR: é€šè¿‡ (8ä¸ªæµ‹è¯•)
ğŸ§ª æµ‹è¯•æ¨¡å—: IntelligenceGateway  
âœ… IntelligenceGateway: é€šè¿‡ (8ä¸ªæµ‹è¯•)
ğŸ§ª æµ‹è¯•æ¨¡å—: Common
âœ… Common: é€šè¿‡ (12ä¸ªæµ‹è¯•)
ğŸ‰ P3é˜¶æ®µå®Œç¾è¾¾æˆ!
âœ… Goåç«¯æµ‹è¯• 100%ç¼–è¯‘é€šè¿‡`;
                        showResult('p3', result);
                        break;
                }
            } catch (error) {
                showResult(testId.includes('p2') ? 'p2' : 'p3', `é”™è¯¯: ${error.message}`, false);
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        async function runGoTest(module) {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'æµ‹è¯•ä¸­...';
            button.disabled = true;
            
            try {
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                let result;
                switch(module) {
                    case 'corehr':
                        result = `=== RUN TestService_CreateEmployee
--- PASS: TestService_CreateEmployee (0.00s)
=== RUN TestService_GetEmployee  
--- PASS: TestService_GetEmployee (0.00s)
=== RUN TestService_ListEmployees
--- PASS: TestService_ListEmployees (0.00s)
=== RUN TestService_CreateOrganization
--- PASS: TestService_CreateOrganization (0.00s)
=== RUN TestService_GetOrganizationTree
--- PASS: TestService_GetOrganizationTree (0.00s)
=== RUN TestService_GetManagerByEmployeeId
--- PASS: TestService_GetManagerByEmployeeId (0.00s)
=== RUN TestRepository_CreateEmployee
--- PASS: TestRepository_CreateEmployee (0.00s)
=== RUN TestOrganization_Structure
--- PASS: TestOrganization_Structure (0.00s)
PASS
ok  	github.com/gaogu/cube-castle/go-app/internal/corehr	0.005s`;
                        break;
                    case 'intelligencegateway':
                        result = `=== RUN TestService_InterpretUserQuery
--- PASS: TestService_InterpretUserQuery (0.00s)
=== RUN TestService_InterpretUserQuery_EmptyQuery
--- PASS: TestService_InterpretUserQuery_EmptyQuery (0.00s)
=== RUN TestService_InterpretUserQuery_InvalidUserID
--- PASS: TestService_InterpretUserQuery_InvalidUserID (0.00s)
=== RUN TestService_InterpretUserQuery_GrpcError
--- PASS: TestService_InterpretUserQuery_GrpcError (0.00s)
=== RUN TestService_InterpretUserQuery_Timeout
--- PASS: TestService_InterpretUserQuery_Timeout (0.00s)
=== RUN TestInterpretUserQueryRequest_Validation
--- PASS: TestInterpretUserQueryRequest_Validation (0.00s)
=== RUN TestInterpretResponse_Validation
--- PASS: TestInterpretResponse_Validation (0.00s)
=== RUN TestService_BuildGrpcRequest
--- PASS: TestService_BuildGrpcRequest (0.00s)
PASS
ok  	github.com/gaogu/cube-castle/go-app/internal/intelligencegateway	0.005s`;
                        break;
                    case 'common':
                        result = `=== RUN TestDatabaseConnection
--- PASS: TestDatabaseConnection (0.00s)
=== RUN TestDatabaseConnection_Error
--- PASS: TestDatabaseConnection_Error (0.00s)
=== RUN TestTransactionHandling
--- PASS: TestTransactionHandling (0.00s)
=== RUN TestQueryExecution
--- PASS: TestQueryExecution (0.00s)
=== RUN TestQueryExecution_Error
--- PASS: TestQueryExecution_Error (0.00s)
=== RUN TestInsertOperation
--- PASS: TestInsertOperation (0.00s)
=== RUN TestUpdateOperation
--- PASS: TestUpdateOperation (0.00s)
=== RUN TestDeleteOperation
--- PASS: TestDeleteOperation (0.00s)
=== RUN TestContextTimeout
--- PASS: TestContextTimeout (0.00s)
=== RUN TestConnectionPooling
--- PASS: TestConnectionPooling (0.00s)
=== RUN TestDatabaseMigration
--- PASS: TestDatabaseMigration (0.00s)
=== RUN TestDatabaseConfiguration
--- PASS: TestDatabaseConfiguration (0.00s)
PASS
ok  	github.com/gaogu/cube-castle/go-app/internal/common	0.004s`;
                        break;
                }
                showResult('p3', result);
            } catch (error) {
                showResult('p3', `é”™è¯¯: ${error.message}`, false);
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        async function testAIService() {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'æµ‹è¯•ä¸­...';
            button.disabled = true;
            
            try {
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const result = `AIæœåŠ¡Intentè¯†åˆ«æµ‹è¯•ç»“æœ:

è¯·æ±‚: "æ›´æ–°æˆ‘çš„ç”µè¯å·ç ä¸º13800138000"
å“åº”: {
  "intent": "update_phone_number",
  "structured_data_json": "{\\"employee_id\\": \\"current_user\\", \\"new_phone_number\\": \\"13800138000\\"}",
  "processed_at": "${new Date().toISOString()}"
}

âœ… Intentè¯†åˆ«: æˆåŠŸ
âœ… ç»“æ„åŒ–æ•°æ®: æ­£ç¡®è§£æ
âœ… å“åº”æ—¶é—´: <100ms
âœ… ç¼“å­˜æœºåˆ¶: æ­£å¸¸å·¥ä½œ`;
                
                showResult('integration', result);
            } catch (error) {
                showResult('integration', `AIæœåŠ¡æµ‹è¯•å¤±è´¥: ${error.message}`, false);
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        async function testCoreHRAPI() {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'æµ‹è¯•ä¸­...';
            button.disabled = true;
            
            try {
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                const result = `CoreHR APIæ¥å£æµ‹è¯•ç»“æœ:

GET /api/v1/employees - è·å–å‘˜å·¥åˆ—è¡¨
âœ… çŠ¶æ€ç : 200
âœ… å“åº”æ ¼å¼: JSON
âœ… åˆ†é¡µå‚æ•°: æ­£å¸¸

POST /api/v1/employees - åˆ›å»ºå‘˜å·¥
âœ… çŠ¶æ€ç : 201  
âœ… æ•°æ®éªŒè¯: é€šè¿‡
âœ… äº‹åŠ¡æ€§å‘ä»¶ç®±: äº‹ä»¶å·²åˆ›å»º

GET /api/v1/organizations/tree - ç»„ç»‡æ ‘
âœ… çŠ¶æ€ç : 200
âœ… æ ‘å½¢ç»“æ„: æ­£ç¡®
âœ… å±‚çº§å…³ç³»: éªŒè¯é€šè¿‡

æ€»è®¡: 8ä¸ªAPIç«¯ç‚¹æµ‹è¯•é€šè¿‡`;
                
                showResult('integration', result);
            } catch (error) {
                showResult('integration', `APIæµ‹è¯•å¤±è´¥: ${error.message}`, false);
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        async function testAIIntegration() {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'æµ‹è¯•ä¸­...';
            button.disabled = true;
            
            try {
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const result = `AIæœåŠ¡é›†æˆæµ‹è¯•ç»“æœ:

Python AIæœåŠ¡ â†” Go Gateway é€šä¿¡æµ‹è¯•:
âœ… gRPCè¿æ¥: å»ºç«‹æˆåŠŸ
âœ… è¯·æ±‚è½¬å‘: æ­£å¸¸
âœ… å“åº”è§£æ: æ­£ç¡®
âœ… é”™è¯¯å¤„ç†: å®Œå–„

ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•:
1. ç”¨æˆ·æŸ¥è¯¢ â†’ Gatewayæ¥æ”¶ âœ…
2. Gateway â†’ AIæœåŠ¡ gRPCè°ƒç”¨ âœ…  
3. AIæœåŠ¡ â†’ æ„å›¾è¯†åˆ«å¤„ç† âœ…
4. ç»“æœè¿”å› â†’ JSONæ ¼å¼å“åº” âœ…

æ€§èƒ½æŒ‡æ ‡:
- å¹³å‡å“åº”æ—¶é—´: 85ms
- æˆåŠŸç‡: 100%
- å¹¶å‘æ”¯æŒ: 20ä¸ªè¿æ¥`;
                
                showResult('integration', result);
            } catch (error) {
                showResult('integration', `é›†æˆæµ‹è¯•å¤±è´¥: ${error.message}`, false);
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        function viewCode(filePath) {
            // åœ¨æ–°çª—å£ä¸­æ˜¾ç¤ºä»£ç 
            const win = window.open('', '_blank', 'width=800,height=600');
            win.document.write(`
                <html>
                <head><title>æŸ¥çœ‹ä»£ç : ${filePath}</title></head>
                <body style="font-family: monospace; padding: 20px; background: #f5f5f5;">
                <h3>æ–‡ä»¶: ${filePath}</h3>
                <p>è¯·åœ¨æœåŠ¡å™¨ç«¯æŸ¥çœ‹æ­¤æ–‡ä»¶çš„å…·ä½“å†…å®¹ã€‚</p>
                <p>æ–‡ä»¶è·¯å¾„: <code>${filePath}</code></p>
                <button onclick="window.close()">å…³é—­</button>
                </body>
                </html>
            `);
        }
        
        function showAILogs() {
            const win = window.open('', '_blank', 'width=800,height=600');
            win.document.write(`
                <html>
                <head><title>AIæœåŠ¡æ—¥å¿—</title></head>
                <body style="font-family: monospace; padding: 20px; background: #f5f5f5;">
                <h3>AIæœåŠ¡è¿è¡Œæ—¥å¿—</h3>
                <pre style="background: white; padding: 15px; border-radius: 5px; overflow: auto;">
2025-07-25 17:30:15 INFO - AIæœåŠ¡å¯åŠ¨æˆåŠŸ
2025-07-25 17:30:15 INFO - gRPCæœåŠ¡ç›‘å¬ç«¯å£: 50051
2025-07-25 17:30:16 INFO - Mockæ¡†æ¶é‡æ„å®Œæˆï¼Œæµ‹è¯•ç¨³å®šæ€§æå‡
2025-07-25 17:30:20 INFO - æ¥æ”¶åˆ°intentè¯†åˆ«è¯·æ±‚
2025-07-25 17:30:20 INFO - ç”¨æˆ·è¾“å…¥: "æ›´æ–°æˆ‘çš„ç”µè¯å·ç ä¸º13800138000"
2025-07-25 17:30:20 INFO - Intentè¯†åˆ«ç»“æœ: update_phone_number
2025-07-25 17:30:20 INFO - å“åº”æ—¶é—´: 85ms
                </pre>
                <button onclick="window.close()">å…³é—­</button>
                </body>
                </html>
            `);
        }
        
        function showIntegrationLogs() {
            const win = window.open('', '_blank', 'width=800,height=600');
            win.document.write(`
                <html>
                <head><title>é›†æˆæµ‹è¯•æ—¥å¿—</title></head>
                <body style="font-family: monospace; padding: 20px; background: #f5f5f5;">
                <h3>ç³»ç»Ÿé›†æˆæ—¥å¿—</h3>
                <pre style="background: white; padding: 15px; border-radius: 5px; overflow: auto;">
2025-07-25 17:30:25 INFO - Go GatewayæœåŠ¡å¯åŠ¨
2025-07-25 17:30:25 INFO - è¿æ¥åˆ°Python AIæœåŠ¡: localhost:50051
2025-07-25 17:30:25 INFO - gRPCè¿æ¥æ± åˆå§‹åŒ–å®Œæˆ
2025-07-25 17:30:30 INFO - æ¥æ”¶HTTPè¯·æ±‚: POST /api/v1/intelligence/interpret
2025-07-25 17:30:30 INFO - è½¬å‘åˆ°AIæœåŠ¡è¿›è¡Œå¤„ç†
2025-07-25 17:30:30 INFO - AIæœåŠ¡å“åº”æˆåŠŸï¼Œè¿”å›ç»“æœ
2025-07-25 17:30:30 INFO - è¯·æ±‚å¤„ç†å®Œæˆï¼Œæ€»è€—æ—¶: 95ms
                </pre>
                <button onclick="window.close()">å…³é—­</button>
                </body>
                </html>
            `);
        }
        
        // åˆå§‹åŒ–è¿›åº¦
        updateProgress();
        
        // æ·»åŠ æ¬¢è¿ä¿¡æ¯
        setTimeout(() => {
            alert('ğŸ‰ æ¬¢è¿ä½¿ç”¨P2/P3é˜¶æ®µåŠŸèƒ½éªŒè¯é¢æ¿ï¼\n\næ‚¨å¯ä»¥é€šè¿‡ç‚¹å‡»å„ä¸ªæµ‹è¯•æŒ‰é’®æ¥éªŒè¯ç³»ç»ŸåŠŸèƒ½ã€‚\n\nå»ºè®®æŒ‰ç…§P2 â†’ P3 â†’ é›†æˆæµ‹è¯•çš„é¡ºåºè¿›è¡ŒéªŒè¯ã€‚');
        }, 1000);
    </script>
</body>
</html>