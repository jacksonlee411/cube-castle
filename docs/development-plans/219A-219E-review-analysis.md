# Plan 219A-219E ç³»åˆ—è¯„å®¡æŠ¥å‘Š - Organization æ¨¡å—é‡æž„æ–¹æ¡ˆå®Œæ•´æ€§ä¸Žè§„èŒƒç¬¦åˆæ€§åˆ†æž

**è¯„å®¡æ—¥æœŸ**: 2025-11-04
**è¯„å®¡äºº**: Claude Code AI
**æ—§è¯„å®¡æ–‡æ¡£**: å·²å½’æ¡£è‡³ `docs/archive/development-plans/219-review-analysis-v1.0-archived-20251104.md`
**çŠ¶æ€**: æ–°è¯„å®¡å®Œæˆ
**æ–‡æ¡£ç¼–å·**: 219-REVIEW-002-A-E

---

## æ‰§è¡Œæ‘˜è¦

**æ€»ä½“è¯„åˆ†: 4.3/5**
âœ… æ¡†æž¶å®Œå–„ | âœ… å¯¹é½æ”¹å–„ | âœ… è¦†ç›–æå‡ | âš ï¸ ç»†èŠ‚ä»éœ€å®Œå–„

**å…³é”®è¿›å±•**ï¼ˆå¯¹æ¯” v1.0ï¼‰:
1. âœ… 219A-219E çš„å¼•å…¥å¤§å¹…æ”¹è¿›äº†å¯¹æ—§è¯„å®¡é—æ¼é¡¹çš„è¦†ç›–
2. âœ… Department æ¨¡å—çŽ°åœ¨è¢«æ˜Žç¡®è§„åˆ’åœ¨ 219A-219C ä¸­
3. âœ… Assignment æŸ¥è¯¢ä¾§ç”±ä¸“é—¨çš„ 219B è´Ÿè´£
4. âœ… å¢žåŠ äº†ç«¯åˆ°ç«¯æµ‹è¯•å’Œæ€§èƒ½éªŒè¯é˜¶æ®µï¼ˆ219Eï¼‰
5. âš ï¸ ä»å­˜åœ¨æ—¶é—´è¡¨å¯¹é½ã€ç»†èŠ‚å®Œæ•´æ€§ç­‰é—®é¢˜

---

## 1. ä¸Ž Plan 219 ä¸»è®¡åˆ’çš„å¯¹é½åº¦

### 1.1 å¯¹æ—§è¯„å®¡ç¼ºé™·çš„è¡¥æ•‘

**v1.0 è¯„å®¡è¯†åˆ«çš„å…³é”®ç¼ºé™·**:
```
âŒ Department æ¨¡å—ä¸æ˜Žç¡®         â†’ âœ… 219A/219C æ˜Žç¡®è¦†ç›–
âŒ Assignment æŸ¥è¯¢ä¾§ç¼ºå¤±         â†’ âœ… 219B ä¸“é—¨è§„åˆ’
âŒ Audit/Validator æ¡†æž¶ä¸å®Œæ•´     â†’ âœ… 219C è¡¥å……è§„åˆ™æ¸…å•
âŒ ç«¯åˆ°ç«¯æµ‹è¯•ç¼ºå¤±                â†’ âœ… 219E å®Œæ•´è§„åˆ’
âŒ æ€§èƒ½éªŒæ”¶æ— è®¡åˆ’                â†’ âœ… 219E åŒ…å«æ€§èƒ½åŸºå‡†
```

**è¯„ä»·**: â­â­â­â­â­ **å®Œå…¨è¡¥æ•‘**

---

### 1.2 219A-219E çš„è¦†ç›–èŒƒå›´åˆ†æž

#### **219A: ç›®å½•é‡æž„ä¸Ž Facade åŸºçº¿**

**å®šä½**: Week 3 Day 1-2ï¼ˆ2 å¤©ï¼‰

**è¦†ç›–èŒƒå›´**:
```
âœ… ç›®å½•ç»“æž„åˆ›å»º
âœ… Job Catalog / Position / Organization æ ¸å¿ƒä»£ç è¿ç§»
âœ… api.go å®šä¹‰ï¼ˆCommand/Query Facadeï¼‰
âœ… é€‚é…å±‚å®žçŽ°ï¼ˆcmd å±‚é›†æˆï¼‰
âœ… åŸºç¡€ç¼–è¯‘ä¸Žå•å…ƒæµ‹è¯•

âŒ ä¸åŒ…å«: Department ç‹¬ç«‹åŒ–ï¼ˆå‡è½»èŒƒå›´ï¼Œåˆç†ï¼‰
âŒ ä¸åŒ…å«: Assignment æŸ¥è¯¢ï¼ˆè½¬ç§»åˆ° 219Bï¼‰
âŒ ä¸åŒ…å«: Audit/Validator è§„åˆ™ç»†åŒ–ï¼ˆè½¬ç§»åˆ° 219Cï¼‰
```

**è¯„ä»·**: â­â­â­â­ **èŒƒå›´æ¸…æ™°ï¼Œä½†æ—¶é—´é¢„ä¼°é£Žé™©é«˜**

**é—®é¢˜**:
- 2 å¤©å†…è¦å®Œæˆç›®å½•åˆ›å»º + 3 ä¸ªæ ¸å¿ƒæ¨¡å—è¿ç§» + api.go å®šä¹‰ + é€‚é…å±‚ + æµ‹è¯•
- è¿™æ¶‰åŠ 30+ ä¸ªæ–‡ä»¶çš„è¿ç§»ï¼ŒåŠ ä¸Šå¯¼å…¥è·¯å¾„ä¿®æ­£ã€å¾ªçŽ¯ä¾èµ–å¤„ç†
- **å»ºè®®**: é¢„ç•™ 3 å¤©ä¸ºä¿é™©

---

#### **219B: Assignment æŸ¥è¯¢é“¾è·¯ä¸Žç¼“å­˜åˆ·æ–°**

**å®šä½**: Week 3 Day 3ï¼ˆ1 å¤©ï¼‰

**è¦†ç›–èŒƒå›´**:
```
âœ… postgres_assignment_repository.go æ–°å¢ž
âœ… GraphQL resolver æ‰©å±•
âœ… QueryFacade ä¸Žç¼“å­˜åˆ·æ–°
âœ… ç«¯åˆ°ç«¯è„šæœ¬ä¸Žæµ‹è¯•

è¦†ç›–å®Œæ•´æ€§: ä¼˜ç§€
```

**è¯„ä»·**: â­â­â­â­â­ **èŒƒå›´æ¸…æ™°ï¼Œæ—¶é—´åˆç†**

**ç»†èŠ‚å……åˆ†**:
- æ˜Žç¡®äº†ä»“å‚¨æ–¹æ³•ç­¾åï¼ˆGetAssignmentHistoryã€GetAssignmentStatsï¼‰
- è¯´æ˜Žäº†ç¼“å­˜åˆ·æ–°ç­–ç•¥ï¼ˆè§¦å‘äº‹ä»¶ç±»åž‹ï¼‰
- åŒ…å«äº†ç«¯åˆ°ç«¯è„šæœ¬éªŒè¯

---

#### **219C: Audit & Validator è§„åˆ™æ”¶æ•›**

**å®šä½**: Week 3 Day 4-5ï¼ˆ2 å¤©ï¼‰

**è¦†ç›–èŒƒå›´**:
```
âœ… å®¡è®¡æ—¥å¿—ç­–ç•¥ä¸Žè§„åˆ™æ¸…å•
âœ… Validator æ¡†æž¶ä¸Žè§„åˆ™å®žçŽ°
âœ… æ–‡æ¡£ä¸Žè§„åˆ™è¡¨è¾“å‡º
âœ… å•å…ƒä¸Žé›†æˆæµ‹è¯•

ç‰¹ç‚¹: å¼ºè°ƒäº†ä¸Ž outbox åŒäº‹åŠ¡çš„å®¡è®¡æ–¹å¼
```

**è¯„ä»·**: â­â­â­â­ **èŒƒå›´å®Œå–„ï¼Œä½†è§„åˆ™æ¸…å•ç¼ºä¹è¯¦ç»†å®šä¹‰**

**ç¼ºé™·**:
```
âŒ æ²¡æœ‰åˆ—ä¸¾å…·ä½“çš„å¿…å®¡è®¡æ“ä½œï¼ˆåªè¯´"åˆ—å‡ºå¿…å®¡è®¡æ“ä½œ"ï¼‰
âŒ æ²¡æœ‰åˆ—ä¸¾å…·ä½“çš„ä¸šåŠ¡éªŒè¯è§„åˆ™ï¼ˆåªè¯´"å®žçŽ°è§„åˆ™"ï¼‰
âŒ æ²¡æœ‰æ˜Žç¡® audit è®°å½•çš„å­˜å‚¨ä½ç½®ä¸Žå­—æ®µå®šä¹‰
âŒ æ²¡æœ‰è¯´æ˜Žè·¨åŸŸéªŒè¯çš„å…·ä½“åœºæ™¯
```

**å»ºè®®**: éœ€è¦è¡¥å……å®¡è®¡è§„åˆ™çš„å…·ä½“æ¸…å•

---

#### **219D: Scheduler/Temporal è¿ç§»ä¸Žç›‘æŽ§å®Œå–„**

**å®šä½**: Week 4 Day 1-2ï¼ˆ2 å¤©ï¼‰

**è¦†ç›–èŒƒå›´**:
```
âœ… Temporal workflow / activity è¿ç§»
âœ… é…ç½®æ¢³ç†
âœ… Prometheus æŒ‡æ ‡ä¸Ž Grafana ç›‘æŽ§
âœ… æµ‹è¯•ä¸Žæ–‡æ¡£

ç‰¹ç‚¹: åŒ…å«äº†ç›‘æŽ§ä¸Žå‘Šè­¦ï¼Œè¶…å‡ºäº†æ—§è®¡åˆ’ 219 çš„èŒƒå›´
```

**è¯„ä»·**: â­â­â­â­ **èŒƒå›´å®Œå–„ï¼Œé‡ç‚¹çªå‡º**

**æ”¹è¿›ç‚¹**:
- å¼•å…¥äº†ç›‘æŽ§ä¸Žå‘Šè­¦ï¼ˆPrometheus + Grafana + AlertManagerï¼‰
- å¼ºè°ƒäº†é…ç½®æ¢³ç†ï¼ˆcron / é‡è¯•ç­–ç•¥ç­‰ï¼‰
- æä¾›äº† workflow æµ‹è¯•çš„å…·ä½“æ–¹æ³•

---

#### **219E: ç«¯åˆ°ç«¯æµ‹è¯•ä¸Žæ€§èƒ½éªŒæ”¶**

**å®šä½**: Week 4 Day 3-5ï¼ˆ3 å¤©ï¼‰

**è¦†ç›–èŒƒå›´**:
```
âœ… 5 ä¸ªç«¯åˆ°ç«¯åœºæ™¯ï¼ˆOrganization / Position / Job Catalog / Outbox / æ•…éšœæ¢å¤ï¼‰
âœ… æ€§èƒ½åŸºå‡†å¯¹æ¯”ï¼ˆREST / GraphQL / èµ„æºæ¶ˆè€—ï¼‰
âœ… å›žé€€éªŒè¯ï¼ˆrollback æ¼”ç»ƒï¼‰
âœ… æµ‹è¯•å·¥å…·ä¸Žè„šæœ¬

ç‰¹ç‚¹: å®Œæ•´çš„éªŒæ”¶æ¡†æž¶ï¼ŒåŒ…å«æ€§èƒ½ä¸Žå›žé€€
```

**è¯„ä»·**: â­â­â­â­â­ **æ¡†æž¶å®Œå–„ï¼ŒéªŒæ”¶å……åˆ†**

**ä¼˜ç‚¹**:
- 5 ä¸ªç«¯åˆ°ç«¯åœºæ™¯è¦†ç›–å…¨é“¾è·¯ï¼ˆRESTã€GraphQLã€Temporalã€Auditã€Validatorã€ç¼“å­˜ï¼‰
- æ€§èƒ½åŸºå‡†åŒ…å« P99ã€P95ã€èµ„æºæ¶ˆè€—
- å›žé€€éªŒè¯ç¡®ä¿å®‰å…¨æ€§

---

### 1.3 å¯¹ 219 åŽŸå§‹è®¡åˆ’çš„è¡¥å……ä¸Žåç¦»

**219 åŽŸå§‹è®¡åˆ’ä¸­çš„å…³é”®éœ€æ±‚**:
```
éœ€æ±‚ 1: æ¨¡å—å…¬å¼€æŽ¥å£å®šä¹‰               â†’ âœ… 219A ä¸­å®šä¹‰ api.go
éœ€æ±‚ 2: æ¨¡å—å†…éƒ¨åˆ†å±‚                   â†’ âœ… 219A å®žçŽ°åˆ†å±‚
éœ€æ±‚ 3: Department èšåˆè¡¥å¼º              â†’ âœ… 219A/219C è¡¥å¼º
éœ€æ±‚ 4: Assignment å®Œå–„                â†’ âœ… 219B è¡¥é½æŸ¥è¯¢ä¾§
éœ€æ±‚ 5: Audit/æ ¡éªŒæ¸…å•                â†’ âœ… 219C è¾“å‡ºè§„åˆ™æ¸…å•
éœ€æ±‚ï¼ˆæ–°å¢žï¼‰: Scheduler/Temporal      â†’ âœ… 219D æ–°å¢ž
éœ€æ±‚ï¼ˆæ–°å¢žï¼‰: E2E + æ€§èƒ½              â†’ âœ… 219E æ–°å¢ž
```

**è¯„ä»·**: â­â­â­â­â­ **å®Œå…¨è¦†ç›– 219 éœ€æ±‚ï¼Œè¿˜æœ‰è¶…å‡º**

---

## 2. æ—¶é—´è®¡åˆ’ä¸Žä¾èµ–å…³ç³»è¯„ä¼°

### 2.1 æ—¶é—´è¡¨å¯¹é½åˆ†æž

**è®¡åˆ’æ—¶é—´åˆ†å¸ƒ**:
```
Week 3:
- Day 1-2: 219A ç›®å½•é‡æž„ï¼ˆå‡è®¾ Week 3 Day 1-2 = calendar Day 13-14ï¼‰
- Day 3:   219B Assignment æŸ¥è¯¢ï¼ˆDay 15ï¼‰
- Day 4-5: 219C Audit/Validatorï¼ˆDay 16-17ï¼‰

Week 4:
- Day 1-2: 219D Scheduler/Temporalï¼ˆDay 19-20ï¼‰
- Day 3-5: 219E ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆDay 21-23ï¼‰
```

**ä¸Ž 204 è®¡åˆ’çš„å¯¹é½**:
```
204 è®¡åˆ’ï¼š
- 2.6: organization é‡æž„ï¼ˆDay 15ï¼‰ â† **å…³é”®å†²çªç‚¹**
- 2.7: æ¨¡å—å¼€å‘æ¨¡æ¿æ–‡æ¡£ï¼ˆDay 15ï¼‰
- 2.8: Docker é›†æˆæµ‹è¯•åŸºåº§ï¼ˆDay 16ï¼‰
- 2.9: organization éªŒè¯ï¼ˆDay 17ï¼‰

é—®é¢˜ï¼š
- 204 2.6 è¯´"organization é‡æž„åœ¨ Day 15"
- 219A ä¹Ÿè¯´åœ¨"Week 3 Day 1-2"ï¼ˆå‡è®¾ Day 13-14ï¼‰
- ä½† 219A è¾“å‡ºè¦åˆ° Day 2ï¼Œ219B åœ¨ Day 3ï¼Œ219C åœ¨ Day 4-5
- è¿™æ · organization çš„å®Œæ•´é‡æž„å®žé™…éœ€è¦åˆ° Week 3 Day 5ï¼ˆDay 17ï¼‰
- ä½† 204 2.9 çš„éªŒè¯ä¹Ÿåœ¨ Day 17
- **æ—¶é—´è¡¨å¾ˆç´§å¼ ï¼Œæ²¡æœ‰ç¼“å†²**
```

**æ—¶é—´å†²çªè¯„åˆ†**: â­â­â­ **æœ‰é£Žé™©ï¼Œä½†æ¯” 218 æƒ…å†µå¥½**

---

### 2.2 ä¾èµ–å…³ç³»æ¸…æ™°åº¦

**å£°æ˜Žçš„ä¾èµ–é“¾**:
```
219A (Day 1-2)
  â†“ ä¾èµ–: ç¼–è¯‘é€šè¿‡
219B (Day 3)
  â†“ ä¾èµ–: 219A api.go å®Œæˆã€Facade å®šä¹‰æ¸…æ™°
219C (Day 4-5)
  â†“ ä¾èµ–: 219A ç›®å½•è¿ç§»å®Œæˆ
219D (Week 4 Day 1-2)
  â†“ ä¾èµ–: 219A/219B/219C å…¨éƒ¨å®Œæˆ
219E (Week 4 Day 3-5)
  â†“ ä¾èµ–: 219A~219D å…¨éƒ¨å®Œæˆ
```

**è¯„ä»·**: â­â­â­â­ **æ¸…æ™°ï¼Œä½†ç¼ºä¹æ˜¾å¼çš„ä¾èµ–è¯´æ˜Ž**

**é—®é¢˜**:
```
âŒ 219B çš„å‰ç½®æ¡ä»¶è¯´"219A å®Œæˆç›®å½•/Facade åŸºçº¿"
   â†’ è¿™æ˜¯å¯¹çš„ï¼Œä½†æ²¡æœ‰æ˜Žç¡®è¯´"éœ€è¦åœ¨ Day 2 æ™šä¸Š"
âŒ 219D è¯´"ä¾èµ– 219A ç›®å½•ã€219B æŸ¥è¯¢ã€219C å®¡è®¡"
   â†’ ä¸ºä»€ä¹ˆéœ€è¦ 219B æŸ¥è¯¢ï¼Ÿï¼ˆAssignment æŸ¥è¯¢ä¸Ž Temporal å…³ç³»ä¸å¤§ï¼‰
âŒ 219E è¯´"ä¾èµ– 219A~219D å…¨éƒ¨å®Œæˆ"
   â†’ ä½† 219D å®Œæˆæ—¶æ˜¯ Week 4 Day 2ï¼Œ219E åœ¨ Day 3 å¼€å§‹
   â†’ åªæœ‰ 1 å¤©ç¼“å†²ï¼Œä¸è¶³ä»¥åº”å¯¹ä»»ä½•å»¶è¿Ÿ
```

---

## 3. è§„èŒƒä¸ŽåŽŸåˆ™ç¬¦åˆæ€§

### 3.1 CLAUDE.md åŽŸåˆ™ç¬¦åˆæ€§

#### **åŽŸåˆ™ 1: èµ„æºå”¯ä¸€æ€§ä¸Žè·¨å±‚ä¸€è‡´æ€§**

**è¯„åˆ†**: â­â­â­ **éƒ¨åˆ†ç¬¦åˆ**

**é—®é¢˜**:
```
âŒ Department æ¨¡åž‹çš„èšåˆå…³ç³»å®šä¹‰ä¸æ˜Žç¡®
   â†’ 219A è¯´"åœ¨ domain/ ä¸­å®šä¹‰ Department"
   â†’ ä½†æ²¡æœ‰è¯´æ˜Ž Department æ˜¯ Organization çš„å­èšåˆè¿˜æ˜¯ç‹¬ç«‹èšåˆ

âŒ Assignment çš„ç”Ÿå‘½å‘¨æœŸæµè½¬ä¸æ˜Žç¡®
   â†’ 219B æ²¡æœ‰è¯´æ˜Ž draft â†’ active â†’ vacated çš„å…·ä½“å®šä¹‰
   â†’ æ²¡æœ‰è¯´æ˜Ž Assignment ä¸Ž Position çš„å…³ç³»

âŒ Audit è§„åˆ™ç¼ºä¹ç»Ÿä¸€äº‹å®žæ¥æº
   â†’ 219C è¯´"åˆ—å‡ºå¿…å®¡è®¡æ“ä½œ"ä½†æ²¡æœ‰åˆ—å‡º
   â†’ æ²¡æœ‰å•ä¸€çš„è§„åˆ™æ–‡æ¡£

âŒ Validator è§„åˆ™é‡å¤å®šä¹‰é£Žé™©
   â†’ è§„åˆ™åˆ†æ•£åœ¨ 219Cï¼ˆæ¡†æž¶ï¼‰å’Œ codeï¼ˆå®žçŽ°ï¼‰ä¸­
   â†’ æ²¡æœ‰å”¯ä¸€äº‹å®žæ¥æº
```

**å»ºè®®**:
```
éœ€è¡¥å……:
1. åœ¨ internal/organization/domain ä¸­æ˜Žç¡®å®šä¹‰ Department ä¸Ž Organization çš„èšåˆå…³ç³»
   - Department æ˜¯ Organization çš„å­èšåˆï¼ˆ1:Nï¼‰
   - èšåˆè¾¹ç•Œè¯´æ˜Žï¼šDepartment ä¸èƒ½ç‹¬ç«‹å­˜åœ¨

2. åœ¨ internal/organization/domain ä¸­å®šä¹‰ Assignment ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æœº
   - Enum å®šä¹‰ï¼špending â†’ active â†’ inactive
   - è½¬æ¢è§„åˆ™ï¼šè°å¯ä»¥è§¦å‘ä»€ä¹ˆè½¬æ¢

3. åˆ›å»º internal/organization/AUDIT-RULES.md
   - åˆ—å‡ºæ‰€æœ‰å¿…å®¡è®¡çš„æ“ä½œï¼ˆå¼ºåˆ¶æ¸…å•ï¼‰
   - æ¯ä¸ªæ“ä½œçš„å®¡è®¡å­—æ®µå®šä¹‰

4. åˆ›å»º internal/organization/VALIDATOR-RULES.md
   - åˆ—å‡ºæ‰€æœ‰ä¸šåŠ¡éªŒè¯è§„åˆ™
   - è§„åˆ™ä¼˜å…ˆçº§ä¸Žæ‰§è¡Œé¡ºåº
```

---

#### **åŽŸåˆ™ 2: è¯šå®žåŽŸåˆ™**

**è¯„åˆ†**: â­â­â­ **éƒ¨åˆ†ç¬¦åˆ**

**é—®é¢˜**:
```
âš ï¸ æ—¶é—´é¢„ä¼°çš„è¯šå®žæ€§
   219A: "2 å¤©" è¿ç§» 30+ ä¸ªæ–‡ä»¶ï¼ŒåŠ ä¸Šè·¯å¾„ä¿®æ­£å’Œå¾ªçŽ¯ä¾èµ–å¤„ç†
   â†’ åŽ†å²ç»éªŒè¡¨æ˜Žè¿™é€šå¸¸éœ€è¦ 3 å¤©

âš ï¸ é£Žé™©è¯´æ˜Žä¸å……åˆ†
   219D è¯´"Temporal å·¥ä½œæµè¡Œä¸ºæ”¹å˜"æ˜¯é«˜é£Žé™©
   â†’ ä½†æ²¡æœ‰ç»™å‡ºå…·ä½“çš„éªŒè¯æ–¹æ³•ï¼ˆåªè¯´"ä¿ç•™å¯¹ç…§æµ‹è¯•"ï¼‰

âš ï¸ æ€§èƒ½ç›®æ ‡çš„å¯éªŒè¯æ€§ï¼ˆç›¸æ¯” 218 çš„é—®é¢˜ä»å­˜åœ¨ï¼‰
   219E è¯´"P99 ä¸è¶…è¿‡åŸºçº¿ +10%"
   â†’ ä½†æ²¡æœ‰å®šä¹‰å¦‚ä½•èŽ·å–åŸºçº¿ã€å¦‚ä½•æµ‹é‡ã€å¦‚ä½•å¯¹æ¯”
```

**å»ºè®®**:
```
ä¿®æ”¹ 219A æ—¶é—´é¢„ä¼°ï¼š
- ç›®å½•ä¸ŽåŸºç¡€è®¾æ–½åˆ›å»º: 4 å°æ—¶
- Job Catalog è¿ç§»: 6 å°æ—¶
- Position è¿ç§»: 6 å°æ—¶
- Organization è¿ç§»: 8 å°æ—¶
- api.go ä¸Žé€‚é…å±‚: 6 å°æ—¶
- ç¼–è¯‘ä¸ŽåŸºç¡€æµ‹è¯•: 6 å°æ—¶
- æ€»è®¡: 2.5-3 å¤©ï¼ˆä¸æ˜¯ 2 å¤©ï¼‰

åœ¨ 219D ä¸­è¡¥å…… Temporal éªŒè¯æ–¹æ³•ï¼š
- [ ] è¿è¡Œå¯¹ç…§æµ‹è¯•ï¼šæ–°æ—§ä»£ç åŒæ—¶æ‰§è¡Œç›¸åŒå·¥ä½œæµï¼Œæ¯”å¯¹è¾“å‡º
- [ ] ä½¿ç”¨ Temporal SDK testing åº“ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] åœ¨ sandbox è¿è¡Œä¸€ä¸ªå®Œæ•´å‘¨æœŸçš„ workflow
- [ ] å¯¹æ¯” Prometheus æŒ‡æ ‡ï¼ˆæˆåŠŸçŽ‡ã€è€—æ—¶ï¼‰

åœ¨ 219E ä¸­è¡¥å……æ€§èƒ½æµ‹è¯•çš„å…·ä½“æ–¹æ³•ï¼š
- [ ] ä½¿ç”¨ ab æˆ– hey è¿›è¡Œ REST API åŽ‹åŠ›æµ‹è¯•
  ```bash
  # åŸºçº¿æµ‹è¯•ï¼ˆæ—§ä»£ç ï¼‰
  ab -n 1000 -c 10 http://old-env:9090/api/v1/organizations

  # æ–°ä»£ç æµ‹è¯•
  ab -n 1000 -c 10 http://new-env:9090/api/v1/organizations

  # å¯¹æ¯”æŠ¥å‘Šï¼ˆç”Ÿæˆ Markdown è¡¨æ ¼ï¼‰
  ```
```

---

#### **åŽŸåˆ™ 3: å…ˆå¥‘çº¦åŽå®žçŽ°**

**è¯„åˆ†**: â­â­â­â­ **è‰¯å¥½ç¬¦åˆ**

**ä¼˜ç‚¹**:
```
âœ… 219A ä¸­å®šä¹‰äº† api.goï¼ˆå…¬å¼€æŽ¥å£å¥‘çº¦ï¼‰
âœ… 219B ä¸­æ›´æ–°äº† GraphQL schemaï¼ˆæŸ¥è¯¢å¥‘çº¦ï¼‰
âœ… 219C ä¸­åˆ—å‡ºäº† audit/validator è§„åˆ™ï¼ˆä¸šåŠ¡å¥‘çº¦ï¼‰
```

**ç¼ºç‚¹**:
```
âŒ å¥‘çº¦æ–‡æ¡£ä¸å¤Ÿè¯¦ç»†
   â†’ api.go æŽ¥å£çš„å®Œæ•´æ–‡æ¡£åœ¨å“ªï¼Ÿ
   â†’ Department çš„ REST ç«¯ç‚¹è®¾è®¡æ–‡æ¡£åœ¨å“ªï¼Ÿ

âŒ ç ´åæ€§å˜æ›´çš„è¿ç§»æŒ‡å—ç¼ºå¤±
   â†’ Department ç‹¬ç«‹åŒ–å¯èƒ½æ”¹å˜ REST ç»“æž„
   â†’ éœ€è¦æä¾›å®¢æˆ·ç«¯è¿ç§»æŒ‡å—
```

---

#### **å…¶ä»–åŽŸåˆ™**

**åŽŸåˆ™ 4: ä¸­æ–‡æ²Ÿé€š** â­â­â­â­â­ **å®Œå…¨ç¬¦åˆ** - æ‰€æœ‰æ–‡æ¡£ä½¿ç”¨æ¸…æ™°çš„ä¸­æ–‡

**åŽŸåˆ™ 5: Docker å¼ºåˆ¶** â­â­â­â­â­ **å®Œå…¨ç¬¦åˆ** - æ²¡æœ‰è¿åå®¹å™¨åŒ–è¦æ±‚

**åŽŸåˆ™ 6: æ‚²è§‚è°¨æ…Ž** â­â­â­ **éƒ¨åˆ†ç¬¦åˆ** - é£Žé™©è¯†åˆ«å……åˆ†ï¼Œä½†ç¼“è§£æŽªæ–½æœ‰æ—¶ä»…è¯´"æå‰åˆ¶å®šè„šæœ¬"

---

### 3.2 AGENTS.md è§„èŒƒç¬¦åˆæ€§

#### **æ£€æŸ¥ç‚¹ 1: å¼€å‘å‰å¿…æ£€**

**è¦æ±‚**: Go ç‰ˆæœ¬ã€implementation-inventoryã€å¥‘çº¦æ ¡éªŒã€è®¡åˆ’æ›´æ–°

**ç¬¦åˆåº¦**: â­â­â­ **éƒ¨åˆ†ç¬¦åˆ**

**ç¼ºé™·**:
```
âŒ 219A-219E éƒ½æ²¡æœ‰æåŠå‰ç½®æ¡ä»¶æ£€æŸ¥
   â†’ åº”è¯¥åœ¨æ¯ä¸ªå­è®¡åˆ’ä¸­æåŠï¼š
     - Go ç‰ˆæœ¬ >= 1.24
     - åŸºç¡€è®¾æ–½ï¼ˆeventbus/database/loggerï¼‰å·²å°±ç»ª

âŒ æ²¡æœ‰æåŠ implementation-inventory.json çš„æ›´æ–°
   â†’ æ–°å¢ž internal/organization åº”è¯¥æ›´æ–°æ¸…å•

âŒ æ²¡æœ‰æåŠ å¥‘çº¦æ–‡æ¡£ çš„æ›´æ–°
   â†’ Department æ–°å¢žã€Assignment æŸ¥è¯¢æ–°å¢žéƒ½æ¶‰åŠ API å˜æ›´
```

**å»ºè®®**:
```
åœ¨æ¯ä¸ªå­è®¡åˆ’ä¸­æ–°å¢ž"å‰ç½®æ¡ä»¶"éƒ¨åˆ†ï¼š
219A:
- Go ç‰ˆæœ¬ >= 1.24
- Plan 216/217/218 åŸºç¡€è®¾æ–½å·²å®Œæˆ
- implementation-inventory.json å·²æ›´æ–°ï¼ˆæ ‡è®°ä¸º"å¾…å®Œæˆ"ï¼‰

219B:
- 219A å·²å®Œæˆç¼–è¯‘
- GraphQL schema.graphql å·²æ›´æ–°

...
```

---

#### **æ£€æŸ¥ç‚¹ 2: æµ‹è¯•ä¸Žè´¨é‡**

**è¦æ±‚**: > 80% è¦†ç›–çŽ‡ï¼Œgofmt/vet/lint

**ç¬¦åˆåº¦**: â­â­â­â­ **è‰¯å¥½ç¬¦åˆ**

**ä¼˜ç‚¹**:
```
âœ… å„å­è®¡åˆ’éƒ½æåˆ°äº†è¦†ç›–çŽ‡ç›®æ ‡ > 80%
âœ… éƒ½æåˆ°äº† go test éªŒè¯
âœ… 219C/219D/219E éƒ½æåˆ°äº†ç‰¹å®šçš„æµ‹è¯•ç±»åž‹
```

**ç¼ºé™·**:
```
âš ï¸ æ²¡æœ‰æåˆ° golangci-lint æˆ–å…¶ä»– linter
âš ï¸ æ²¡æœ‰æåˆ°ç”Ÿæˆçš„ä»£ç ï¼ˆå¦‚ sqlcï¼‰çš„è´¨é‡è¦æ±‚
```

---

#### **æ£€æŸ¥ç‚¹ 3: æäº¤ä¸Ž PR è§„èŒƒ**

**è¦æ±‚**: Conventional Commitsã€å…³è” Issueã€è¿ç§»æŒ‡å—

**ç¬¦åˆåº¦**: â­â­â­ **éƒ¨åˆ†ç¬¦åˆ**

**ç¼ºé™·**:
```
âŒ 219A-219E éƒ½æ²¡æœ‰æåŠ PR/Issue å…³è”
âŒ éƒ½æ²¡æœ‰æåŠ Conventional Commits æ ¼å¼
âŒ 219A æ²¡æœ‰æåŠå¦‚ä½•å¤„ç†"é€‚é…å±‚æ¸…ç†"ï¼ˆä½•æ—¶åˆ é™¤ï¼‰

å»ºè®®:
åœ¨ 219E ä¹‹åŽæ·»åŠ  219F: Cleanup & Finalization
- åˆ é™¤é€‚é…å±‚
- æ¸…ç†æ—§ç›®å½•
- æ›´æ–° CHANGELOG.md
```

---

## 4. å¯¹ v1.0 è¯„å®¡çš„æ”¹è¿›åˆ†æž

### 4.1 v1.0 ç¼ºé™·çš„è¡¥æ•‘ç¨‹åº¦

| v1.0 ç¼ºé™· | çŽ°çŠ¶ | è¡¥æ•‘ç¨‹åº¦ | è¯´æ˜Ž |
|-----------|------|--------|------|
| Department æ¨¡å—ä¸æ˜Žç¡® | âœ… å·²è¡¥å…… | 90% | 219A/219C è¦†ç›–ï¼Œä½†èšåˆå…³ç³»å®šä¹‰ä»éœ€å®Œå–„ |
| Assignment æŸ¥è¯¢ä¾§ | âœ… å·²è¡¥å…… | 95% | 219B ä¸“é—¨è§„åˆ’ï¼Œè¦†ç›–å®Œæ•´ |
| Audit/Validator æ¡†æž¶ | âœ… å·²è¡¥å…… | 70% | 219C æ¡†æž¶å®Œå–„ï¼Œä½†è§„åˆ™æ¸…å•ç¼ºä¹å…·ä½“å®šä¹‰ |
| ç«¯åˆ°ç«¯æµ‹è¯• | âœ… å·²è¡¥å…… | 95% | 219E è¦†ç›–å…¨é“¾è·¯ï¼Œåœºæ™¯å……åˆ† |
| æ€§èƒ½éªŒæ”¶ | âœ… å·²è¡¥å…… | 80% | 219E åŒ…å«æ€§èƒ½åŸºå‡†ï¼Œä½†æµ‹è¯•æ–¹æ³•éœ€è¡¥å…… |
| æ—¶é—´è¡¨å¯¹é½ | âš ï¸ æ”¹å–„ | 60% | ç›¸æ¯” 218ï¼Œæƒ…å†µå·²å¥½è½¬ï¼Œä½†ä»æœ‰é£Žé™© |

**æ€»ä½“è¡¥æ•‘åº¦**: 82% - **æ˜¾è‘—æ”¹å–„**

---

### 4.2 æ–°å¢žçš„è¿›æ­¥

```
âœ… å¼•å…¥äº† Temporal ä¸Ž Scheduler çš„å®Œæ•´è¿ç§»è®¡åˆ’ï¼ˆ219Dï¼‰
âœ… å¼•å…¥äº†ç›‘æŽ§ä¸Žå‘Šè­¦ï¼ˆPrometheus + Grafanaï¼‰
âœ… å¼•å…¥äº†æ€§èƒ½åŸºå‡†ä¸Žå¯¹æ¯”ï¼ˆ219Eï¼‰
âœ… å¼•å…¥äº†å›žé€€éªŒè¯ï¼ˆrollback æ¼”ç»ƒï¼‰
âœ… å¼•å…¥äº†ç«¯åˆ°ç«¯åœºæ™¯éªŒæ”¶ï¼ˆ5 ä¸ªåœºæ™¯ï¼‰
âœ… å¼•å…¥äº† Audit ä¸Ž Validator çš„è§„åˆ™æ¸…å•æ„è¯†ï¼ˆ219Cï¼‰
âœ… åˆ†è§£ä¸º 5 ä¸ªç‹¬ç«‹å­è®¡åˆ’ï¼Œé™ä½Žäº†å•ä¸ªè®¡åˆ’çš„å¤æ‚åº¦
```

---

## 5. å…³é”®ç¼ºé™·ä¸Žæ”¹è¿›å»ºè®®

### 5.1 **å¿…åšé¡¹ï¼ˆP0ï¼‰**

#### 1ï¸âƒ£ **è¡¥å……å…·ä½“çš„ Audit è§„åˆ™æ¸…å•**

```markdown
åœ¨ 219C ä¸­è¡¥å……ï¼š

å¿…å®¡è®¡æ“ä½œçŸ©é˜µ:
| æ“ä½œ | æ“ä½œç±»åž‹ | å®¡è®¡å­—æ®µ | ä¿ç•™æœŸ |
|------|--------|--------|------|
| CreateOrganization | CREATE | org_code, parent_code, status, created_by | 7å¹´ |
| UpdateOrganization | UPDATE | org_code, field_name, old_value, new_value | 7å¹´ |
| UpdateDepartment | UPDATE | dept_code, parent_code, status | 7å¹´ |
| CreatePosition | CREATE | pos_code, org_code, job_catalog_code | 7å¹´ |
| FillPosition | ASSIGN | pos_code, employee_id, start_date | 7å¹´ |
| VacatePosition | UNASSIGN | pos_code, employee_id, end_date | 7å¹´ |
| VersionActivate | ACTIVATE | pos_code, version | 7å¹´ |
| JobCatalogImport | IMPORT | file_name, imported_count, skipped_count | 7å¹´ |

å®žçŽ°æ¸…å•:
1. Audit Logger åœ¨ outbox transaction å†…è°ƒç”¨
2. æ¯æ¡å®¡è®¡è®°å½•åŒ…å«ï¼štimestamp, actor, action, entity_type, entity_id, payload, request_id
3. å®¡è®¡è¡¨ç´¢å¼•ï¼š(tenant_id, entity_type, entity_id)ã€(tenant_id, timestamp)
```

---

#### 2ï¸âƒ£ **è¡¥å……å…·ä½“çš„ Validator è§„åˆ™æ¸…å•**

```markdown
åœ¨ 219C ä¸­è¡¥å……ï¼š

Business Validator è§„åˆ™çŸ©é˜µ:
| èšåˆ | è§„åˆ™ID | è§„åˆ™æè¿° | è§¦å‘æ—¶æœº | ä¼˜å…ˆçº§ |
|------|-------|--------|--------|------|
| Organization | ORG-001 | code å…¨å±€å”¯ä¸€ | Create/Update | P0 |
| Organization | ORG-002 | çŠ¶æ€è½¬æ¢: activeâ†’inactive ä»…å¯å•å‘ | Update | P0 |
| Organization | ORG-003 | åˆ é™¤å‰æ— å­éƒ¨é—¨æˆ–å­èŒä½ | Delete | P1 |
| Department | DEPT-001 | parent_org å¿…é¡»æœ‰æ•ˆ | Create/Update | P0 |
| Department | DEPT-002 | å±‚çº§ä¸è¶…è¿‡ 5 å±‚ | Create | P0 |
| Department | DEPT-003 | ä¸å…è®¸å¾ªçŽ¯å±‚çº§ï¼ˆçˆ¶ä¸ºå­ï¼Œå­ä¸ºçˆ¶ï¼‰ | Update | P0 |
| Position | POS-001 | headcount >= 1 | Create/Update | P0 |
| Position | POS-002 | job_catalog_code å¿…é¡»æœ‰æ•ˆ | Create/Update | P0 |
| Position | POS-003 | version æ¿€æ´»å‰éœ€æ»¡è¶³æ‰€æœ‰è§„åˆ™ | VersionActivate | P0 |
| Assignment | ASN-001 | ä¸€èŒä¸€äººï¼ˆåŒä¸€æ—¶é—´å†…ï¼‰ | Fill | P0 |
| Assignment | ASN-002 | æ—¶é—´åŒºé—´ä¸é‡å  | Fill/Transfer | P0 |
| Assignment | ASN-003 | çŠ¶æ€è½¬æ¢åˆæ³•ï¼ˆdraftâ†’activeâ†’inactiveï¼‰ | StateChange | P0 |
| JobCatalog | JOB-001 | ä¸å…è®¸ç‰ˆæœ¬å†²çª | Import | P0 |
| JobCatalog | JOB-002 | å±‚çº§ä¾èµ–å­˜åœ¨ | Create/Import | P0 |

Validator å®žçŽ°æ¡†æž¶:
```go
type BusinessValidator interface {
  Validate(ctx context.Context, cmd interface{}) error
}

type ValidatorChain struct {
  validators []BusinessValidator
}

func (vc *ValidatorChain) Validate(ctx context.Context, cmd interface{}) error {
  for _, validator := range vc.validators {
    if err := validator.Validate(ctx, cmd); err != nil {
      return err
    }
  }
  return nil
}
```
```

---

#### 3ï¸âƒ£ **è¡¥å…… Department ä¸Ž Organization çš„èšåˆå…³ç³»æ–‡æ¡£**

```markdown
åœ¨ internal/organization/domain ä¸­æ–°å¢žæ–‡ä»¶ï¼š

DOMAIN-DESIGN.md:

# ç»„ç»‡æ¨¡å—åŸŸæ¨¡åž‹è®¾è®¡

## èšåˆåˆ’åˆ†

### Organization èšåˆï¼ˆèšåˆæ ¹ï¼‰
- èšåˆæ ¹å®žä½“ï¼šOrganization
- å­å®žä½“ï¼šDepartmentï¼ˆèšåˆå†…èŠ‚ç‚¹ï¼Œä¸èƒ½ç‹¬ç«‹å­˜åœ¨ï¼‰
- ç”Ÿå‘½å‘¨æœŸï¼šCreated â†’ Active â†’ Inactive â†’ Deleted

### Position èšåˆï¼ˆèšåˆæ ¹ï¼‰
- èšåˆæ ¹å®žä½“ï¼šPosition
- å­å®žä½“ï¼šPositionAssignmentï¼ˆèšåˆå†…èŠ‚ç‚¹ï¼‰
- ç”Ÿå‘½å‘¨æœŸï¼šDraft â†’ Published â†’ Archived

### JobCatalog èšåˆï¼ˆèšåˆæ ¹ï¼‰
- èšåˆæ ¹å®žä½“ï¼šJobCatalog
- å­å®žä½“ï¼šJobCatalogVersion
- ç”Ÿå‘½å‘¨æœŸï¼šDraft â†’ Active â†’ Inactive

## èšåˆå…³ç³»

```
Organization (èšåˆæ ¹)
  â”œâ”€â”€ Department (å­èšåˆï¼Œ1:N)
  â”‚   â””â”€â”€ ä¸èƒ½ç‹¬ç«‹åˆ›å»º/åˆ é™¤
  â”‚   â””â”€â”€ åˆ é™¤æ—¶è‡ªåŠ¨æ¸…ç†å…³è”èŒä½
  â”‚
  â””â”€â”€ Position (ç‹¬ç«‹èšåˆï¼Œ1:N)
      â””â”€â”€ å¯ç‹¬ç«‹æ“ä½œ
      â””â”€â”€ èŒä½åˆ é™¤æ—¶æ¸…ç† Assignment
```

## è¾¹ç•Œè¯´æ˜Ž

- Department ä¸Ž Organization çš„å…³ç³»æ˜¯"éƒ¨åˆ†"å…³ç³»ï¼Œè€Œéž"æ•´ä½“"å…³ç³»
- Department æ— æ³•ç‹¬ç«‹å­˜åœ¨ï¼Œå¿…é¡»å±žäºŽæŸä¸ª Organization
- åˆ é™¤ Organization æ—¶ï¼Œæ‰€æœ‰ Department ä¸Žç›¸å…³ Position è‡ªåŠ¨åˆ é™¤
- è½¬ç§» Department åˆ°å¦ä¸€ä¸ª Organization æ—¶ï¼Œç›¸å…³çº¦æŸéœ€éªŒè¯ï¼ˆå¦‚èŒä½å¼•ç”¨ï¼‰
```

---

#### 4ï¸âƒ£ **è°ƒæ•´ 219A çš„æ—¶é—´é¢„ä¼°**

```markdown
ä¿®æ”¹ 219A å­è®¡åˆ’ï¼š

æ—¶é—´é¢„ä¼°ä¿®æ­£:
- åŽŸè®¡åˆ’: 2 å¤©ï¼ˆWeek 3 Day 1-2ï¼‰
- æ–°è®¡åˆ’: 3 å¤©ï¼ˆWeek 3 Day 1-3ï¼‰

ç†ç”±:
- Job Catalog è¿ç§»: æ–‡ä»¶å¤šï¼Œå¯¼å…¥å¤æ‚
- Position è¿ç§»: ä¸Ž Assignment å…³ç³»å¤æ‚
- Organization è¿ç§»: æœ€å¤æ‚ï¼Œæ¶‰åŠå±‚çº§é€»è¾‘
- Circular dependency é£Žé™©: éœ€è¦å¤šæ¬¡ review ä¸Žä¿®æ­£

ç¼“å†²:
- é¢„ç•™ 4 å°æ—¶åº”å¯¹æ„å¤–ï¼ˆç¼–è¯‘é”™è¯¯ã€å¯¼å…¥å†²çªï¼‰
```

---

### 5.2 **é‡è¦é¡¹ï¼ˆP1ï¼‰**

#### 5ï¸âƒ£ **è¡¥å…… Temporal å·¥ä½œæµéªŒè¯çš„å…·ä½“æ–¹æ³•**

```markdown
åœ¨ 219D ä¸­è¡¥å……ï¼š

Temporal Workflow éªŒè¯æ­¥éª¤:

1. å•å…ƒæµ‹è¯•ï¼ˆä½¿ç”¨ Temporal SDK testingï¼‰
```go
// temporal_workflow_test.go
func TestPositionVersionActivation(t *testing.T) {
  testEnv := &testsuite.TestWorkflowEnvironment{}
  testEnv.ExecuteWorkflow(ActivatePositionVersionWorkflow, positionCode, versionID)

  var result interface{}
  err := testEnv.GetWorkflowResult(&result)
  if err != nil {
    t.Fatal(err)
  }

  // assert result
}
```

2. é›†æˆæµ‹è¯•ï¼ˆåœ¨ Docker Temporal çŽ¯å¢ƒä¸­ï¼‰
```bash
# å¯åŠ¨ Temporal Docker
docker-compose -f docker-compose.temporal.yml up

# è¿è¡Œé›†æˆæµ‹è¯•
go test ./internal/organization/scheduler -tags=integration

# éªŒè¯ workflow ç»“æžœ
tctl workflow describe --workflow-id test-activate-position-version-001
```

3. æ€§èƒ½å¯¹æ¯”
```bash
# æ—§ä»£ç æ€§èƒ½
TEMPORAL_ENDPOINT=old-env:7233 go test -bench=. ./...

# æ–°ä»£ç æ€§èƒ½
TEMPORAL_ENDPOINT=new-env:7233 go test -bench=. ./...

# å¯¹æ¯”æŠ¥å‘Šï¼ˆç”Ÿæˆ Markdownï¼‰
```
```

---

#### 6ï¸âƒ£ **è¡¥å…… 219E æ€§èƒ½æµ‹è¯•çš„å…·ä½“è„šæœ¬**

```markdown
åœ¨ 219E ä¸­è¡¥å……ï¼š

æ€§èƒ½æµ‹è¯•è„šæœ¬ä½ç½®: tests/organization/performance/

è„šæœ¬å†…å®¹:

1. åŸºçº¿èŽ·å– (baseline.sh)
```bash
#!/bin/bash
# èŽ·å–æ—§ä»£ç çš„æ€§èƒ½åŸºçº¿
# ä½¿ç”¨ git checkoutï¼Œæˆ–ä½¿ç”¨é•œåƒæ ‡ç­¾

echo "Testing old version..."
curl -X GET http://old-env:9090/api/v1/organizations?page=1&size=100
time for i in {1..1000}; do
  curl -s http://old-env:9090/api/v1/organizations?page=$((RANDOM % 10)) \
    -H "Authorization: Bearer $JWT" | jq '.data | length'
done

# è¾“å‡º: min, max, avg, p50, p95, p99
```

2. æ–°ä»£ç æµ‹è¯• (test-new.sh)
```bash
#!/bin/bash
# èŽ·å–æ–°ä»£ç çš„æ€§èƒ½æŒ‡æ ‡
# ä¸ŽåŸºçº¿è¿›è¡Œå¯¹æ¯”

echo "Testing new version..."
# ç›¸åŒçš„æµ‹è¯•è¿‡ç¨‹
```

3. å¯¹æ¯”æŠ¥å‘Š (compare.sh)
```bash
#!/bin/bash
# ç”Ÿæˆæ€§èƒ½å¯¹æ¯”æŠ¥å‘Šï¼ˆMarkdown æ ¼å¼ï¼‰

cat > performance-report.md << 'EOF'
# æ€§èƒ½åŸºå‡†å¯¹æ¯”æŠ¥å‘Š

| æŒ‡æ ‡ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | å˜åŒ– | çŠ¶æ€ |
|------|-------|--------|------|------|
| REST P99 (ms) | 52 | 48 | -7.7% | âœ… |
| GraphQL P99 (ms) | 78 | 84 | +7.7% | âš ï¸ |
| å†…å­˜ä½¿ç”¨ (MB) | 256 | 312 | +21.9% | âš ï¸ |
| DB è¿žæŽ¥æ•° | 10 | 12 | +20% | âš ï¸ |

æ€»ä½“è¯„ä»·: æ»¡è¶³æ€§èƒ½ç›®æ ‡ï¼ˆP99 ä¸è¶…è¿‡åŸºçº¿ +10%ï¼‰
EOF
```
```

---

### 5.3 **åŽç»­é¡¹ï¼ˆP2ï¼‰**

#### 7ï¸âƒ£ **åˆ›å»º Department API è¿ç§»æŒ‡å—**

```markdown
åˆ›å»ºæ–‡ä»¶: docs/migration/department-api-migration.md

å†…å®¹:
# Department API ç‹¬ç«‹åŒ–è¿ç§»æŒ‡å—

## èƒŒæ™¯
åœ¨ Plan 219A-219C ä¸­ï¼ŒDepartment ä»Ž Organization çš„åµŒå¥—ç»“æž„ç‹¬ç«‹åŒ–ä¸ºé¡¶çº§èµ„æºã€‚

## å®¢æˆ·ç«¯è¿ç§»æ¸…å•

### REST API å˜æ›´
#### æ—§ APIï¼ˆå…¼å®¹æœŸæ”¯æŒï¼‰
```
GET /api/v1/organizations/{code}
  â†’ å“åº”åŒ…å« nested departments

DELETE /api/v1/organizations/{code}/departments/{dept_code}
  â†’ é€šè¿‡ç»„ç»‡ç«¯ç‚¹ç®¡ç†éƒ¨é—¨
```

#### æ–° APIï¼ˆæŽ¨èä½¿ç”¨ï¼‰
```
GET /api/v1/departments
GET /api/v1/departments/{code}
POST /api/v1/departments
PATCH /api/v1/departments/{code}
DELETE /api/v1/departments/{code}
```

### å…¼å®¹æœŸæ”¯æŒï¼ˆ3 ä¸ªæœˆï¼‰
- ä¿ç•™æ—§ API çš„æ”¯æŒï¼Œåº•å±‚å®žé™…è°ƒç”¨æ–° API
- å“åº”å¤´å¢žåŠ  Deprecation è­¦å‘Š
- æ—¥å¿—è®°å½•æ—§ API ä½¿ç”¨æƒ…å†µ

### è¿ç§»æ­¥éª¤
1. æ›´æ–°å®¢æˆ·ç«¯ä»£ç ï¼Œä½¿ç”¨æ–° Department API
2. è¿è¡Œå›žå½’æµ‹è¯•ï¼ŒéªŒè¯è¡Œä¸ºä¸€è‡´
3. æäº¤ PRï¼Œæ›´æ–° API æ–‡æ¡£
```

---

## 6. æ€»ä½“è¯„ä»·ä¸Žæœ€ç»ˆå»ºè®®

### 6.1 åˆ†é¡¹è¯„åˆ†æ€»ç»“

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜Ž |
|------|------|------|
| **æ¡†æž¶å®Œæ•´æ€§** | 4.5/5 | 219A-219E åˆ†å·¥æ¸…æ™°ï¼Œè¦†ç›–å…¨é¢ |
| **ä¸Ž 219 å¯¹é½** | 4.5/5 | è¡¥æ•‘äº† v1.0 çš„ä¸»è¦ç¼ºé™· |
| **è§„èŒƒç¬¦åˆåº¦** | 3.5/5 | ç¬¦åˆä¸­æ–‡ã€Docker ç­‰åŽŸåˆ™ï¼Œä½†"å”¯ä¸€äº‹å®žæ¥æº"æœ‰ç¼ºé™· |
| **æ—¶é—´çŽ°å®žæ€§** | 3/5 | 219A æ—¶é—´é¢„ä¼°è¿‡ä¹è§‚ï¼Œæ€»ä½“æ—¥ç¨‹ç´§å¼  |
| **ç»†èŠ‚å®Œæ•´æ€§** | 3.5/5 | æ¡†æž¶æ¸…æ™°ï¼Œä½†å…·ä½“è§„åˆ™æ¸…å•ç¼ºå¤± |
| **å¯æ‰§è¡Œæ€§** | 4/5 | å¯ä»¥å¼€å§‹ï¼Œä½†éœ€è¦ä¸Šè¿°è¡¥å…… |

**æ€»ä½“è¯„åˆ†: 4.0/5** â†’ **å¯æ‰§è¡Œï¼Œå»ºè®®æŒ‰ P0 å»ºè®®è¡¥å……åŽå¯åŠ¨**

---

### 6.2 å¯åŠ¨å‰æ£€æŸ¥æ¸…å•

```markdown
å¯åŠ¨ 219A-219E å‰ï¼Œå¿…é¡»å®Œæˆä»¥ä¸‹å·¥ä½œï¼š

â–¡ P0 - è¡¥å…… Audit è§„åˆ™æ¸…å•ï¼ˆé¢„è®¡ 4 å°æ—¶ï¼‰
  - å®šä¹‰å¿…å®¡è®¡æ“ä½œçŸ©é˜µ
  - å®šä¹‰å®¡è®¡å­—æ®µä¸Žä¿ç•™æœŸ

â–¡ P0 - è¡¥å…… Validator è§„åˆ™æ¸…å•ï¼ˆé¢„è®¡ 6 å°æ—¶ï¼‰
  - åˆ—ä¸¾æ‰€æœ‰ä¸šåŠ¡éªŒè¯è§„åˆ™
  - å®šä¹‰è§„åˆ™ä¼˜å…ˆçº§

â–¡ P0 - æ˜Žç¡® Department èšåˆå…³ç³»ï¼ˆé¢„è®¡ 4 å°æ—¶ï¼‰
  - ç¼–å†™åŸŸæ¨¡åž‹è®¾è®¡æ–‡æ¡£
  - è¯´æ˜Žèšåˆè¾¹ç•Œä¸Žç”Ÿå‘½å‘¨æœŸ

â–¡ P0 - è°ƒæ•´ 219A æ—¶é—´ä¸º 3 å¤©ï¼ˆé¢„è®¡ 1 å°æ—¶ï¼‰
  - æ›´æ–°è®¡åˆ’æ–‡æ¡£
  - ä¸Žå›¢é˜ŸåŒæ­¥è°ƒæ•´

â–¡ P1 - è¡¥å…… Temporal éªŒè¯æ–¹æ³•ï¼ˆé¢„è®¡ 2 å°æ—¶ï¼‰
  - ç¼–å†™æµ‹è¯•æ¡†æž¶ä»£ç 
  - è¯´æ˜ŽéªŒè¯æ­¥éª¤

â–¡ P1 - è¡¥å……æ€§èƒ½æµ‹è¯•è„šæœ¬ï¼ˆé¢„è®¡ 3 å°æ—¶ï¼‰
  - ç¼–å†™åŸºå‡†æµ‹è¯•è„šæœ¬
  - ç¼–å†™å¯¹æ¯”æŠ¥å‘Šè„šæœ¬

æ€»è®¡å‡†å¤‡å·¥ä½œ: 16-20 å°æ—¶ï¼ˆ2-2.5 å¤©ï¼‰
```

---

### 6.3 é£Žé™©æ€»ç»“

**é«˜é£Žé™©ï¼ˆéœ€é‡ç‚¹å…³æ³¨ï¼‰**:
1. **219A æ—¶é—´ç´§å¼ ** - 30+ æ–‡ä»¶è¿ç§»åœ¨ 2-3 å¤©å†…å®Œæˆæœ‰é£Žé™©
   - ç¼“è§£: å¢žåŠ  1 å¤©ç¼“å†²ï¼Œé¢„ç•™ 4 å°æ—¶åº”å¯¹å¾ªçŽ¯ä¾èµ–

2. **219D Temporal è¿ç§»çš„è¡Œä¸ºç­‰åŒæ€§** - å·¥ä½œæµå˜æ›´å¯èƒ½å¯¼è‡´åŠŸèƒ½å¼‚å¸¸
   - ç¼“è§£: å¢žåŠ å¯¹ç…§æµ‹è¯•ã€ä½¿ç”¨ Temporal SDK testingã€åœ¨ sandbox éªŒè¯

3. **219E æ€§èƒ½åŸºå‡†çš„è¾¾æˆ** - æ–°ç»“æž„å¯èƒ½å¼•å…¥é¢å¤–å¼€é”€
   - ç¼“è§£: é¢„ç•™æ€§èƒ½ä¼˜åŒ–æ—¶é—´ï¼ˆ2-3 å¤©ï¼‰ï¼Œåœ¨æµ‹è¯•çŽ¯å¢ƒå……åˆ†éªŒè¯

**ä¸­é£Žé™©ï¼ˆéœ€ç®¡ç†ï¼‰**:
1. 219B GraphQL schema å˜æ›´å¯¼è‡´æŸ¥è¯¢ç ´å
   - ç¼“è§£: æ›´æ–°å‰å……åˆ†è¯„å®¡ï¼Œå¢žåŠ å‘åŽå…¼å®¹æ€§æµ‹è¯•

2. 219C Audit logger ä¸Ž outbox åŒäº‹åŠ¡çš„å®žçŽ°å¤æ‚æ€§
   - ç¼“è§£: å…ˆåœ¨æµ‹è¯•çŽ¯å¢ƒéªŒè¯ï¼Œç¡®ä¿å›žæ»šèƒ½åŠ›

---

### 6.4 æœ€ç»ˆå»ºè®®

**âœ… å»ºè®®å¯åŠ¨ 219A-219E**ï¼Œä½†éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

1. **å®Œæˆ P0 è¡¥å……å·¥ä½œ**ï¼ˆ2-3 å¤©ï¼‰
   - è¡¥å……å…·ä½“çš„ Audit/Validator è§„åˆ™æ¸…å•
   - æ˜Žç¡® Department èšåˆå…³ç³»
   - è°ƒæ•´ 219A æ—¶é—´ä¸º 3 å¤©

2. **å»ºç«‹æŒç»­ç›‘æŽ§æœºåˆ¶**ï¼ˆå¯åŠ¨æ—¶ï¼‰
   - æ¯ä¸ªå­è®¡åˆ’çš„å®Œæˆæƒ…å†µæ—¥æŠ¥
   - é£Žé™©é¡¹çš„æ¯æ—¥è·Ÿè¸ª
   - å¾ªçŽ¯ä¾èµ–å’Œç¼–è¯‘é”™è¯¯çš„å®žæ—¶åé¦ˆ

3. **é¢„ç•™åº”æ€¥å“åº”èƒ½åŠ›**ï¼ˆæ•´ä¸ªå‘¨æœŸï¼‰
   - ä¿ç•™ 1-2 ä¸ªå¼€å‘äººå‘˜å¤„ç†çªå‘é—®é¢˜
   - å‡†å¤‡å¿«é€Ÿå›žæ»šæ–¹æ¡ˆï¼ˆä½¿ç”¨ git tag æˆ–åˆ†æ”¯ï¼‰
   - å®šæœŸï¼ˆæ¯æ—¥ï¼‰ä¸Žå›¢é˜ŸåŒæ­¥è¿›åº¦

4. **åœ¨ 219E å‰å®Œæˆå…³é”®çš„æ€§èƒ½ä¼˜åŒ–**
   - å¦‚æžœæ€§èƒ½æŒ‡æ ‡æœªè¾¾ç›®æ ‡ï¼Œä¸åº”æ€¥äºŽåˆå¹¶
   - å»ºè®®é¢„ç•™ 3-5 å¤©è¿›è¡Œæ€§èƒ½è°ƒä¼˜

---

## é™„å½•ï¼šä¸Žæ—§è¯„å®¡ v1.0 çš„å¯¹æ¯”æ€»ç»“

```
ç»´åº¦                    | v1.0 è¯„åˆ† | v2.0 è¯„åˆ† | æ”¹è¿›æƒ…å†µ
-----------------------|----------|----------|----------
æ•´ä½“æ¡†æž¶               | 3.8/5    | 4.3/5    | â†‘ 13% (è¡¥å……äº† 219A-219E)
Department è¦†ç›–        | âŒ 0/5   | âœ… 4/5   | â†‘ å®Œå…¨è¡¥æ•‘
Assignment æŸ¥è¯¢ä¾§      | âŒ 1/5   | âœ… 5/5   | â†‘ å®Œå…¨è¡¥æ•‘
Audit/Validator        | âš ï¸ 2/5   | âœ… 4/5   | â†‘ å¤§å¹…æ”¹è¿›
ç«¯åˆ°ç«¯æµ‹è¯•             | âŒ 0/5   | âœ… 5/5   | â†‘ æ–°å¢ž
æ€§èƒ½éªŒæ”¶               | âŒ 0/5   | âš ï¸ 4/5   | â†‘ æ–°å¢žï¼ˆéœ€è¡¥å……æ–¹æ³•ï¼‰
æ—¶é—´è¡¨å¯¹é½             | ðŸ”´ 1.5/5 | ðŸŸ¡ 3/5   | â†‘ éƒ¨åˆ†æ”¹è¿›ï¼ˆä»æœ‰é£Žé™©ï¼‰
è§„èŒƒç¬¦åˆåº¦             | ðŸŸ¡ 3/5   | ðŸŸ¡ 3.5/5 | â†‘ å°å¹…æ”¹è¿›
ç»†èŠ‚å®Œæ•´æ€§             | ðŸŸ¡ 3/5   | ðŸŸ¡ 3.5/5 | â†‘ éƒ¨åˆ†æ”¹è¿›

æ€»ä½“æ”¹è¿›å¹…åº¦: +13%ï¼Œä»Ž"éœ€è¦é‡å¤§æ”¹è¿›"å‡çº§åˆ°"å¯æ‰§è¡Œä½†éœ€å‡†å¤‡å·¥ä½œ"
```

---

**è¯„å®¡å®Œæˆæ—¥æœŸ**: 2025-11-04
**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**: æŒ‰ç…§ P0/P1/P2 å»ºè®®å¯¹ 219A-219E è¿›è¡Œè¡¥å……ï¼Œç„¶åŽå¯åŠ¨å®žæ–½
