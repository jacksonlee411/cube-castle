# 18 â€” E2E æµ‹è¯•å®Œå–„è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**ï¼š2025-10-02
**æœ€åæ›´æ–°**ï¼š2025-10-02
**è´£ä»»å›¢é˜Ÿ**ï¼šå‰ç«¯å›¢é˜Ÿ + QA å›¢é˜Ÿ
**çŠ¶æ€**ï¼šâœ… **å°±ç»ªï¼Œå¯å¯åŠ¨ Phase 1**
**å…³è”æ–‡æ¡£**ï¼š[06-integrated-teams-progress-log.md](./06-integrated-teams-progress-log.md)ã€[16-code-smell-analysis-and-improvement-plan.md](./16-code-smell-analysis-and-improvement-plan.md)
**éªŒè¯æŠ¥å‘Š**ï¼š[reports/iig-guardian/playwright-rs256-verification-20251002.md](../../reports/iig-guardian/playwright-rs256-verification-20251002.md)

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦ï¼ˆ2025-10-02 æ›´æ–°ï¼‰

### å®æ–½æ¡ä»¶è¯„ä¼°ç»“è®º

**âœ… å·²å…·å¤‡ç«‹å³å®æ–½æ¡ä»¶**

**å·²å®Œæˆé˜»å¡é¡¹**ï¼ˆä¼˜å…ˆçº§ P0ï¼‰ï¼š
- âœ… **æœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯å·²æ‰§è¡Œ**ï¼šæˆåŠŸå¯åŠ¨ Docker æ ˆã€ç”Ÿæˆ JWT å¹¶è¿è¡Œ Playwright å¥—ä»¶ï¼Œç¯å¢ƒç¨³å®šå¯ç”¨ï¼ˆfirefox 40é€šè¿‡ï¼Œchromium éƒ¨åˆ†å®Œæˆï¼‰
- âœ… **éªŒè¯æŠ¥å‘Šå·²å¡«å†™**ï¼š`reports/iig-guardian/plan18-ci-verification-20251002.md` å·²å®Œæˆï¼Œç»“è®ºä¸º"éƒ¨åˆ†é€šè¿‡ï¼Œå»ºè®®å¯åŠ¨ Phase 1"

**å·²å…·å¤‡çš„åŸºç¡€æ¡ä»¶**ï¼š
- âœ… Docker E2E æ ˆé…ç½®ï¼ˆ`docker-compose.e2e.yml`ï¼‰
- âœ… RS256 è®¤è¯é“¾è·¯å·¥å…·é“¾
- âœ… Playwright æµ‹è¯•å¥—ä»¶ï¼ˆ5 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼‰
- âœ… æœ¬åœ°éªŒè¯æ‰‹å†Œä¸æŠ¥å‘Šæ¨¡æ¿ï¼ˆPLAN18-CI-VERIFICATION-GUIDE.md / plan18-ci-verification-20251002.mdï¼‰

**éªŒè¯æ‰§è¡Œæ‘˜è¦**ï¼ˆ2025-10-02ï¼‰ï¼š
1. âœ… æœ¬åœ°éªŒè¯å®Œæˆï¼šDockeræ ˆ+JWT+Playwrightï¼ˆè€—æ—¶11åˆ†é’Ÿï¼‰
2. âœ… éªŒè¯æŠ¥å‘Šå·²å¡«å†™ï¼šå®Œæ•´è®°å½•ç¯å¢ƒä¿¡æ¯ã€æ‰§è¡Œç»“æœã€å‘ç°é—®é¢˜
3. âœ… ä¾èµ–é¡¹çŠ¶æ€å·²æ›´æ–°ä¸º âœ…
4. âœ… éªŒè¯è¯æ®å·²ä¿å­˜ï¼šæ—¥å¿—ã€æŠ¥å‘Šã€Playwright artifacts

**ä¸‹ä¸€æ­¥**ï¼šå¯ä»¥ç«‹å³å¯åŠ¨ Phase 1 ä»»åŠ¡ï¼ˆä¿®å¤ç°æœ‰å¤±è´¥æµ‹è¯•ï¼‰ã€‚

---

## ä¸€ã€èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 èƒŒæ™¯

2025-10-02 å®Œæˆçš„ Playwright RS256 E2E éªŒè¯ï¼ˆPlan 06ï¼‰æ˜¾ç¤ºï¼š
- âœ… **æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸**ï¼šRS256 è®¤è¯é“¾è·¯ã€PBAC æƒé™éªŒè¯ã€GraphQL æŸ¥è¯¢æœåŠ¡ã€æ¶æ„å¥‘çº¦å…¨éƒ¨é€šè¿‡
- âš ï¸ **æ¬¡è¦é—®é¢˜å­˜åœ¨**ï¼šä¸šåŠ¡æµç¨‹æµ‹è¯•ä¸åŸºç¡€åŠŸèƒ½æµ‹è¯•å­˜åœ¨ 3 å¤„å¤±è´¥ï¼Œæ€»ä½“é€šè¿‡ç‡ ~83%
- ğŸ“Š **æµ‹è¯•è¦†ç›–ä¸è¶³**ï¼šä¼˜åŒ–éªŒè¯ä¸å›å½’æµ‹è¯•å‰§æœ¬å°šæœªæ‰§è¡Œï¼Œå®Œæ•´ CRUD æµç¨‹å› è¶…æ—¶æœªå®Œæˆ

### 1.2 ç›®æ ‡

é€šè¿‡æœ¬è®¡åˆ’å®ç°ä»¥ä¸‹ç›®æ ‡ï¼š
1. **ä¿®å¤ç°æœ‰å¤±è´¥æµ‹è¯•**ï¼šå°† E2E æµ‹è¯•é€šè¿‡ç‡æå‡è‡³ 95% ä»¥ä¸Š
2. **å®Œå–„æµ‹è¯•è¦†ç›–**ï¼šè¡¥å……ä¼˜åŒ–éªŒè¯ã€å›å½’æµ‹è¯•ã€å®Œæ•´ CRUD æµç¨‹
3. **æå‡æµ‹è¯•ç¨³å®šæ€§**ï¼šè§£å†³è¶…æ—¶ã€é€‰æ‹©å™¨å¤±æ•ˆç­‰ä¸ç¨³å®šå› ç´ 
4. **å»ºç«‹è´¨é‡é—¨ç¦**ï¼šå°† E2E æµ‹è¯•çº³å…¥ CI æµç¨‹ï¼Œç¡®ä¿é•¿æœŸå¯ç»´æŠ¤æ€§

### 1.3 æˆåŠŸæ ‡å‡†

- [ ] ä¸šåŠ¡æµç¨‹ E2E é€šè¿‡ç‡ â‰¥95%
- [ ] åŸºç¡€åŠŸèƒ½ E2E é€šè¿‡ç‡ 100%
- [ ] æ¶æ„å¥‘çº¦ E2E ä¿æŒ 100%
- [ ] ä¼˜åŒ–éªŒè¯ä¸å›å½’æµ‹è¯•å‰§æœ¬æ‰§è¡Œå®Œæˆ
- [ ] E2E æµ‹è¯•æ€»è€—æ—¶ <5 åˆ†é’Ÿ
- [ ] æµ‹è¯•å¤±è´¥æ—¶æä¾›æ¸…æ™°çš„é”™è¯¯ä¸Šä¸‹æ–‡ä¸æˆªå›¾

---

## äºŒã€ç°çŠ¶åˆ†æ

### 2.1 æµ‹è¯•ç»“æœæ€»è§ˆ

| æµ‹è¯•ç±»åˆ« | é€šè¿‡ | å¤±è´¥ | æ€»è®¡ | é€šè¿‡ç‡ | å…³é”®é—®é¢˜ |
|---------|------|------|------|--------|---------|
| **PBAC Scope éªŒè¯** | âœ… 1 | 0 | 1 | 100% | - |
| **æ¶æ„å¥‘çº¦ E2E** | âœ… 6 | 0 | 6 | 100% | - |
| **ä¸šåŠ¡æµç¨‹ E2E** | âš ï¸ 9+ | âŒ 1 | 10+ | ~90% | æ•°æ®ä¸€è‡´æ€§æ–­è¨€ |
| **åŸºç¡€åŠŸèƒ½ E2E** | âœ… 8 | âŒ 2 | 10 | 80% | æµ‹è¯•é¡µé¢ç¼ºå¤± |
| **ä¼˜åŒ–éªŒè¯ E2E** | - | - | - | æœªæ‰§è¡Œ | - |
| **å›å½’æµ‹è¯• E2E** | - | - | - | æœªæ‰§è¡Œ | - |

### 2.2 å¤±è´¥æµ‹è¯•è¯¦æƒ…

#### é—®é¢˜ 1ï¼šæ•°æ®ä¸€è‡´æ€§æµ‹è¯•å¤±è´¥ï¼ˆP2ï¼‰

**æ–‡ä»¶**ï¼š`tests/e2e/business-flow-e2e.spec.ts:355`
**ç°è±¡**ï¼š
```
Expected: "å¯ç”¨"
Received: "âœ“ å¯ç”¨"
```

**æ ¹å› åˆ†æ**ï¼š
- å‰ç«¯ç»„ä»¶åœ¨æ¸²æŸ“çŠ¶æ€å­—æ®µæ—¶æ·»åŠ äº†å‹¾é€‰æ ‡è®° `âœ“`
- æµ‹è¯•æ–­è¨€æœŸå¾… API è¿”å›çš„åŸå§‹å€¼ï¼ˆ`"å¯ç”¨"`ï¼‰ï¼Œä½†å‰ç«¯å·²è½¬æ¢ä¸ºå¸¦æ ‡è®°çš„æ˜¾ç¤ºå€¼

**å½±å“èŒƒå›´**ï¼š
- ä¸šåŠ¡æµç¨‹ E2E ä¸­æ‰€æœ‰æ¶‰åŠçŠ¶æ€å­—æ®µçš„æ•°æ®ä¸€è‡´æ€§éªŒè¯
- å¯èƒ½å½±å“å…¶ä»–å­—æ®µçš„æ˜¾ç¤ºé€»è¾‘éªŒè¯

**è¯æ®**ï¼š
- æˆªå›¾ï¼š`test-results/business-flow-e2e-ä¸šåŠ¡æµç¨‹ç«¯åˆ°ç«¯æµ‹è¯•-æ•°æ®ä¸€è‡´æ€§éªŒè¯æµ‹è¯•-chromium/test-failed-1.png`
- è§†é¢‘ï¼š`test-results/.../video.webm`

---

#### é—®é¢˜ 2ï¼šæµ‹è¯•é¡µé¢åŠŸèƒ½éªŒè¯å¤±è´¥ï¼ˆP3ï¼‰

**æ–‡ä»¶**ï¼š`tests/e2e/basic-functionality-test.spec.ts:81`
**ç°è±¡**ï¼š
```
expect(hasButtons).toBeGreaterThan(0);
// Received: 0
```

**æ ¹å› åˆ†æ**ï¼š
- `/test` è·¯ç”±å¯èƒ½ä¸å­˜åœ¨æˆ–æœªæ­£ç¡®æ¸²æŸ“
- æµ‹è¯•é¡µé¢ç»„ä»¶ç¼ºå¤±äº¤äº’å…ƒç´ ï¼ˆæŒ‰é’®ã€è¡¨æ ¼ï¼‰

**å½±å“èŒƒå›´**ï¼š
- åŸºç¡€åŠŸèƒ½ E2E ä¸­çš„æµ‹è¯•é¡µé¢éªŒè¯ï¼ˆchromium + firefoxï¼‰
- å¯èƒ½è¡¨æ˜æµ‹è¯•é¡µé¢å·²åºŸå¼ƒæˆ–æœªç»´æŠ¤

**è¯æ®**ï¼š
- æˆªå›¾ï¼š`test-results/basic-functionality-test-æ—¶æ€ç®¡ç†ç³»ç»ŸåŸºç¡€åŠŸèƒ½éªŒè¯-æµ‹è¯•é¡µé¢åŠŸèƒ½éªŒè¯-chromium/test-failed-1.png`

---

#### é—®é¢˜ 3ï¼šä¸šåŠ¡æµç¨‹æµ‹è¯•è¶…æ—¶ï¼ˆP2ï¼‰

**æ–‡ä»¶**ï¼š`tests/e2e/business-flow-e2e.spec.ts:20`ï¼ˆå®Œæ•´ CRUD æµç¨‹ï¼‰
**ç°è±¡**ï¼šæµ‹è¯•æ‰§è¡Œè¶…æ—¶ï¼ˆ2 åˆ†é’Ÿé™åˆ¶ï¼‰ï¼Œæœªå®Œæˆæ‰€æœ‰å‰§æœ¬

**å¯èƒ½åŸå› **ï¼š
1. å‰ç«¯é¡µé¢åŠ è½½æ…¢æˆ–ç­‰å¾…å…ƒç´ è¶…æ—¶
2. è¡¨å•æäº¤åè·³è½¬å»¶è¿Ÿ
3. é€‰æ‹©å™¨ç­–ç•¥ä¸å½“ï¼ˆæœªä½¿ç”¨ `data-testid`ï¼‰
4. ç½‘ç»œè¯·æ±‚å“åº”æ…¢

**å½±å“èŒƒå›´**ï¼š
- å®Œæ•´ CRUD æµç¨‹è¦†ç›–ä¸å®Œæ•´
- æ— æ³•éªŒè¯åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤çš„ç«¯åˆ°ç«¯æµç¨‹

---

### 2.3 æœªæ‰§è¡Œæµ‹è¯•

| æµ‹è¯•æ–‡ä»¶ | çŠ¶æ€ | åŸå›  |
|---------|------|------|
| `optimization-verification-e2e.spec.ts` | â³ æœªæ‰§è¡Œ | 06 å·æ–‡æ¡£æœªæ˜ç¡®è¦æ±‚ |
| `regression-e2e.spec.ts` | â³ æœªæ‰§è¡Œ | 06 å·æ–‡æ¡£æœªæ˜ç¡®è¦æ±‚ |
| å®Œæ•´ CRUD æµç¨‹ï¼ˆ`business-flow-e2e.spec.ts`ï¼‰ | â³ å¾…éªŒè¯ | ç”¨ä¾‹å·²é‡å†™ï¼Œå¾…æ‰§è¡Œç¡®è®¤ |

---

## ä¸‰ã€æ”¹è¿›è®¡åˆ’

### 3.1 Phase 1ï¼šä¿®å¤ç°æœ‰å¤±è´¥æµ‹è¯•ï¼ˆä¼˜å…ˆçº§ P1-P2ï¼‰

#### ä»»åŠ¡ 1.1ï¼šä¿®å¤æ•°æ®ä¸€è‡´æ€§æµ‹è¯•ï¼ˆP2ï¼‰

**è´£ä»»äºº**ï¼šå‰ç«¯å›¢é˜Ÿ
**å·¥ä½œé‡**ï¼š0.5 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-04

**æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰**ï¼šè°ƒæ•´æµ‹è¯•æ–­è¨€é€»è¾‘
```typescript
// ä¿®æ”¹å‰
expect(firstFrontendItem.status).toBe(expectedStatus);

// ä¿®æ”¹åï¼ˆæ”¯æŒå¸¦æ ‡è®°çš„æ˜¾ç¤ºå€¼ï¼‰
const statusMap: Record<string, string> = {
  'ACTIVE': 'âœ“ å¯ç”¨',
  'INACTIVE': 'åœç”¨',
  'PLANNED': 'è®¡åˆ’ä¸­'
};
const expectedDisplayStatus = statusMap[firstApiItem.status] || firstApiItem.status;
expect(firstFrontendItem.status).toBe(expectedDisplayStatus);
```

**æ–¹æ¡ˆ Bï¼ˆé•¿æœŸï¼‰**ï¼šç»Ÿä¸€çŠ¶æ€å­—æ®µæ¸²æŸ“è§„èŒƒ
- å°†è§†è§‰æ ‡è®°ç§»è‡³ CSS ä¼ªå…ƒç´ ï¼ˆ`::before`ï¼‰æˆ–ç‹¬ç«‹å›¾æ ‡ç»„ä»¶
- API è¿”å›å€¼ä¸æ˜¾ç¤ºæ–‡æœ¬ä¿æŒä¸€è‡´
- æ›´æ–°è®¾è®¡è§„èŒƒæ–‡æ¡£

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ•°æ®ä¸€è‡´æ€§æµ‹è¯•é€šè¿‡ï¼ˆchromium + firefoxï¼‰
- [ ] å…¶ä»–çŠ¶æ€å­—æ®µæµ‹è¯•ä¸å—å½±å“
- [ ] æ›´æ–°æµ‹è¯•æ–‡æ¡£è¯´æ˜çŠ¶æ€æ˜ å°„é€»è¾‘

---

#### ä»»åŠ¡ 1.2ï¼šä¿®å¤æˆ–ç§»é™¤æµ‹è¯•é¡µé¢éªŒè¯ï¼ˆP3ï¼‰

**è´£ä»»äºº**ï¼šå‰ç«¯å›¢é˜Ÿ + QA
**å·¥ä½œé‡**ï¼š0.25 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-05

**æ–¹æ¡ˆ Aï¼ˆå¿«é€Ÿï¼‰**ï¼šç§»é™¤æµ‹è¯•é¡µé¢å‰§æœ¬
```typescript
// åœ¨ basic-functionality-test.spec.ts ä¸­æ ‡è®°ä¸º skip
test.skip('æµ‹è¯•é¡µé¢åŠŸèƒ½éªŒè¯', async ({ page }) => {
  // åŸæµ‹è¯•é€»è¾‘
});
```

**æ–¹æ¡ˆ Bï¼ˆé•¿æœŸï¼‰**ï¼šä¿®å¤æµ‹è¯•é¡µé¢
- æ£€æŸ¥ `/test` è·¯ç”±é…ç½®
- è¡¥å……æµ‹è¯•é¡µé¢ç»„ä»¶ï¼ˆè¡¨æ ¼ã€æŒ‰é’®ï¼‰
- æ›´æ–°è·¯ç”±æ–‡æ¡£è¯´æ˜æµ‹è¯•é¡µé¢ç”¨é€”

**å†³ç­–ä¾æ®**ï¼š
- å¦‚æµ‹è¯•é¡µé¢ä¸ºè°ƒè¯•ç”¨é€”ä¸”ä¸å½±å“ç”Ÿäº§ï¼Œé€‰æ‹©æ–¹æ¡ˆ A
- å¦‚æµ‹è¯•é¡µé¢ä¸ºå¿…éœ€åŠŸèƒ½ï¼Œé€‰æ‹©æ–¹æ¡ˆ B

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] åŸºç¡€åŠŸèƒ½ E2E é€šè¿‡ç‡ 100%
- [ ] æµ‹è¯•å¥—ä»¶æ— é˜»å¡æ€§å¤±è´¥

---

#### ä»»åŠ¡ 1.3ï¼šè§£å†³ä¸šåŠ¡æµç¨‹æµ‹è¯•è¶…æ—¶ï¼ˆP2ï¼‰

**è´£ä»»äºº**ï¼šQA å›¢é˜Ÿ
**å·¥ä½œé‡**ï¼š1 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-06

**ä¼˜åŒ–æªæ–½**ï¼š

1. **å¢åŠ è¶…æ—¶é…ç½®**
   ```typescript
   test('å®Œæ•´CRUDä¸šåŠ¡æµç¨‹æµ‹è¯•', async ({ page }) => {
     test.setTimeout(180000); // ä» 120s å¢åŠ åˆ° 180s
   });
   ```

2. **ä¼˜åŒ–é€‰æ‹©å™¨ç­–ç•¥**
   - ç¡®ä¿æ‰€æœ‰äº¤äº’å…ƒç´ ä½¿ç”¨ `data-testid`
   - ä½¿ç”¨ `page.waitForSelector()` æ›¿ä»£å›ºå®šå»¶è¿Ÿ
   ```typescript
   // ä¿®æ”¹å‰
   await page.click('button:has-text("åˆ›å»º")');

   // ä¿®æ”¹å
   await page.click('[data-testid="create-organization-button"]');
   await page.waitForURL('**/organizations/*/temporal');
   ```

3. **åˆ†æ®µéªŒè¯**
   - å°†é•¿æµç¨‹æ‹†åˆ†ä¸ºç‹¬ç«‹æµ‹è¯•
   - æ¯ä¸ªæµ‹è¯•ä¸“æ³¨å•ä¸€åŠŸèƒ½ï¼ˆåˆ›å»º / ç¼–è¾‘ / åˆ é™¤ï¼‰

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] å®Œæ•´ CRUD æµç¨‹æµ‹è¯•é€šè¿‡ï¼ˆ3 åˆ†é’Ÿå†…ï¼‰
- [ ] æä¾›åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤çš„å®Œæ•´æˆªå›¾ä¸è§†é¢‘
- [ ] HAR æ–‡ä»¶è®°å½•ç½‘ç»œè¯·æ±‚

---

### 3.2 Phase 2ï¼šè¡¥å……æœªæ‰§è¡Œæµ‹è¯•ï¼ˆä¼˜å…ˆçº§ P2-P3ï¼‰

#### ä»»åŠ¡ 2.1ï¼šæ‰§è¡Œä¼˜åŒ–éªŒè¯æµ‹è¯•ï¼ˆP3ï¼‰

**è´£ä»»äºº**ï¼šQA å›¢é˜Ÿ
**å·¥ä½œé‡**ï¼š0.5 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-08

**æ‰§è¡Œå‘½ä»¤**ï¼š
```bash
PW_JWT=$(cat .cache/dev.jwt) PW_TENANT_ID=3b99930c-4dc6-4cc9-8e4d-7d960a931cb9 \
npm run test:e2e -- tests/e2e/optimization-verification-e2e.spec.ts
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æµ‹è¯•æ‰§è¡Œå®Œæˆå¹¶ç”ŸæˆæŠ¥å‘Š
- [ ] è®°å½•æ€§èƒ½æŒ‡æ ‡ï¼ˆé¡µé¢åŠ è½½ã€API å“åº”ã€å†…å­˜ä½¿ç”¨ï¼‰
- [ ] æ›´æ–° 06 å·æ–‡æ¡£"å½“å‰çŠ¶æ€"

---

#### ä»»åŠ¡ 2.2ï¼šæ‰§è¡Œå›å½’æµ‹è¯•ï¼ˆP3ï¼‰

**è´£ä»»äºº**ï¼šQA å›¢é˜Ÿ
**å·¥ä½œé‡**ï¼š0.5 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-09

**æ‰§è¡Œå‘½ä»¤**ï¼š
```bash
PW_JWT=$(cat .cache/dev.jwt) PW_TENANT_ID=3b99930c-4dc6-4cc9-8e4d-7d960a931cb9 \
npm run test:e2e -- tests/e2e/regression-e2e.spec.ts
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æµ‹è¯•æ‰§è¡Œå®Œæˆå¹¶ç”ŸæˆæŠ¥å‘Š
- [ ] éªŒè¯æ ¸å¿ƒåŠŸèƒ½æ— å›é€€
- [ ] æ›´æ–°å›å½’æµ‹è¯•åŸºçº¿

---

### 3.3 Phase 3ï¼šæå‡æµ‹è¯•ç¨³å®šæ€§ä¸å¯ç»´æŠ¤æ€§ï¼ˆä¼˜å…ˆçº§ P2ï¼‰

#### ä»»åŠ¡ 3.1ï¼šä¼˜åŒ– Playwright é…ç½®ï¼ˆP2ï¼‰

**è´£ä»»äºº**ï¼šQA å›¢é˜Ÿ
**å·¥ä½œé‡**ï¼š0.5 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-10

**æ”¹è¿›é¡¹**ï¼š

1. **ç»Ÿä¸€è¶…æ—¶é…ç½®**
   ```typescript
   // playwright.config.ts
   export default defineConfig({
     timeout: 120000, // å…¨å±€æµ‹è¯•è¶…æ—¶
     expect: { timeout: 10000 }, // æ–­è¨€è¶…æ—¶
     use: {
       actionTimeout: 15000, // äº¤äº’è¶…æ—¶
       navigationTimeout: 30000, // å¯¼èˆªè¶…æ—¶
     },
   });
   ```

2. **å¢å¼ºé”™è¯¯è¯Šæ–­**
   ```typescript
   use: {
     screenshot: 'only-on-failure',
     video: 'retain-on-failure',
     trace: 'retain-on-failure',
   },
   ```

3. **æµè§ˆå™¨å¹¶è¡Œä¼˜åŒ–**
   ```typescript
   workers: process.env.CI ? 2 : 4, // CI ç¯å¢ƒé™åˆ¶å¹¶å‘
   ```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æµ‹è¯•å¤±è´¥æ—¶è‡ªåŠ¨ä¿å­˜ traceã€videoã€screenshot
- [ ] æµ‹è¯•æ€»è€—æ—¶ <5 åˆ†é’Ÿ
- [ ] æ›´æ–° `frontend/playwright.config.ts`

---

#### ä»»åŠ¡ 3.2ï¼šå»ºç«‹ E2E æµ‹è¯• CI é—¨ç¦ï¼ˆP2ï¼‰

**è´£ä»»äºº**ï¼šå¹³å°/å·¥å…·å›¢é˜Ÿ
**å·¥ä½œé‡**ï¼š1 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-12

**å®æ–½æ­¥éª¤**ï¼š

1. **åˆ›å»º GitHub Actions å·¥ä½œæµ**
   ```yaml
   # .github/workflows/e2e-tests.yml
   name: E2E Tests
   on:
     pull_request:
       branches: [main, develop]

   jobs:
     e2e:
       runs-on: ubuntu-latest
       steps:
         - uses: actions/checkout@v3
         - uses: actions/setup-node@v3
         - run: npm ci --prefix frontend
         - run: make docker-up
         - run: make run-dev &
         - run: make run-auth-rs256-sim &
         - run: sleep 10
         - run: PW_JWT=$(cat .cache/dev.jwt) PW_TENANT_ID=xxx npm run test:e2e --prefix frontend
         - uses: actions/upload-artifact@v3
           if: failure()
           with:
             name: playwright-report
             path: frontend/playwright-report/
   ```

2. **é…ç½®å¤±è´¥é€šçŸ¥**
   - Slack/ä¼ä¸šå¾®ä¿¡é€šçŸ¥
   - PR æ£€æŸ¥çŠ¶æ€é˜»å¡åˆå¹¶

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] PR æäº¤åè‡ªåŠ¨è§¦å‘ E2E æµ‹è¯•
- [ ] æµ‹è¯•å¤±è´¥é˜»æ­¢ PR åˆå¹¶
- [ ] å¤±è´¥æŠ¥å‘Šè‡ªåŠ¨ä¸Šä¼ è‡³ Artifacts

---

### 3.4 Phase 4ï¼šæ–‡æ¡£ä¸çŸ¥è¯†ä¼ æ‰¿ï¼ˆä¼˜å…ˆçº§ P3ï¼‰

#### ä»»åŠ¡ 4.1ï¼šå®Œå–„ E2E æµ‹è¯•æ–‡æ¡£ï¼ˆP3ï¼‰

**è´£ä»»äºº**ï¼šQA å›¢é˜Ÿ
**å·¥ä½œé‡**ï¼š0.5 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-13

**æ–‡æ¡£å†…å®¹**ï¼š
1. **å¿«é€Ÿå¼€å§‹**ï¼šæœ¬åœ°è¿è¡Œ E2E æµ‹è¯•çš„å®Œæ•´æ­¥éª¤
2. **ç¼–å†™è§„èŒƒ**ï¼šé€‰æ‹©å™¨å‘½åã€æ–­è¨€ç­–ç•¥ã€é”™è¯¯å¤„ç†
3. **è°ƒè¯•æŒ‡å—**ï¼šå¦‚ä½•ä½¿ç”¨ Playwright Inspector ä¸ Trace Viewer
4. **å¸¸è§é—®é¢˜**ï¼šè¶…æ—¶ã€é€‰æ‹©å™¨å¤±æ•ˆã€è®¤è¯å¤±è´¥çš„è§£å†³æ–¹æ¡ˆ

**è¾“å‡ºä½ç½®**ï¼š`docs/development-tools/e2e-testing-guide.md`

---

#### ä»»åŠ¡ 4.2ï¼šæ›´æ–°å‚è€ƒæ‰‹å†Œï¼ˆP3ï¼‰

**è´£ä»»äºº**ï¼šæ¶æ„ç»„
**å·¥ä½œé‡**ï¼š0.25 å¤©
**æˆªæ­¢æ—¥æœŸ**ï¼š2025-10-13

**æ›´æ–°å†…å®¹**ï¼š
- åœ¨ `docs/reference/01-DEVELOPER-QUICK-REFERENCE.md` è¡¥å…… E2E æµ‹è¯•å‘½ä»¤
- åœ¨ `CLAUDE.md` ç´¢å¼•ä¸­æ·»åŠ  18 å·æ–‡æ¡£é“¾æ¥

---

## å››ã€æ—¶é—´è¡¨ä¸é‡Œç¨‹ç¢‘

| é˜¶æ®µ | ä»»åŠ¡ | è´Ÿè´£äºº | å·¥æœŸ | æˆªæ­¢æ—¥æœŸ | çŠ¶æ€ |
|------|------|--------|------|---------|------|
| **Phase 1** | ä¿®å¤æ•°æ®ä¸€è‡´æ€§æµ‹è¯• | å‰ç«¯å›¢é˜Ÿ | 0.5d | 2025-10-04 | â³ å¾…å¯åŠ¨ |
| | ä¿®å¤/ç§»é™¤æµ‹è¯•é¡µé¢ | å‰ç«¯ + QA | 0.25d | 2025-10-05 | â³ å¾…å¯åŠ¨ |
| | è§£å†³ä¸šåŠ¡æµç¨‹è¶…æ—¶ | QA å›¢é˜Ÿ | 1d | 2025-10-06 | â³ å¾…å¯åŠ¨ |
| **Phase 2** | æ‰§è¡Œä¼˜åŒ–éªŒè¯æµ‹è¯• | QA å›¢é˜Ÿ | 0.5d | 2025-10-08 | â³ å¾…å¯åŠ¨ |
| | æ‰§è¡Œå›å½’æµ‹è¯• | QA å›¢é˜Ÿ | 0.5d | 2025-10-09 | â³ å¾…å¯åŠ¨ |
| **Phase 3** | ä¼˜åŒ– Playwright é…ç½® | QA å›¢é˜Ÿ | 0.5d | 2025-10-10 | â³ å¾…å¯åŠ¨ |
| | å»ºç«‹ CI é—¨ç¦ | å¹³å°/å·¥å…· | 1d | 2025-10-12 | â³ å¾…å¯åŠ¨ |
| **Phase 4** | å®Œå–„æµ‹è¯•æ–‡æ¡£ | QA å›¢é˜Ÿ | 0.5d | 2025-10-13 | â³ å¾…å¯åŠ¨ |
| | æ›´æ–°å‚è€ƒæ‰‹å†Œ | æ¶æ„ç»„ | 0.25d | 2025-10-13 | â³ å¾…å¯åŠ¨ |
| **æ€»è®¡** | | | **5 å¤©** | **2025-10-13** | |

---

## äº”ã€éªŒæ”¶æ ‡å‡†

### 5.1 æµ‹è¯•é€šè¿‡ç‡

- [ ] ä¸šåŠ¡æµç¨‹ E2Eï¼šâ‰¥95%ï¼ˆ9+/10 é€šè¿‡ï¼‰
- [ ] åŸºç¡€åŠŸèƒ½ E2Eï¼š100%ï¼ˆ10/10 é€šè¿‡ï¼‰
- [ ] æ¶æ„å¥‘çº¦ E2Eï¼š100%ï¼ˆä¿æŒï¼‰
- [ ] ä¼˜åŒ–éªŒè¯ E2Eï¼šâ‰¥90%
- [ ] å›å½’æµ‹è¯• E2Eï¼šâ‰¥95%

### 5.2 æ€§èƒ½æŒ‡æ ‡

- [ ] æµ‹è¯•æ€»è€—æ—¶ï¼š<5 åˆ†é’Ÿ
- [ ] å•ä¸ªæµ‹è¯•è¶…æ—¶ï¼š<3 åˆ†é’Ÿ
- [ ] é¡µé¢åŠ è½½æ—¶é—´ï¼š<1 ç§’ï¼ˆä¸­ä½æ•°ï¼‰
- [ ] API å“åº”æ—¶é—´ï¼š<200msï¼ˆP95ï¼‰

### 5.3 è´¨é‡é—¨ç¦

- [ ] `.github/workflows/e2e-tests.yml` åœ¨ PR åœºæ™¯ä¸‹è‡ªåŠ¨è¿è¡Œ Playwright å¥—ä»¶
- [ ] PR åˆå¹¶å‰å¿…é¡»é€šè¿‡ E2E æµ‹è¯•ï¼ˆå« chromium / firefox é¡¹ç›®ï¼‰
- [ ] å¤±è´¥æµ‹è¯•è‡ªåŠ¨ç”Ÿæˆ traceã€screenshotã€video å¹¶ä½œä¸º artifact ä¸Šä¼ 

### 5.4 éªŒè¯æ­¥éª¤ï¼ˆæ‰§è¡Œé¡ºåºï¼‰

1. å¯åŠ¨ä¾èµ–æ ˆå¹¶ç¡®ä¿å¥åº·ï¼š
   ```bash
   make docker-up
   make run-auth-rs256-sim
   curl -fsS http://localhost:9090/health
   curl -fsS http://localhost:8090/health
   ```
2. ç”Ÿæˆå¼€å‘ç”¨ RS256 JWTï¼Œå¹¶è®°å½•ç§Ÿæˆ·ï¼š
   ```bash
   make jwt-dev-mint
   export PW_JWT=$(cat .cache/dev.jwt)
   export PW_TENANT_ID=3b99930c-4dc6-4cc9-8e4d-7d960a931cb9
   ```
3. åœ¨ `frontend/` ç›®å½•æ‰§è¡Œå®Œæ•´ Playwright å¥—ä»¶ï¼Œç¡®è®¤ chromium ä¸ firefox å…¨éƒ¨é€šè¿‡ï¼š
   ```bash
   cd frontend
   PW_JWT=$PW_JWT PW_TENANT_ID=$PW_TENANT_ID npm run test:e2e
   ```
4. å¦‚éœ€å•ç‹¬éªŒè¯å‰§æœ¬ï¼ˆä¾‹å¦‚å›å½’/ä¼˜åŒ–éªŒè¯ï¼‰ï¼Œå¤ç”¨ç›¸åŒä»¤ç‰Œï¼š
   ```bash
   PW_JWT=$PW_JWT PW_TENANT_ID=$PW_TENANT_ID \
     npm run test:e2e -- tests/e2e/regression-e2e.spec.ts
   ```
5. é€šè¿‡ `npx playwright show-report` æ£€æŸ¥æŠ¥å‘Šä¸ traceï¼›CI å¤±è´¥æ—¶åœ¨ artifact ä¸­è·å–ç›¸åŒè¯æ®ã€‚
6. æ‰€æœ‰ç»“æœä¸æ“ä½œéœ€åŒæ­¥è®°å½•åˆ° `docs/development-tools/e2e-testing-guide.md` æ‰€åˆ—æ ‡å‡†ã€‚

### 5.5 æ–‡æ¡£å®Œæ•´æ€§

- [ ] E2E æµ‹è¯•æŒ‡å—å‘å¸ƒï¼ˆ`docs/development-tools/e2e-testing-guide.md`ï¼‰
- [ ] å¿«é€Ÿå‚è€ƒæ‰‹å†Œæ›´æ–°
- [ ] CLAUDE.md ç´¢å¼•åŒ…å« 18 å·æ–‡æ¡£

---

## å…­ã€é£é™©ä¸ç¼“è§£

### 6.1 é£é™©è¯†åˆ«

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|------|---------|
| **å‰ç«¯æ¸²æŸ“é€»è¾‘å˜æ›´å¯¼è‡´æµ‹è¯•å¤±è´¥** | ä¸­ | ä¸­ | ä½¿ç”¨ `data-testid` æ›¿ä»£æ–‡æœ¬é€‰æ‹©å™¨ |
| **æµ‹è¯•ç¯å¢ƒä¸ç¨³å®šï¼ˆç½‘ç»œ/æ•°æ®åº“ï¼‰** | ä½ | é«˜ | å¢åŠ é‡è¯•æœºåˆ¶ï¼Œä½¿ç”¨ Docker å›ºå®šç¯å¢ƒ |
| **æœ¬åœ°èµ„æºä¸è¶³å¯¼è‡´è¶…æ—¶** | ä¸­ | ä¸­ | é™åˆ¶å¹¶å‘æ•°ï¼Œæå‰æ„å»ºé•œåƒå¹¶æ¸…ç†ç£ç›˜ |
| **å›¢é˜Ÿå¯¹ Playwright ä¸ç†Ÿæ‚‰** | ä½ | ä¸­ | æä¾›åŸ¹è®­ä¸æ–‡æ¡£ï¼ŒæŒ‡å®šä¸“äººæ”¯æŒ |

### 6.2 ä¾èµ–é¡¹

- âœ… æœåŠ¡æ ˆå·²å¯åŠ¨ï¼ˆPostgreSQL + Redis + å‘½ä»¤æœåŠ¡ + æŸ¥è¯¢æœåŠ¡ï¼‰
- âœ… RS256 JWT è®¤è¯é“¾è·¯æ­£å¸¸
- âœ… Playwright åŸºç¡€é…ç½®å®Œæˆ
- âœ… æœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯ â€” **å·²æ‰§è¡Œ** (2025-10-02)
  - âœ… éªŒè¯æŠ¥å‘Šï¼š`reports/iig-guardian/plan18-ci-verification-20251002.md`
  - âœ… Playwright æŠ¥å‘Šï¼š`frontend/playwright-report/index.html`
  - âœ… éªŒè¯æ—¥å¿—ï¼š`reports/iig-guardian/plan18-local-validation.log`
  - âœ… æ‰§è¡Œç»“æœï¼šfirefox 40é€šè¿‡/4è·³è¿‡ï¼Œchromium éƒ¨åˆ†å®Œæˆï¼Œç¯å¢ƒå¯ç”¨

---

## ä¸ƒã€å®æ–½æ¡ä»¶è¯„ä¼°

### 7.1 å‰ç½®æ¡ä»¶æ£€æŸ¥æ¸…å•

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| **æœ¬åœ°æµ‹è¯•ç¯å¢ƒå¯ç”¨** | âœ… å®Œæˆ | `docker-compose.e2e.yml` å·²å°±ç»ªï¼Œå¯åœ¨æœ¬åœ°è¿è¡Œå®Œæ•´ E2E æ ˆ |
| **RS256 è®¤è¯é“¾è·¯éªŒè¯** | âœ… å®Œæˆ | å·²é€šè¿‡ `playwright-rs256-verification-20251002.md` éªŒè¯ |
| **Playwright æµ‹è¯•å¥—ä»¶å­˜åœ¨** | âœ… å®Œæˆ | 5 ä¸ªæµ‹è¯•æ–‡ä»¶å·²åˆ›å»ºï¼ˆæ¶æ„ã€ä¸šåŠ¡æµç¨‹ã€åŸºç¡€åŠŸèƒ½ã€ä¼˜åŒ–ã€å›å½’ï¼‰ |
| **æœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯æ‰§è¡Œ** | âœ… å®Œæˆ | 2025-10-02 æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶11åˆ†é’Ÿ |
| **éªŒè¯æŠ¥å‘Šå¡«å†™** | âœ… å®Œæˆ | æŠ¥å‘Šå·²å¡«å†™ï¼Œç»“è®ºä¸º"éƒ¨åˆ†é€šè¿‡ï¼Œå»ºè®®å¯åŠ¨ Phase 1" |
| **å¤±è´¥æµ‹è¯•æ ¹å› å·²æ˜ç¡®** | âœ… å®Œæˆ | 3 ä¸ªå¤±è´¥é—®é¢˜å·²åˆ†æå¹¶æä¾›ä¿®å¤æ–¹æ¡ˆ |
| **å›¢é˜Ÿèµ„æºåˆ°ä½** | â³ å¾…ç¡®è®¤ | éœ€å‰ç«¯å›¢é˜Ÿ + QA å›¢é˜Ÿç¡®è®¤æ’æœŸ |

### 7.2 å®æ–½æ¡ä»¶åˆ¤å®š

**ç»“è®º**ï¼šâœ… **å·²å…·å¤‡ç«‹å³å®æ–½æ¡ä»¶**

**åŸé˜»å¡é¡¹ï¼ˆå·²è§£é™¤ï¼‰**ï¼š
1. âœ… **æœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯å·²æ‰§è¡Œ**ï¼ˆ2025-10-02 16:06-16:17ï¼Œè€—æ—¶11åˆ†é’Ÿï¼‰
   - âœ… Docker æ ˆå¯åŠ¨ã€æœåŠ¡å¥åº·æ£€æŸ¥é€šè¿‡ï¼ˆ9090/8090 HTTP 200ï¼‰
   - âœ… JWT mint æˆåŠŸï¼ˆé€šè¿‡ API /auth/dev-token ç”Ÿæˆ RS256 ä»¤ç‰Œï¼‰
   - âœ… Playwright å¥—ä»¶æ‰§è¡Œå®Œæˆï¼ˆfirefox 40é€šè¿‡/4è·³è¿‡ï¼Œchromium éƒ¨åˆ†å®Œæˆï¼‰
   - âœ… å®Œæ•´è¯æ®å·²ä¿å­˜ï¼š
     - éªŒè¯æŠ¥å‘Šï¼š`reports/iig-guardian/plan18-ci-verification-20251002.md`
     - æ§åˆ¶å°æ—¥å¿—ï¼š`reports/iig-guardian/plan18-local-validation.log`
     - Playwright æŠ¥å‘Šï¼š`frontend/playwright-report/index.html`ï¼ˆ641KBï¼‰

2. âœ… **éªŒè¯æŠ¥å‘Šå·²å¡«å†™**ï¼ˆçŠ¶æ€ï¼šå·²å®Œæˆï¼Œç»“è®ºï¼šéƒ¨åˆ†é€šè¿‡ï¼Œå»ºè®®å¯åŠ¨ Phase 1ï¼‰
   - âœ… ç¯å¢ƒä¿¡æ¯å®Œæ•´ï¼ˆLinux WSL2, Docker 28.2.2, Node v22.17.1, Go 1.23.12ï¼‰
   - âœ… éªŒè¯æ­¥éª¤ä¸ç»“æœè¯¦ç»†è®°å½•ï¼ˆä¾èµ–å¯åŠ¨ã€JWTã€Playwrightã€è¯æ®æ”¶é›†ï¼‰
   - âœ… é—®é¢˜æ¸…å•æ˜ç¡®ï¼ˆ3ä¸ªé—®é¢˜å‡ä¸ºå·²çŸ¥æˆ–å¯æ¥å—ï¼‰

### 7.3 å¯åŠ¨å‰å¿…éœ€æ“ä½œï¼ˆå·²å®Œæˆ âœ…ï¼‰

~~åœ¨å¯åŠ¨ Plan 18 æ‰§è¡Œå‰ï¼Œ**å¿…é¡»**å®Œæˆä»¥ä¸‹æœ¬åœ°éªŒè¯æµç¨‹~~ï¼ˆ**å·²äº 2025-10-02 å®Œæˆ**ï¼‰ï¼š

#### âœ… æ“ä½œ 1ï¼šæ‰§è¡Œæœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯ï¼ˆä¼˜å…ˆçº§ P0ï¼‰â€” å·²å®Œæˆ
**æ‰§è¡Œæ—¶é—´**ï¼š2025-10-02 16:06-16:17ï¼ˆ11åˆ†é’Ÿï¼‰

```bash
# æ‰§è¡Œè®°å½•
âœ… 1. å¯åŠ¨ä¾èµ–æ ˆ: make docker-up && make run-auth-rs256-sim
âœ… 2. å¥åº·æ£€æŸ¥: 9090/8090 å‡è¿”å› HTTP 200
âœ… 3. JWT ç”Ÿæˆ: é€šè¿‡ API /auth/dev-token æˆåŠŸç”Ÿæˆï¼ˆmake jwt-dev-mint å¤±è´¥ï¼Œå·²ç”¨å¤‡é€‰æ–¹æ¡ˆï¼‰
âœ… 4. Playwright æ‰§è¡Œ: firefox 40é€šè¿‡/4è·³è¿‡ï¼ˆ6.1minï¼‰ï¼Œchromium éƒ¨åˆ†å®Œæˆï¼ˆè¶…æ—¶ï¼‰
âœ… 5. äº§ç‰©ç”Ÿæˆ: playwright-report/index.htmlï¼ˆ641KBï¼‰+ test-results å®Œæ•´
```

**éªŒè¯æŒ‡æ ‡**ï¼š
- [x] âœ… Docker Compose æ ˆæˆåŠŸå¯åŠ¨ä¸”æœåŠ¡å¥åº·
- [x] âœ… `.cache/dev.jwt` æˆåŠŸç”Ÿæˆï¼ˆé€šè¿‡ APIï¼‰
- [x] âœ… Playwright å¥—ä»¶å®Œæˆæ‰§è¡Œï¼ˆfirefox å®Œæ•´é€šè¿‡ï¼‰
- [x] âœ… ç”Ÿæˆ `frontend/playwright-report` ä¸ `frontend/test-results`

#### âœ… æ“ä½œ 2ï¼šè®°å½•éªŒè¯ç»“æœï¼ˆä¼˜å…ˆçº§ P1ï¼‰â€” å·²å®Œæˆ
- âœ… éªŒè¯æŠ¥å‘Šå·²å¡«å†™ï¼š`reports/iig-guardian/plan18-ci-verification-20251002.md`
  - ç¯å¢ƒä¿¡æ¯ï¼šLinux WSL2, Docker 28.2.2, Node v22.17.1, Go 1.23.12
  - éªŒè¯æ­¥éª¤ï¼šä¾èµ–å¯åŠ¨ â†’ JWT â†’ Playwright â†’ è¯æ®æ”¶é›†ï¼ˆè¯¦ç»†è®°å½•ï¼‰
  - æ‰§è¡Œç»“æœï¼šéƒ¨åˆ†é€šè¿‡ï¼ˆ11åˆ†é’Ÿï¼‰
  - é—®é¢˜æ¸…å•ï¼š3ä¸ªé—®é¢˜ï¼ˆå‡ä¸ºå·²çŸ¥æˆ–å¯æ¥å—ï¼‰
  - ç»“è®ºï¼šæœ¬åœ°ç¯å¢ƒå·²å…·å¤‡ Phase 1 ä»»åŠ¡æ‰§è¡Œæ¡ä»¶

#### âœ… æ“ä½œ 3ï¼šæ›´æ–°ä¾èµ–é¡¹çŠ¶æ€ï¼ˆä¼˜å…ˆçº§ P1ï¼‰â€” å·²å®Œæˆ
å·²æ›´æ–° `6.2 ä¾èµ–é¡¹` çŠ¶æ€ä¸ºï¼š
```markdown
- âœ… æœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯ â€” å·²æ‰§è¡Œ (2025-10-02)
  - éªŒè¯æŠ¥å‘Šï¼šreports/iig-guardian/plan18-ci-verification-20251002.md
  - Playwright æŠ¥å‘Šï¼šfrontend/playwright-report/index.html
  - éªŒè¯æ—¥å¿—ï¼šreports/iig-guardian/plan18-local-validation.log
  - æ‰§è¡Œç»“æœï¼šfirefox 40é€šè¿‡/4è·³è¿‡ï¼Œchromium éƒ¨åˆ†å®Œæˆï¼Œç¯å¢ƒå¯ç”¨
```

**è¯æ®æäº¤**ï¼š
- Commit: 567e4a79
- Files: 3 changed, 5090 insertions(+), 333 deletions(-)
- åŒ…å«ï¼šéªŒè¯æŠ¥å‘Šã€éªŒè¯æ—¥å¿—ã€æ–‡æ¡£çŠ¶æ€æ›´æ–°

### 7.4 é£é™©æç¤ºï¼ˆå·²ç¼“è§£ âœ…ï¼‰

~~å¦‚æœè·³è¿‡æœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯ç›´æ¥å®æ–½ Plan 18~~ï¼ˆ**å·²å®ŒæˆéªŒè¯ï¼Œé£é™©å·²ç¼“è§£**ï¼‰ï¼š
- ~~é«˜é£é™©ï¼šç¯å¢ƒæœªå‡†å¤‡å……åˆ†~~ â†’ âœ… **å·²ç¼“è§£**ï¼šç¯å¢ƒéªŒè¯é€šè¿‡ï¼Œ9090/8090æœåŠ¡å¥åº·
- ~~ä¸­é£é™©ï¼šPlaywright ä¾èµ–ç¼ºå¤±~~ â†’ âœ… **å·²ç¼“è§£**ï¼šfirefox é¡¹ç›®å®Œæ•´æ‰§è¡Œï¼Œchromium å¯åç»­ä¼˜åŒ–
- ~~ä½é£é™©ï¼šæµ‹è¯•æŠ¥å‘Šç›®å½•ä¸å­˜åœ¨~~ â†’ âœ… **å·²ç¼“è§£**ï¼šplaywright-report ä¸ test-results å·²ç”Ÿæˆ

**å½“å‰é£é™©çŠ¶æ€**ï¼š
- âœ… ç¯å¢ƒå¯ç”¨æ€§ï¼šå·²éªŒè¯ï¼Œå¯ä»¥å®‰å…¨å¯åŠ¨ Phase 1
- âš ï¸ Chromium è¶…æ—¶ï¼šå¯æ¥å—ï¼ˆfirefox å·²éªŒè¯é€šè¿‡ï¼Œä¸å½±å“ Phase 1 å¯åŠ¨ï¼‰
- âœ… è¯æ®å®Œæ•´ï¼šéªŒè¯æŠ¥å‘Šã€æ—¥å¿—ã€artifacts å·²ä¿å­˜å¹¶æäº¤

**Phase 1 å¯åŠ¨å»ºè®®**ï¼šâœ… å¯ä»¥ç«‹å³å¯åŠ¨ï¼Œæ— é˜»å¡é£é™©ã€‚

---

## å…«ã€åç»­è®¡åˆ’

### 8.1 Phase 5ï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰

1. **E2E æµ‹è¯•å¹¶è¡ŒåŒ–**ï¼šä¼˜åŒ–æµ‹è¯•åˆ†ç»„ï¼Œåˆ©ç”¨å¤š worker å¹¶è¡Œæ‰§è¡Œ
2. **è§†è§‰å›å½’æµ‹è¯•**ï¼šé›†æˆ Percy æˆ– Playwright Visual Comparisons
3. **æ€§èƒ½ç›‘æ§é›†æˆ**ï¼šE2E æµ‹è¯•ä¸­é‡‡é›† Web Vitals æŒ‡æ ‡
4. **ç§»åŠ¨ç«¯æµ‹è¯•**ï¼šè¡¥å……ç§»åŠ¨æµè§ˆå™¨ï¼ˆMobile Chrome/Safariï¼‰æµ‹è¯•

### 8.2 æŠ€æœ¯å€ºåŠ¡

- **TODO-TEMPORARY æ¸…ç†**ï¼šæµ‹è¯•æ–‡ä»¶ä¸­çš„ä¸´æ—¶å®ç°éœ€æŒ‰ Plan 17 æ ‡å‡†å¤„ç†
- **å¼±ç±»å‹æ²»ç†**ï¼š`any/unknown` åœ¨æµ‹è¯•æ–‡ä»¶ä¸­çš„ä½¿ç”¨éœ€ç¬¦åˆ Plan 16 è§„èŒƒ
- **é€‰æ‹©å™¨ç¡¬ç¼–ç **ï¼šå…¨é¢è¿ç§»åˆ° `data-testid` ç­–ç•¥

---

## ä¹ã€å‚è€ƒèµ„æ–™

### 9.1 å†…éƒ¨æ–‡æ¡£

- [06-integrated-teams-progress-log.md](./06-integrated-teams-progress-log.md) â€” é›†æˆå›¢é˜Ÿæ¨è¿›è®°å½•
- [16-code-smell-analysis-and-improvement-plan.md](./16-code-smell-analysis-and-improvement-plan.md) â€” ä»£ç å¼‚å‘³æ²»ç†è®¡åˆ’
- [Playwright RS256 éªŒè¯æŠ¥å‘Š](../../reports/iig-guardian/playwright-rs256-verification-20251002.md)

### 9.2 æŠ€æœ¯å‚è€ƒ

- [Playwright å®˜æ–¹æ–‡æ¡£](https://playwright.dev/)
- [Playwright Best Practices](https://playwright.dev/docs/best-practices)
- [RS256 JWT è®¤è¯è§„èŒƒ](../../docs/api/openapi.yaml)
- [PBAC æƒé™å®ç°](../../internal/auth/pbac.go)

---

## é™„å½• Aï¼šæµ‹è¯•å‘½ä»¤é€ŸæŸ¥

```bash
# 1. å¯åŠ¨å®Œæ•´æœåŠ¡æ ˆ
make docker-up
make run-dev &
make run-auth-rs256-sim &

# 2. ç”Ÿæˆ JWT ä»¤ç‰Œ
curl -X POST http://localhost:9090/auth/dev-token \
  -H 'Content-Type: application/json' \
  -d '{"userId":"dev-user","tenantId":"3b99930c-4dc6-4cc9-8e4d-7d960a931cb9","roles":["ADMIN","USER"],"duration":"24h"}' \
  | jq -r '.data.token' > .cache/dev.jwt

# 3. æ‰§è¡Œæ‰€æœ‰ E2E æµ‹è¯•
cd frontend
PW_JWT=$(cat ../.cache/dev.jwt) PW_TENANT_ID=3b99930c-4dc6-4cc9-8e4d-7d960a931cb9 \
npm run test:e2e

# 4. æ‰§è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
npm run test:e2e -- tests/e2e/business-flow-e2e.spec.ts

# 5. è°ƒè¯•æ¨¡å¼ï¼ˆæ‰“å¼€ Playwright Inspectorï¼‰
npm run test:e2e -- --debug

# 6. æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
npx playwright show-report
```

---

## é™„å½• Bï¼šä¿®æ”¹æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `frontend/tests/e2e/business-flow-e2e.spec.ts` | é‡å†™ç”¨ä¾‹ | å¼•å…¥å”¯ä¸€æ ‡è¯†ã€åˆ†æ­¥æ–­è¨€ã€ç¨³å®šé€‰æ‹©å™¨ |
| `frontend/tests/e2e/basic-functionality-test.spec.ts` | ä¼˜åŒ–æ–­è¨€ | ç§»é™¤å›ºå®šå»¶è¿Ÿï¼Œä½¿ç”¨ data-testid æ ¡éªŒ |
| `frontend/src/features/organizations/components/OrganizationTable/TableRow.tsx` | UI è°ƒæ•´ | çŠ¶æ€æ–‡æœ¬æ ‡å‡†åŒ–ï¼Œè¡¥å…… `status-pill-*` é€‰æ‹©å™¨ |
| `frontend/src/features/organizations/OrganizationTemporalPage.tsx` | UI è°ƒæ•´ | æ–°å¢ `back-to-organization-list` æŒ‰é’®æ ‡è¯† |
| `frontend/src/features/temporal/components/inlineNewVersionForm/FormActions.tsx` | UI è°ƒæ•´ | è¡¥å……ç¼–è¾‘/åˆ é™¤æ“ä½œçš„ data-testid |
| `frontend/src/features/temporal/components/inlineNewVersionForm/DeactivateConfirmModal.tsx` | UI è°ƒæ•´ | ç¡®è®¤å¼¹çª—æ–°å¢ data-testid |
| `frontend/src/features/temporal/components/inlineNewVersionForm/EffectiveDateSection.tsx` | UI è°ƒæ•´ | ç”Ÿæ•ˆæ—¥æœŸå­—æ®µæ–°å¢ data-testid |
| `frontend/playwright.config.ts` | é…ç½®ä¼˜åŒ– | è°ƒæ•´ workerã€è¶…æ—¶ã€è¯Šæ–­èµ„äº§ä¿ç•™ç­–ç•¥ |
| `.github/workflows/e2e-tests.yml` | æ–°å»ºæ–‡ä»¶ | E2E é—¨ç¦å·¥ä½œæµï¼ˆPR / æ‰‹åŠ¨è§¦å‘ï¼‰ |
| `docs/development-tools/e2e-testing-guide.md` | æ–°å»ºæ–‡ä»¶ | æœ¬åœ°/CI E2E æ“ä½œè¯´æ˜ |

---

**æœ¬æ–‡æ¡£çŠ¶æ€**ï¼šâœ… å·²åˆ›å»ºï¼Œâœ… å‰ç½®éªŒè¯å·²å®Œæˆï¼Œâœ… å¯å¯åŠ¨ Phase 1

**æœ€åéªŒè¯**ï¼š2025-10-02 16:06-16:17ï¼ˆæœ¬åœ°ç«¯åˆ°ç«¯éªŒè¯ï¼‰
**éªŒè¯ç»“è®º**ï¼šâš ï¸ éƒ¨åˆ†é€šè¿‡ï¼Œå»ºè®®å¯åŠ¨ Phase 1
**æäº¤è®°å½•**ï¼šCommit 567e4a79ï¼ˆéªŒè¯æŠ¥å‘Š + æ—¥å¿— + æ–‡æ¡£æ›´æ–°ï¼‰
