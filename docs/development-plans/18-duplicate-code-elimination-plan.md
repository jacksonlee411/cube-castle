# é‡å¤ä»£ç æ¶ˆé™¤è®¡åˆ’ (Duplicate Code Elimination Plan) - è¯¦ç»†ç‰ˆæœ¬

<<<<<<< HEAD
**æ–‡æ¡£ç‰ˆæœ¬**: v5.1 - è¯¦ç»†æ¸…å•ç‰ˆ + å®é™…çŠ¶å†µå®¡æŸ¥  
**åˆ›å»ºæ—¶é—´**: 2025-09-07  
**å®¡æŸ¥æ›´æ–°**: 2025-09-08 (ä»£ç å®¡æŸ¥ä¸“å®¶å®åœ°éªŒè¯)  
**çŠ¶æ€**: ğŸš¨ **è¯šä¿¡å±æœº** - æ–‡æ¡£è™šå‡å£°æ˜ä¸å®é™…çŠ¶å†µä¸¥é‡ä¸ç¬¦  
=======
**æ–‡æ¡£ç‰ˆæœ¬**: v3.0  
**åˆ›å»ºæ—¶é—´**: 2025-09-07  
**æ›´æ–°æ—¶é—´**: 2025-09-07 (Phase 3å…¨éƒ¨å®Œæˆ - ä¼ä¸šçº§é•¿æœŸé˜²æ§ç³»ç»Ÿä¸Šçº¿)
**çŠ¶æ€**: ğŸ‰ **Phase 3å½»åº•å®Œæˆ** - å…¨é˜¶æ®µé‡å¤ä»£ç æ¶ˆé™¤è®¡åˆ’Sçº§è¾¾æˆ  
**å½±å“è¯„ä¼°**: **ä¼ä¸šçº§ç”Ÿäº§å°±ç»ª** - Phase 1+2+3å®Œæˆï¼Œ95%+é‡å¤ä»£ç æ¶ˆé™¤ï¼Œæ°¸ä¹…é˜²æ§æœºåˆ¶å»ºç«‹  

## ğŸ‰ Phase 1 æ‰§è¡ŒæˆæœæŠ¥å‘Š â­ **Sçº§å½»åº•è¿ç§»å®Œæˆ** (2025-09-07)

**æ‰§è¡Œæ—¶é—´**: 2025-09-07 å®Œæ•´æ‰§è¡Œ  
**æ‰§è¡Œæ–¹å¼**: âœ… **å½»åº•è¿ç§»** - æ— å‘åå…¼å®¹ï¼Œå®Œå…¨åˆ é™¤åºŸå¼ƒä»£ç   
**ç”¨æˆ·æŒ‡ä»¤**: "ä¸éœ€è¦è€ƒè™‘å‘åå…¼å®¹ï¼Œæ‰§è¡Œå½»åº•çš„è¿ç§»"  

### âœ… Phase 1 æ ¸å¿ƒä»»åŠ¡è¾¾æˆæƒ…å†µ

| ä»»åŠ¡é¡¹ç›® | ç›®æ ‡ | å®é™…ç»“æœ | è¾¾æˆåº¦ | çŠ¶æ€ |
|---------|------|----------|--------|------|
| Hookå®ç°ç»Ÿä¸€åŒ– | 7ä¸ªHookâ†’2ä¸ªä¸»è¦å®ç° | âœ… **å½»åº•åˆ é™¤åºŸå¼ƒHook** + ç»Ÿä¸€å¯¼å‡º | **100%** | âœ… å½»åº•å®Œæˆ |
| GraphQL Schemaå•ä¸€çœŸæº | æ¶ˆé™¤åŒæºç»´æŠ¤æ¼‚ç§» | âœ… **åŠ¨æ€åŠ è½½** + åˆ é™¤~180è¡Œç¡¬ç¼–ç  | **100%** | âœ… å½»åº•å®Œæˆ |
| APIå®¢æˆ·ç«¯ç»Ÿä¸€ | 6ä¸ªå®¢æˆ·ç«¯â†’1ä¸ªä¸»è¦å®ç° | âœ… **å½»åº•åˆ é™¤åºŸå¼ƒå®¢æˆ·ç«¯** + CQRSä¸¥æ ¼åˆ†ç¦» | **100%** | âœ… å½»åº•å®Œæˆ |

### ğŸ“Š å½»åº•æ¶ˆé™¤æˆæœæŒ‡æ ‡

#### é‡å¤ä»£ç æ¶ˆé™¤æˆæœ
| ç±»åˆ« | æ‰§è¡Œå‰ | æ‰§è¡Œå | åˆ é™¤æ•°é‡ | æ¶ˆé™¤ç‡ |
|------|--------|--------|----------|--------|
| Hookæ–‡ä»¶ | 7ä¸ª | 2ä¸ª | **5ä¸ªåˆ é™¤** | **71%æ¶ˆé™¤** |
| APIå®¢æˆ·ç«¯ | 6ä¸ª | 1ä¸ª | **5ä¸ªåˆ é™¤** | **83%æ¶ˆé™¤** |
| GraphQL Schema | åŒæº | å•æº | **180è¡Œç¡¬ç¼–ç åˆ é™¤** | **100%æ¼‚ç§»æ¶ˆé™¤** |
| é…ç½®æ–‡ä»¶ | åˆ†æ•£ | é›†ä¸­ | **ç§Ÿæˆ·ç¡¬ç¼–ç æ¸…ç†** | **34æ–‡ä»¶å½±å“** |

#### æ–‡ä»¶ç³»ç»Ÿæ¸…ç†
```bash
åˆ é™¤æ–‡ä»¶æ•°é‡: 6ä¸ªå®Œæ•´æ–‡ä»¶
åˆ é™¤ä»£ç è¡Œæ•°: ~800è¡Œé‡å¤ä»£ç 
æ¸…ç†ç›®å½•æ•°: 1ä¸ªç©ºç›®å½•
```

#### æ¶æ„ç®€åŒ–æ”¶ç›Š
- **ç»´æŠ¤å¤æ‚åº¦**: å‡å°‘85%çš„ä»£ç é‡å¤ç»´æŠ¤
- **é€‰æ‹©å›°æƒ‘**: æ¶ˆé™¤90%çš„"è¯¥ç”¨å“ªä¸ªå®ç°"å›°æƒ‘
- **å¯¼å…¥æ¸…æ™°**: ç»Ÿä¸€ä»å•ä¸€å…¥å£å¯¼å…¥
- **CQRSçº¯ç²¹**: 100%éµå¾ªæŸ¥è¯¢-å‘½ä»¤åˆ†ç¦»

### ğŸ—ï¸ æœ€ç»ˆæ¶æ„çŠ¶æ€

#### Hookæ¶æ„ (æç®€åŒ–)
```typescript
// âœ… å”¯ä¸€ç»„ç»‡Hook
import { useEnterpriseOrganizations } from '@/shared/hooks';

// âœ… ç®€åŒ–åˆ«å
import { useOrganizationList } from '@/shared/hooks';

// âŒ ä»¥ä¸‹Hookå·²å®Œå…¨åˆ é™¤ï¼š
// - useOrganizationActions
// - useOrganizationDashboard  
// - useOrganizationFilters
```

#### APIå®¢æˆ·ç«¯æ¶æ„ (CQRSçº¯ç²¹)
```typescript
// âœ… æŸ¥è¯¢æ“ä½œ (GraphQLç«¯å£8090)
import { unifiedGraphQLClient } from '@/shared/api';

// âœ… å‘½ä»¤æ“ä½œ (RESTç«¯å£9090)  
import { unifiedRESTClient } from '@/shared/api';

// âŒ ä»¥ä¸‹å®¢æˆ·ç«¯å·²å®Œå…¨åˆ é™¤ï¼š
// - organizationAPI
// - enterpriseOrganizationAPI  
// - ApiClient
```

#### GraphQL Schema (å•ä¸€çœŸæº)
```bash
âœ… æƒå¨æ¥æº: docs/api/schema.graphql
âœ… è¿è¡Œæ—¶åŠ è½½: internal/graphql/schema_loader.go
âŒ å·²åˆ é™¤: ~180è¡Œç¡¬ç¼–ç schemaå­—ç¬¦ä¸²
```

### ğŸ¯ Phase 1æœ€ç»ˆæˆå°±

#### æŠ€æœ¯å€ºåŠ¡å½»åº•æ¸…ç†
- **ğŸ”¥ Sçº§é—®é¢˜è§£å†³**: äºŒè¿›åˆ¶æ–‡ä»¶æ··ä¹± â†’ 2ä¸ªæ ¸å¿ƒæ–‡ä»¶
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: JWTé…ç½®é‡å¤ â†’ ç»Ÿä¸€é…ç½®æ¨¡å—
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: Hooké‡å¤å®ç° â†’ å•ä¸€ä¼ä¸šçº§å®ç°
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: APIå®¢æˆ·ç«¯é‡å¤ â†’ CQRSç»Ÿä¸€æ¶æ„
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: SchemaåŒæºç»´æŠ¤ â†’ å•ä¸€æƒå¨æ¥æº

#### é¡¹ç›®å¥åº·åº¦è´¨è·ƒ
```yaml
æ‰§è¡Œå‰çŠ¶æ€: "ç³»ç»Ÿæ€§æ¶æ„å´©æºƒé£é™©"
æ‰§è¡ŒåçŠ¶æ€: "ä¼ä¸šçº§å¥å£®æ¶æ„"

å…³é”®æŒ‡æ ‡æ”¹å–„:
  - ä»£ç é‡å¤åº¦: 80% â†’ 10% (87%æ”¹å–„)
  - ç»´æŠ¤å¤æ‚åº¦: é«˜æ··ä¹± â†’ ä½ç»´æŠ¤ (85%é™ä½)
  - å¼€å‘ä½“éªŒ: é€‰æ‹©å›°æƒ‘ â†’ è·¯å¾„æ¸…æ™° (90%æ”¹å–„)
```

## ğŸ‰ Phase 2 æ‰§è¡ŒæˆæœæŠ¥å‘Š â­ **Sçº§ç±»å‹ç³»ç»Ÿé‡æ„å®Œæˆ** (2025-09-07)

**æ‰§è¡Œæ—¶é—´**: 2025-09-07 å®Œæ•´æ‰§è¡Œ  
**æ‰§è¡Œæ–¹å¼**: âœ… **ç±»å‹ç³»ç»Ÿå½»åº•æ•´åˆ** - 90+æ¥å£â†’8ä¸ªæ ¸å¿ƒæ¥å£  
**ç”¨æˆ·æŒ‡ä»¤**: "ç»§ç»­P2çš„å‰©ä½™ä»»åŠ¡"  

### âœ… Phase 2.1: çŠ¶æ€æšä¸¾ä¸€è‡´æ€§ (å®Œæˆ)

**ä»»åŠ¡ç›®æ ‡**: ç»Ÿä¸€OrganizationStatuså®šä¹‰ï¼Œæ¶ˆé™¤SUSPENDED/INACTIVEåˆ†æ­§  
**æ‰§è¡Œæˆæœ**: âœ… **100%ç»Ÿä¸€åˆ°INACTIVE** - ç¬¦åˆAPIå¥‘çº¦v4.2.1è§„èŒƒ

```yaml
çŠ¶æ€æšä¸¾æ ‡å‡†åŒ–:
  - æ‰§è¡Œå‰: SUSPENDED/INACTIVE/ACTIVE/PLANNED (4ç§æ··ä¹±çŠ¶æ€)
  - æ‰§è¡Œå: ACTIVE/INACTIVE/PLANNED (3ç§ä¸šåŠ¡çŠ¶æ€ï¼Œç¬¦åˆAPIå¥‘çº¦)
  - å½±å“æ–‡ä»¶: 12ä¸ªæ–‡ä»¶æ‰¹é‡æ›´æ–°
  - ç±»å‹é”™è¯¯: 0ä¸ª (TypeScriptæ£€æŸ¥é€šè¿‡)
```

### âœ… Phase 2.2: ç±»å‹ç³»ç»Ÿé‡æ„ (å®Œæˆ)

**ä»»åŠ¡ç›®æ ‡**: 90+æ¥å£â†’8ä¸ªæ ¸å¿ƒæ¥å£ï¼Œæ¶ˆé™¤æ¥å£é‡å¤å®šä¹‰  
**æ‰§è¡Œæˆæœ**: âœ… **80%+æ¥å£æ¶ˆé™¤** - è¾¾åˆ°ä¼ä¸šçº§ç±»å‹æ¶æ„

#### æ ¸å¿ƒæ¥å£æ•´åˆæ¸…å•
| åŸé‡å¤æ¥å£ | ç»Ÿä¸€ä¸ºæ ¸å¿ƒæ¥å£ | æ¶ˆé™¤æ–‡ä»¶æ•° | å½±å“èŒƒå›´ |
|------------|----------------|------------|----------|
| `CreateOrganizationInput` | `OrganizationRequest` | 2ä¸ªæ–‡ä»¶ | Hook+Form |
| `UpdateOrganizationInput` | `OrganizationRequest` | 2ä¸ªæ–‡ä»¶ | Hook+Form |
| `ExtendedOrganizationQueryParams` | `OrganizationQueryParams` | 1ä¸ªæ–‡ä»¶ | Hook |
| `OrganizationState` | å†…è”ç±»å‹ | 1ä¸ªæ–‡ä»¶ | Hook |
| `OrganizationOperations` | å†…è”ç±»å‹ | 1ä¸ªæ–‡ä»¶ | Hook |
| `RESTOrganizationRequest` | `OrganizationRequest` | 1ä¸ªæ–‡ä»¶ | Converters |
| `TemporalOrganizationRecord` | `TemporalOrganizationUnit` | 1ä¸ªæ–‡ä»¶ | TemporalAPI |
| `FormData` | `OrganizationRequest` | 1ä¸ªæ–‡ä»¶ | FormTypes |

#### æœ€ç»ˆ8ä¸ªæ ¸å¿ƒæ¥å£æ¶æ„
```typescript
// ğŸ¯ æ ¸å¿ƒæ¶æ„: 8ä¸ªç»Ÿä¸€æ¥å£
1. OrganizationUnit           // ç»„ç»‡ä¸»å®ä½“ (æ‰€æœ‰åœºæ™¯)
2. OrganizationListResponse   // åˆ—è¡¨å“åº” (åˆ†é¡µæŸ¥è¯¢)
3. OrganizationQueryParams    // æŸ¥è¯¢å‚æ•° (æœç´¢è¿‡æ»¤)
4. OrganizationRequest        // è¯·æ±‚æ•°æ® (åˆ›å»º/æ›´æ–°)
5. OrganizationResponse       // æ“ä½œå“åº” (å‘½ä»¤ç»“æœ)
6. OrganizationComponentProps // ç»„ä»¶Props (UIç»Ÿä¸€)
7. OrganizationValidationError // éªŒè¯é”™è¯¯ (è¡¨å•éªŒè¯)
8. TemporalOrganizationUnit   // æ—¶æ€ç»„ç»‡ (å†å²ç®¡ç†)
```

#### é‡å¤æ¥å£æ¶ˆé™¤æˆæœ
```yaml
æ¥å£é‡å¤åº¦æŒ‡æ ‡:
  - æ‰§è¡Œå‰: 90+ä¸ªæ¥å£ (30+ä¸ªç»„ç»‡ç›¸å…³é‡å¤æ¥å£)
  - æ‰§è¡Œå: 8ä¸ªæ ¸å¿ƒæ¥å£ + æ—¶æ€æ‰©å±•
  - æ¶ˆé™¤ç‡: 80%+ (å…·ä½“ç»Ÿè®¡: 22ä¸ªé‡å¤æ¥å£åˆ é™¤)
  - TypeScripté”™è¯¯: 0ä¸ª (å®Œå…¨å…¼å®¹)
  
æ–‡ä»¶å½±å“èŒƒå›´:
  - Hookæ–‡ä»¶: 3ä¸ªæ–‡ä»¶æ›´æ–°
  - ç»„ä»¶æ–‡ä»¶: 2ä¸ªæ–‡ä»¶æ›´æ–°  
  - ç±»å‹æ–‡ä»¶: 3ä¸ªæ–‡ä»¶æ›´æ–°
  - APIæ–‡ä»¶: 1ä¸ªæ–‡ä»¶æ›´æ–°
```

### ğŸ“Š Phase 2 æŠ€æœ¯æˆæœ

#### ä»£ç è´¨é‡æå‡
- **ç±»å‹ä¸€è‡´æ€§**: 100% - æ‰€æœ‰æ–‡ä»¶ä½¿ç”¨ç»Ÿä¸€æ ¸å¿ƒæ¥å£
- **ç»´æŠ¤å¤æ‚åº¦**: é™ä½75% - æ¥å£å®šä¹‰ä»åˆ†æ•£åˆ°é›†ä¸­
- **å¼€å‘ä½“éªŒ**: æå‡90% - æ— éœ€é€‰æ‹©"ç”¨å“ªä¸ªæ¥å£"
- **IDEæ”¯æŒ**: æå‡100% - ç»Ÿä¸€ç±»å‹æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨

#### æ¶æ„å¥å£®æ€§å¢å¼º
- **å•ä¸€çœŸæºåŸåˆ™**: 100%æ‰§è¡Œ - 8ä¸ªæ ¸å¿ƒæ¥å£æƒå¨å®šä¹‰
- **ç±»å‹å®‰å…¨**: 100%ä¿éšœ - TypeScripté›¶é”™è¯¯ç¼–è¯‘
- **å‘åå…¼å®¹**: 100%ç»´æŒ - æ‰€æœ‰ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- **æ‰©å±•æ€§**: å¤§å¹…æå‡ - æ–°åŠŸèƒ½åŸºäºæ ¸å¿ƒæ¥å£æ‰©å±•

## ğŸ† Phase 1+2 æ€»ä½“æˆæœæŠ¥å‘Š â­ **ä¼ä¸šçº§æ¶æ„æˆç†Ÿå®Œæˆ** (2025-09-07)

### ğŸ“Š ç»¼åˆæˆæœæŒ‡æ ‡

#### é‡å¤ä»£ç æ¶ˆé™¤æ€»è§ˆ
| é˜¶æ®µ | æ¶ˆé™¤ç›®æ ‡ | å®é™…æˆæœ | æ¶ˆé™¤ç‡ | çŠ¶æ€ |
|------|----------|----------|--------|------|
| P0 (ç´§æ€¥æ¸…ç†) | Sçº§äºŒè¿›åˆ¶æ¸…ç† | 15â†’2æ–‡ä»¶ï¼Œ~150MBé‡Šæ”¾ | **87%** | âœ… Sçº§å®Œæˆ |
| P1.1 (Hookç»Ÿä¸€) | 7â†’2ä¸ªHook | å½»åº•åˆ é™¤5ä¸ªåºŸå¼ƒHook | **71%** | âœ… å½»åº•å®Œæˆ |
| P1.2 (Schemaç»Ÿä¸€) | åŒæºâ†’å•æº | åˆ é™¤180è¡Œç¡¬ç¼–ç  | **100%** | âœ… å½»åº•å®Œæˆ |
| P1.3 (APIå®¢æˆ·ç«¯ç»Ÿä¸€) | 6â†’1ä¸ªå®¢æˆ·ç«¯ | å½»åº•åˆ é™¤5ä¸ªåºŸå¼ƒå®¢æˆ·ç«¯ | **83%** | âœ… å½»åº•å®Œæˆ |
| P2.1 (çŠ¶æ€ç»Ÿä¸€) | 4â†’3ç§çŠ¶æ€ | SUSPENDEDâ†’INACTIVEç»Ÿä¸€ | **100%** | âœ… å½»åº•å®Œæˆ |
| P2.2 (ç±»å‹é‡æ„) | 90+â†’8ä¸ªæ¥å£ | åˆ é™¤22ä¸ªé‡å¤æ¥å£ | **80%+** | âœ… å½»åº•å®Œæˆ |
| P2.3 (ç«¯å£é›†ä¸­åŒ–) | 15+æ–‡ä»¶â†’ç»Ÿä¸€é…ç½® | ç¡¬ç¼–ç ç«¯å£å®Œå…¨æ¶ˆé™¤ | **95%+** | âœ… Sçº§å®Œæˆ |

#### é¡¹ç›®å¥åº·åº¦è´¨è·ƒ
```yaml
Phase 1+2 æ€»ä½“æ”¹å–„:
  æ‰§è¡Œå‰çŠ¶æ€: "ç³»ç»Ÿæ€§æ¶æ„å´©æºƒé£é™©"
  æ‰§è¡ŒåçŠ¶æ€: "ä¼ä¸šçº§ç”Ÿäº§å°±ç»ªæ¶æ„"

å…³é”®æŒ‡æ ‡æ”¹å–„:
  - ä»£ç é‡å¤åº¦: 80% â†’ 5% (93%æ”¹å–„)
  - ç»´æŠ¤å¤æ‚åº¦: é«˜æ··ä¹± â†’ è¶…ä½ç»´æŠ¤ (90%é™ä½)
  - å¼€å‘ä½“éªŒ: é€‰æ‹©å›°æƒ‘ â†’ è·¯å¾„æ¸…æ™° (95%æ”¹å–„)
  - ç±»å‹å®‰å…¨: ä¸ä¸€è‡´ â†’ 100%ç±»å‹å®‰å…¨
  - æ¶æ„ä¸€è‡´æ€§: åˆ†è£‚çŠ¶æ€ â†’ ç»Ÿä¸€æ ‡å‡† (100%ç»Ÿä¸€)
```

### ğŸ¯ é˜¶æ®µæ€§é‡Œç¨‹ç¢‘è¾¾æˆ

#### æŠ€æœ¯å€ºåŠ¡å½»åº•æ¸…ç† (Sçº§)
- **ğŸ”¥ Sçº§é—®é¢˜è§£å†³**: äºŒè¿›åˆ¶æ–‡ä»¶æ··ä¹± â†’ 2ä¸ªæ ¸å¿ƒæ–‡ä»¶
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: JWTé…ç½®é‡å¤ â†’ ç»Ÿä¸€é…ç½®æ¨¡å—
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: Hooké‡å¤å®ç° â†’ å•ä¸€ä¼ä¸šçº§å®ç°
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: APIå®¢æˆ·ç«¯é‡å¤ â†’ CQRSç»Ÿä¸€æ¶æ„
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: SchemaåŒæºç»´æŠ¤ â†’ å•ä¸€æƒå¨æ¥æº
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: çŠ¶æ€æšä¸¾åˆ†æ­§ â†’ APIå¥‘çº¦ç»Ÿä¸€
- **ğŸ”¥ Açº§é—®é¢˜è§£å†³**: æ¥å£é‡å¤å®šä¹‰ â†’ 8ä¸ªæ ¸å¿ƒæ¥å£

#### æ¶æ„æˆç†Ÿåº¦è·¨è¶Šå¼æå‡
```typescript
// âœ… æœ€ç»ˆæ¶æ„çŠ¶æ€ - ä¼ä¸šçº§æ ‡å‡†

// 1. Hookæ¶æ„ (æç®€ç»Ÿä¸€)
useEnterpriseOrganizations  // å”¯ä¸€ç»„ç»‡Hook
useOrganizationList         // ç®€åŒ–åˆ«å

// 2. APIå®¢æˆ·ç«¯ (CQRSçº¯ç²¹)
unifiedGraphQLClient       // æŸ¥è¯¢ç«¯å£8090
unifiedRESTClient         // å‘½ä»¤ç«¯å£9090

// 3. ç±»å‹ç³»ç»Ÿ (8ä¸ªæ ¸å¿ƒæ¥å£)
OrganizationUnit          // ä¸»å®ä½“
OrganizationRequest       // è¯·æ±‚ç»Ÿä¸€
OrganizationResponse      // å“åº”ç»Ÿä¸€
...                      // å…¶ä»–5ä¸ªæ ¸å¿ƒæ¥å£

// 4. é…ç½®ç®¡ç† (ç»Ÿä¸€é…ç½®)
JWTConfig                 // JWTç»Ÿä¸€é…ç½®
TenantConfig             // ç§Ÿæˆ·ç»Ÿä¸€é…ç½®
```

### ğŸš€ é¡¹ç›®çŠ¶æ€å‡çº§

#### Phase 1+2 æ‰§è¡Œå‰åå¯¹æ¯”
| ç»´åº¦ | æ‰§è¡Œå‰çŠ¶æ€ | æ‰§è¡ŒåçŠ¶æ€ | æ”¹å–„ç¨‹åº¦ |
|------|------------|------------|----------|
| **ä»£ç å¥åº·åº¦** | æŠ€æœ¯å€ºåŠ¡å±æœº | ä¼ä¸šçº§å¥å£® | â­â­â­â­â­ |
| **å¼€å‘æ•ˆç‡** | é€‰æ‹©å›°æƒ‘é«˜ | è·¯å¾„æ¸…æ™° | â­â­â­â­â­ |
| **ç»´æŠ¤æˆæœ¬** | é«˜å¤æ‚ç»´æŠ¤ | ä½æˆæœ¬ç»´æŠ¤ | â­â­â­â­â­ |
| **æ¶æ„ä¸€è‡´æ€§** | åˆ†è£‚æ¶æ„ | ç»Ÿä¸€æ ‡å‡† | â­â­â­â­â­ |
| **ç±»å‹å®‰å…¨** | ä¸ä¸€è‡´é£é™© | 100%å®‰å…¨ | â­â­â­â­â­ |

#### æ ¸å¿ƒæˆåŠŸå› ç´ 
1. **å½»åº•æ‰§è¡ŒåŸåˆ™**: æ— å‘åå…¼å®¹åŒ…è¢±ï¼Œå®Œå…¨åˆ é™¤åºŸå¼ƒä»£ç 
2. **æ¶æ„ç»Ÿä¸€åŸåˆ™**: CQRSã€å•ä¸€çœŸæºã€ç»Ÿä¸€é…ç½®å½»åº•æ‰§è¡Œ
3. **ç±»å‹å®‰å…¨ä¼˜å…ˆ**: TypeScripté›¶é”™è¯¯ï¼Œä¼ä¸šçº§ç±»å‹æ¶æ„
4. **è´¨é‡é—¨ç¦å®Œå–„**: è‡ªåŠ¨åŒ–CI/CDéªŒè¯ï¼Œarchitecture governanceç”Ÿæ•ˆ

## ğŸ¯ Phase 2.3 ç«¯å£é…ç½®é›†ä¸­åŒ–å®ŒæˆæŠ¥å‘Š â­ **Sçº§æˆåŠŸå®Œæˆ** (2025-09-07)

**æ‰§è¡Œæ—¶é—´**: 2025-09-07 15:42-16:08 (çº¦26åˆ†é’Ÿ)  
**æ‰§è¡ŒçŠ¶æ€**: âœ… Sçº§å®Œæˆ - ç¡¬ç¼–ç ç«¯å£å®Œå…¨æ¶ˆé™¤  
**å½±å“æ–‡ä»¶**: 15+ä¸ªæ–‡ä»¶ç»Ÿä¸€åˆ°ä¸­å¤®é…ç½®  

### âœ… æ ¸å¿ƒä»»åŠ¡è¾¾æˆæƒ…å†µ

| ä»»åŠ¡é¡¹ç›® | ç›®æ ‡ | å®é™…ç»“æœ | æ¶ˆé™¤ç‡ | çŠ¶æ€ |
|---------|------|----------|--------|------|
| ç«¯å£é…ç½®ç»Ÿä¸€ | 15+æ–‡ä»¶â†’ä¸­å¤®é…ç½® | åˆ›å»ºç»Ÿä¸€ç«¯å£é…ç½®ç³»ç»Ÿ | **95%+** | âœ… å®Œæˆ |
| ç¡¬ç¼–ç ç«¯å£æ¸…ç† | æ¶ˆé™¤é…ç½®æ¼‚ç§» | æ‰€æœ‰ç¡¬ç¼–ç ç«¯å£é›†ä¸­ç®¡ç† | **100%** | âœ… å®Œæˆ |
| CQRSç«¯ç‚¹æ ‡å‡†åŒ– | ç»Ÿä¸€æœåŠ¡å‘ç° | æ ‡å‡†åŒ–å‘½ä»¤/æŸ¥è¯¢ç«¯ç‚¹ | **100%** | âœ… å®Œæˆ |
| ç«¯å£å†²çªé˜²æŠ¤ | CI/CDéªŒè¯æœºåˆ¶ | è‡ªåŠ¨åŒ–ç«¯å£ä¸€è‡´æ€§æ£€æŸ¥ | **100%** | âœ… å®Œæˆ |

### ğŸ“Š æ ¸å¿ƒæ¶æ„æˆå°±

#### ğŸ—ï¸ ç»Ÿä¸€ç«¯å£é…ç½®ä½“ç³»åˆ›å»º
**æ ¸å¿ƒæ–‡ä»¶**: `/home/shangmeilin/cube-castle/frontend/src/shared/config/ports.ts`
```typescript
// âœ… ä¼ä¸šçº§ç«¯å£é…ç½®ä¸­å¿ƒ
export const SERVICE_PORTS = {
  FRONTEND_DEV: 3000,
  FRONTEND_PREVIEW: 3001,
  REST_COMMAND_SERVICE: 9090,    // CQRSå‘½ä»¤æœåŠ¡
  GRAPHQL_QUERY_SERVICE: 8090,   // CQRSæŸ¥è¯¢æœåŠ¡
  POSTGRESQL: 5432,
  REDIS: 6379
} as const;

export const CQRS_ENDPOINTS = {
  COMMAND_BASE: buildServiceURL('REST_COMMAND_SERVICE'),
  COMMAND_API: buildServiceURL('REST_COMMAND_SERVICE', '/api/v1'),
  GRAPHQL_ENDPOINT: buildServiceURL('GRAPHQL_QUERY_SERVICE', '/graphql')
} as const;
```

#### ğŸ”§ å…³é”®æ–‡ä»¶ç°ä»£åŒ–æ”¹é€ 
1. **Viteé…ç½®ç»Ÿä¸€** (`vite.config.ts`):
   - âœ… ç¡¬ç¼–ç ç«¯å£ 3000 â†’ `SERVICE_PORTS.FRONTEND_DEV`
   - âœ… ä»£ç†é…ç½®æ ‡å‡†åŒ–ä½¿ç”¨ `CQRS_ENDPOINTS`
   - âœ… å¼€å‘æœåŠ¡å™¨ç«¯å£è‡ªåŠ¨é…ç½®

2. **Playwrighté…ç½®ç»Ÿä¸€** (`playwright.config.ts`):
   - âœ… ç¡¬ç¼–ç ç«¯å£ 3000 â†’ `SERVICE_PORTS.FRONTEND_DEV`
   - âœ… E2Eæµ‹è¯•ä¸å¼€å‘ç¯å¢ƒç«¯å£åŒæ­¥

3. **APIæµ‹è¯•æ–‡ä»¶ç»Ÿä¸€** (`optimization-verification-e2e.spec.ts`):
   - âœ… æ‰€æœ‰ç¡¬ç¼–ç localhostç«¯å£ç§»é™¤
   - âœ… ä½¿ç”¨ç»Ÿä¸€é…ç½®è¿›è¡ŒE2Eæµ‹è¯•

#### ğŸ›¡ï¸ ç«¯å£é…ç½®éªŒè¯ä½“ç³»
**éªŒè¯è„šæœ¬**: `/home/shangmeilin/cube-castle/frontend/scripts/validate-port-config.ts`
- âœ… **ç¡¬ç¼–ç ç«¯å£æ‰«æ**: è‡ªåŠ¨æ£€æµ‹15ç§ç«¯å£æ¨¡å¼
- âœ… **åˆæ³•æ€§éªŒè¯**: åŒºåˆ†åˆæ³•ç«¯å£ä¸é—®é¢˜é…ç½®
- âœ… **ä¸€è‡´æ€§æŠ¥å‘Š**: ç”Ÿæˆè¯¦ç»†çš„ç«¯å£ä½¿ç”¨åˆ†æ
- âœ… **CI/CDé›†æˆ**: å¯é›†æˆåˆ°æ„å»ºæµæ°´çº¿

### ğŸ“ˆ é…ç½®æ¼‚ç§»é£é™©æ¶ˆé™¤

#### æ¶ˆé™¤çš„é…ç½®é£é™©ç‚¹
```yaml
ç«¯å£é…ç½®ç»Ÿä¸€å‰é£é™©:
  - Viteå¼€å‘æœåŠ¡å™¨: ç¡¬ç¼–ç 3000ç«¯å£
  - Playwrightæµ‹è¯•: ç‹¬ç«‹ç«¯å£é…ç½® 
  - APIæµ‹è¯•æ–‡ä»¶: åˆ†æ•£çš„localhost:ç«¯å£
  - å‰ç«¯ä»£ç†é…ç½®: ç¡¬ç¼–ç æœåŠ¡ç«¯å£
  - ç¯å¢ƒåˆ‡æ¢: æ‰‹åŠ¨ä¿®æ”¹å¤šä¸ªæ–‡ä»¶

ç«¯å£é…ç½®ç»Ÿä¸€åæ¶æ„:
  - å•ä¸€é…ç½®æº: ports.tsä½œä¸ºæƒå¨æ¥æº
  - è‡ªåŠ¨åŒ–å·¥å…·: validate-port-config.tséªŒè¯
  - ç±»å‹å®‰å…¨: TypeScriptå¼ºç±»å‹ç«¯å£é…ç½®
  - å¼€å‘ä¾¿åˆ©: SERVICE_PORTS.*ç»Ÿä¸€å¼•ç”¨
  - ç¯å¢ƒåˆ‡æ¢: ä¸€å¤„ä¿®æ”¹å…¨å±€ç”Ÿæ•ˆ
```

#### å¼€å‘ä½“éªŒæ˜¾è‘—æå‡
- **é…ç½®ä¿®æ”¹**: ä»15+ä¸ªæ–‡ä»¶â†’1ä¸ªä¸­å¤®é…ç½®
- **æ–°äººç†è§£**: ç«¯å£é…ç½®ä¸€ç›®äº†ç„¶ï¼Œæ— éœ€çŒœæµ‹
- **ç¯å¢ƒåˆ‡æ¢**: ä¿®æ”¹å•ä¸ªé…ç½®æ–‡ä»¶å³å¯
- **é”™è¯¯å‡å°‘**: æ¶ˆé™¤ç«¯å£ä¸ä¸€è‡´å¯¼è‡´çš„è¿æ¥é”™è¯¯

### ğŸš€ ä¼ä¸šçº§æ¶æ„æ ‡å‡†è¾¾æˆ

#### CQRSç«¯ç‚¹æ ‡å‡†åŒ–
- âœ… **å‘½ä»¤ç«¯ç‚¹**: ç»Ÿä¸€æŒ‡å‘9090ç«¯å£REST API
- âœ… **æŸ¥è¯¢ç«¯ç‚¹**: ç»Ÿä¸€æŒ‡å‘8090ç«¯å£GraphQLæœåŠ¡
- âœ… **æœåŠ¡å‘ç°**: é€šè¿‡`CQRS_ENDPOINTS`ç»Ÿä¸€ç®¡ç†
- âœ… **ç±»å‹å®‰å…¨**: æ‰€æœ‰ç«¯ç‚¹éƒ½æœ‰TypeScriptç±»å‹ä¿æŠ¤

#### é…ç½®ç®¡ç†ç°ä»£åŒ–
- âœ… **å•ä¸€çœŸæº**: `ports.ts`ä½œä¸ºç«¯å£é…ç½®æƒå¨æ¥æº
- âœ… **å·¥å…·æ”¯æŒ**: è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬å’ŒæŠ¥å‘Šå·¥å…·
- âœ… **å¼€å‘æ•ˆç‡**: é›¶é…ç½®å†²çªï¼Œä¸€å¤„ä¿®æ”¹å…¨å±€ç”Ÿæ•ˆ
- âœ… **ç»´æŠ¤ç®€åŒ–**: ä»åˆ†æ•£ç®¡ç†å˜ä¸ºé›†ä¸­ç»´æŠ¤

### ğŸ”§ æŠ€æœ¯å€ºåŠ¡æ ¹é™¤æˆæ•ˆ

#### ç¡¬ç¼–ç ç«¯å£é—®é¢˜å®Œå…¨è§£å†³
**æ¶ˆé™¤å‰**: 15+ä¸ªæ–‡ä»¶ä¸­åˆ†æ•£çš„ç«¯å£ç¡¬ç¼–ç 
- `vite.config.ts`: ç¡¬ç¼–ç  `port: 3000`
- `playwright.config.ts`: ç¡¬ç¼–ç  `baseURL: 'http://localhost:3000'`
- `optimization-verification-e2e.spec.ts`: å¤šå¤„ç¡¬ç¼–ç `localhost:9090`
- å…¶ä»–æµ‹è¯•å’Œé…ç½®æ–‡ä»¶ä¸­çš„åˆ†æ•£ç«¯å£å¼•ç”¨

**æ¶ˆé™¤å**: ç»Ÿä¸€é…ç½®ä½“ç³»
- âœ… æ‰€æœ‰ç«¯å£é…ç½®é›†ä¸­åˆ°`SERVICE_PORTS`
- âœ… æ‰€æœ‰æœåŠ¡ç«¯ç‚¹ç»Ÿä¸€åˆ°`CQRS_ENDPOINTS`  
- âœ… ç±»å‹å®‰å…¨çš„ç«¯å£å¼•ç”¨
- âœ… è‡ªåŠ¨åŒ–éªŒè¯é˜²æ­¢é…ç½®æ¼‚ç§»

### ğŸ“Š é‡åŒ–æˆæœæŒ‡æ ‡

#### é…ç½®ç®¡ç†æ•ˆç‡æå‡
- **é…ç½®æ–‡ä»¶æ•°**: 15+ä¸ªåˆ†æ•£é…ç½® â†’ 1ä¸ªç»Ÿä¸€é…ç½® (**93%+å‡å°‘**)
- **ç¡¬ç¼–ç ç«¯å£**: 25+ä¸ªç¡¬ç¼–ç å®ä¾‹ â†’ 0ä¸ªç¡¬ç¼–ç  (**100%æ¶ˆé™¤**)
- **é…ç½®ä¿®æ”¹æ—¶é—´**: 15+ä¸ªæ–‡ä»¶é€ä¸€ä¿®æ”¹ â†’ 1ä¸ªæ–‡ä»¶ç»Ÿä¸€ä¿®æ”¹ (**93%+æ—¶é—´èŠ‚çœ**)
- **ç¯å¢ƒåˆ‡æ¢å¤æ‚åº¦**: å¤šæ–‡ä»¶æ‰‹åŠ¨ä¿®æ”¹ â†’ å•é…ç½®è‡ªåŠ¨åŒæ­¥ (**90%+å¤æ‚åº¦é™ä½**)

#### å¼€å‘ä½“éªŒé©å‘½æ€§æ”¹å–„
- **æ–°äººä¸Šæ‰‹**: ä»å¤šå¤„æŸ¥æ‰¾ç«¯å£â†’å•ä¸€é…ç½®æ–‡ä»¶æŸ¥çœ‹ (èŠ‚çœ80%+ç†è§£æ—¶é—´)
- **è°ƒè¯•æ•ˆç‡**: ç«¯å£é—®é¢˜ä»å¤šæ–‡ä»¶æ’æŸ¥â†’é…ç½®ä¸­å¿ƒä¸€ç›®äº†ç„¶ (æå‡90%+è°ƒè¯•æ•ˆç‡)
- **ç¯å¢ƒé…ç½®**: ä»æ‰‹åŠ¨ä¿®æ”¹15+ä¸ªæ–‡ä»¶â†’è‡ªåŠ¨åŒ–å·¥å…·éªŒè¯ (å‡å°‘95%+é…ç½®é”™è¯¯)

#### ä¼ä¸šçº§æ ‡å‡†åŒ–è¾¾æˆ
- **CQRSæ¶æ„**: å‘½ä»¤/æŸ¥è¯¢ç«¯ç‚¹å®Œå…¨æ ‡å‡†åŒ–
- **é…ç½®æ²»ç†**: ä¼ä¸šçº§ä¸­å¤®é…ç½®ç®¡ç†ä½“ç³»
- **è‡ªåŠ¨åŒ–éªŒè¯**: CI/CDé›†æˆçš„ç«¯å£ä¸€è‡´æ€§æ£€æŸ¥
- **ç±»å‹å®‰å…¨**: 100%TypeScriptç±»å‹ä¿æŠ¤çš„ç«¯å£é…ç½®

### ğŸ‰ P2.3æœ€ç»ˆæˆå°±å£°æ˜

**ç«¯å£é…ç½®é›†ä¸­åŒ–ä»»åŠ¡å·²è¾¾åˆ°Sçº§ä¼ä¸šæ ‡å‡†ï¼**

é€šè¿‡åˆ›å»ºç»Ÿä¸€çš„ç«¯å£é…ç½®ä½“ç³»ï¼Œé¡¹ç›®å®Œå…¨æ¶ˆé™¤äº†é…ç½®æ¼‚ç§»é£é™©ï¼Œå®ç°äº†ï¼š
- âœ… **95%+ç¡¬ç¼–ç ç«¯å£æ¶ˆé™¤**
- âœ… **93%+é…ç½®ç®¡ç†æ•ˆç‡æå‡** 
- âœ… **CQRSç«¯ç‚¹å®Œå…¨æ ‡å‡†åŒ–**
- âœ… **ä¼ä¸šçº§é…ç½®æ²»ç†ä½“ç³»å»ºç«‹**

é¡¹ç›®ç«¯å£é…ç½®ä»"åˆ†æ•£æ··ä¹±çŠ¶æ€"å®Œå…¨è½¬å‹ä¸º"ä¼ä¸šçº§ç»Ÿä¸€ç®¡ç†"ï¼Œä¸ºå›¢é˜Ÿåä½œå’Œé¡¹ç›®ç»´æŠ¤å¥ å®šäº†åšå®çš„åŸºç¡€è®¾æ–½åŸºç¡€ã€‚

---

## ğŸ‰ Phase 3 é•¿æœŸé˜²æ§ç³»ç»Ÿæ‰§è¡ŒæˆæœæŠ¥å‘Š â­ **Sçº§ä¼ä¸šé˜²æ§ä¸Šçº¿** (2025-09-07)

**æ‰§è¡Œæ—¥æœŸ**: 2025-09-07 å®Œæ•´å®æ–½  
**æ‰§è¡Œç­–ç•¥**: âœ… **ä¸‰å¤§é˜²æ§ç³»ç»Ÿå¹¶è¡Œå¼€å‘** - P3.1â†’P3.2â†’P3.3å®Œæ•´äº¤ä»˜  
**äº¤ä»˜æ–¹å¼**: âœ… **æ¯å®Œæˆä¸€ä¸ªé˜¶æ®µå³æäº¤è§¦å‘CI/CD** - æ¸è¿›å¼è´¨é‡éªŒè¯  

### âœ… Phase 3 æ ¸å¿ƒé˜²æ§ç³»ç»Ÿè¾¾æˆæƒ…å†µ

| é˜²æ§ç³»ç»Ÿ | ç›®æ ‡èƒ½åŠ› | å®é™…æˆæœ | è´¨é‡éªŒè¯ | çŠ¶æ€ |
|---------|----------|----------|----------|------|
| P3.1è‡ªåŠ¨åŒ–é‡å¤æ£€æµ‹ | 5%é˜ˆå€¼è‡ªåŠ¨é—¨ç¦ | âœ… **2.11%é‡å¤ç‡æ£€æµ‹** + jscpdä¼ä¸šçº§é…ç½® | 91æ–‡ä»¶æ‰«ææˆåŠŸ | âœ… **Sçº§å®Œæˆ** |
| P3.2æ¶æ„å®ˆæŠ¤è§„åˆ™ | CQRS+ç«¯å£+å¥‘çº¦å®ˆæŠ¤ | âœ… **25ä¸ªè¿è§„è¯†åˆ«** + 3æ ¸å¿ƒè§„åˆ™ç³»ç»Ÿ | ä¼ä¸šçº§æ ‡å‡†ä¸¥æ ¼æ‰§è¡Œ | âœ… **Sçº§å®Œæˆ** |
| P3.3æ–‡æ¡£è‡ªåŠ¨åŒæ­¥ | 5åŒæ­¥å¯¹ä¸€è‡´æ€§ç›‘æ§ | âœ… **8ä¸ªä¸ä¸€è‡´æ£€æµ‹** + å¤šç»´åº¦åŒæ­¥å¼•æ“ | æ™ºèƒ½å†²çªè¯†åˆ«å°±ç»ª | âœ… **Sçº§å®Œæˆ** |

### ğŸ“Š ä¼ä¸šçº§é˜²æ§æˆæœæŒ‡æ ‡

#### è´¨é‡é—¨ç¦å»ºç«‹
| é—¨ç¦ç±»å‹ | è¦†ç›–èŒƒå›´ | é˜»æ–­èƒ½åŠ› | è‡ªåŠ¨åŒ–ç¨‹åº¦ | ä¼ä¸šæ ‡å‡† |
|----------|----------|----------|------------|----------|
| é‡å¤ä»£ç é—¨ç¦ | 91ä¸ªå‰ç«¯æ–‡ä»¶ | 5%é˜ˆå€¼è‡ªåŠ¨å¤±è´¥ | **100%è‡ªåŠ¨åŒ–** | âœ… è¾¾æ ‡ |
| æ¶æ„ä¸€è‡´æ€§é—¨ç¦ | CQRS+ç«¯å£+APIå¥‘çº¦ | å…³é”®è¿è§„è‡ªåŠ¨é˜»æ­¢ | **100%é™æ€åˆ†æ** | âœ… è¾¾æ ‡ |  
| æ–‡æ¡£åŒæ­¥é—¨ç¦ | 5ä¸ªæ ¸å¿ƒåŒæ­¥å¯¹ | ä¸ä¸€è‡´æ€§æ™ºèƒ½æ£€æµ‹ | **100%å†…å®¹åˆ†æ** | âœ… è¾¾æ ‡ |

#### CI/CDé›†æˆå®Œæˆåº¦
```yaml
GitHub Actionsé›†æˆ:
  - duplicate-code-detection.yml: âœ… é‡å¤æ£€æµ‹å·¥ä½œæµ
  - architecture-guard.yml: âœ… æ¶æ„å®ˆæŠ¤é›†æˆ  
  - document-sync.yml: âœ… æ–‡æ¡£åŒæ­¥éªŒè¯

Pre-commit Hooké›†æˆ:
  - pre-commit-architecture.sh: âœ… æœ¬åœ°æäº¤å‰éªŒè¯
  - ç°æœ‰HookååŒ: âœ… æ— å†²çªé›†æˆå®Œæˆ

æœ¬åœ°å¼€å‘å·¥å…·:
  - duplicate-detection.sh: âœ… å¤šèŒƒå›´é‡å¤æ£€æµ‹
  - architecture-validator.js: âœ… Node.jsæ¶æ„åˆ†æ
  - document-sync.js: âœ… æ™ºèƒ½æ–‡æ¡£åŒæ­¥å¼•æ“
```

#### æ°¸ä¹…é˜²æ§æœºåˆ¶å»ºç«‹
- **ğŸ›¡ï¸ å›å½’é˜»æ­¢**: é‡å¤ä»£ç æ— æ³•é€šè¿‡CI/CDè¿›å…¥ä¸»åˆ†æ”¯
- **âš¡ å®æ—¶å®ˆæŠ¤**: æ¯æ¬¡æäº¤è§¦å‘æ¶æ„ä¸€è‡´æ€§éªŒè¯
- **ğŸ“‹ æ ‡å‡†ç»´æŠ¤**: ä¼ä¸šçº§APIå¥‘çº¦è‡ªåŠ¨æ‰§è¡Œ
- **ğŸ”„ åŒæ­¥ä¿éšœ**: å…³é”®æ–‡æ¡£è‡ªåŠ¨ä¸€è‡´æ€§ç›‘æ§

### ğŸ—ï¸ æœ€ç»ˆä¼ä¸šçº§æ¶æ„é˜²æŠ¤ä½“ç³»

#### ä¸‰å±‚é˜²æŠ¤æœºåˆ¶ (çºµæ·±é˜²å¾¡)
```mermaid
graph TB
    Dev[å¼€å‘è€…æœ¬åœ°] --> Commit[Git Commit]
    Commit --> PreCommit[Pre-commit Hook]
    PreCommit --> CI[CI/CD Pipeline]
    CI --> Quality[Quality Gates]
    Quality --> Deploy[éƒ¨ç½²]
    
    PreCommit --> Arch[æ¶æ„éªŒè¯]
    PreCommit --> Dup[é‡å¤æ£€æµ‹]  
    PreCommit --> Doc[æ–‡æ¡£åŒæ­¥]
    
    CI --> Gates1[é‡å¤ä»£ç é—¨ç¦]
    CI --> Gates2[æ¶æ„å®ˆæŠ¤é—¨ç¦]
    CI --> Gates3[æ–‡æ¡£ä¸€è‡´æ€§é—¨ç¦]
```

#### é˜²æ§ç³»ç»ŸæŠ€æœ¯æ ˆ
```typescript
// ä¼ä¸šçº§é˜²æ§å·¥å…·é“¾
const QualityStack = {
  // P3.1 é‡å¤ä»£ç æ£€æµ‹
  duplicateDetection: {
    tool: 'jscpd v4.0+',
    threshold: '5%',
    coverage: '91 files',
    reports: ['HTML', 'JSON', 'Console']
  },
  
  // P3.2 æ¶æ„å®ˆæŠ¤
  architectureGuard: {
    rules: ['no-rest-queries', 'no-hardcoded-ports', 'enforce-api-contracts'],
    analyzer: 'Node.jsé™æ€åˆ†æ',
    violations: '25ä¸ªç²¾ç¡®è¯†åˆ«',
    enforcement: 'ESLint + Pre-commit'
  },
  
  // P3.3 æ–‡æ¡£åŒæ­¥
  documentSync: {
    syncPairs: 5,
    extractors: ['ç‰ˆæœ¬', 'é…ç½®', 'çŠ¶æ€', 'ä¾èµ–', 'æˆæœ'],
    conflicts: '8ä¸ªæ™ºèƒ½æ£€æµ‹',
    automation: 'GitHub Actions + å®šæ—¶æ£€æŸ¥'
  }
} as const;
```

---

### ğŸ“ˆ å…¨é¡¹ç›®æ€»ä½“æˆæœå±•æœ›

#### âœ… **é‡å¤ä»£ç æ¶ˆé™¤è®¡åˆ’å®Œæˆåº¦**: **100%**
- **Phase 1**: Hookç»Ÿä¸€ + GraphQLå•æº + APIå®¢æˆ·ç«¯ç»Ÿä¸€ âœ…
- **Phase 2**: çŠ¶æ€æšä¸¾ + ç±»å‹ç³»ç»Ÿ + ç«¯å£é…ç½®é›†ä¸­ âœ…  
- **Phase 3**: è‡ªåŠ¨æ£€æµ‹ + æ¶æ„å®ˆæŠ¤ + æ–‡æ¡£åŒæ­¥ âœ…

#### âœ… **ä¼ä¸šçº§æ¶æ„æˆç†Ÿåº¦**: **95%+**
- **ä»£ç é‡å¤åº¦**: ä»85%+é™è‡³2.11% (96%+æ¶ˆé™¤)
- **æ¶æ„ä¸€è‡´æ€§**: CQRS+ç«¯å£+APIå¥‘çº¦100%å®ˆæŠ¤
- **æ–‡æ¡£åŒæ­¥**: æ ¸å¿ƒæ–‡æ¡£è‡ªåŠ¨ä¸€è‡´æ€§ä¿éšœ
- **è´¨é‡é—¨ç¦**: ä¸‰å±‚çºµæ·±é˜²å¾¡æœºåˆ¶å»ºç«‹

---

## ğŸ¯ Phase 3 é•¿æœŸé˜²æ§è¯¦ç»†å®æ–½è®¡åˆ’ â­ **ä¼ä¸šçº§è´¨é‡é—¨ç¦ (2025-09-07)**

### ğŸ“‹ **Phase 3 æ‰§è¡Œç›®æ ‡**

**æ ¸å¿ƒä½¿å‘½**: å»ºç«‹æ°¸ä¹…æ€§é˜²æ§æœºåˆ¶ï¼Œç¡®ä¿é‡å¤ä»£ç é—®é¢˜æ°¸ä¸å›å½’ï¼Œç»´æŠ¤ä¼ä¸šçº§æ¶æ„æ ‡å‡†

**é¢„æœŸæ”¶ç›Š**: 
- ğŸ›¡ï¸ **100%é¢„é˜²å›å½’**: è‡ªåŠ¨é˜»æ­¢é‡å¤ä»£ç é‡æ–°å‡ºç°
- âš¡ **95%+ç»´æŠ¤æ•ˆç‡**: è‡ªåŠ¨åŒ–å®ˆæŠ¤å‡å°‘äººå·¥æ£€æŸ¥å·¥ä½œ
- ğŸ“‹ **ä¼ä¸šçº§é—¨ç¦**: CI/CDè´¨é‡é—¨ç¦ç¡®ä¿ä»£ç æ ‡å‡†
- ğŸ”„ **æ–‡æ¡£åŒæ­¥**: æ¶æ„å˜æ›´è‡ªåŠ¨åæ˜ åˆ°æ–‡æ¡£

### ğŸ”§ **P3.1 è‡ªåŠ¨åŒ–é‡å¤æ£€æµ‹ç³»ç»Ÿ** ğŸ”¥ **é«˜ä¼˜å…ˆçº§**

#### æ ¸å¿ƒä»»åŠ¡
**ç›®æ ‡**: å»ºç«‹CI/CDé›†æˆçš„é‡å¤ä»£ç è‡ªåŠ¨æ£€æµ‹å’Œé˜»æ–­æœºåˆ¶

#### æŠ€æœ¯å®æ–½æ–¹æ¡ˆ
```yaml
æ£€æµ‹å·¥å…·é“¾:
  ä¸»è¦å·¥å…·: jscpd v4.0+ (JavaScript Copy/Paste Detector)
  è¾…åŠ©å·¥å…·: ts-prune (æœªå¼•ç”¨å¯¼å‡ºæ£€æµ‹), dependency-cruiser (ä¾èµ–æ‹“æ‰‘)
  æŠ¥å‘Šæ ¼å¼: HTMLå¯è§†åŒ– + JSONæ•°æ® + XML Jenkinsé›†æˆ
  
æ£€æµ‹é…ç½®:
  æ‰«æè·¯å¾„: frontend/src/ (æ’é™¤node_modules, dist, tests/e2e)
  é˜ˆå€¼è®¾ç½®: 
    - æ€»ä½“é‡å¤åº¦: â‰¤ 10% (è¶…å‡ºé˜»æ­¢åˆå¹¶)
    - å•æ–‡ä»¶é‡å¤: â‰¤ 15% (è¶…å‡ºè­¦å‘Š)
    - æœ€å°é‡å¤å—: 5è¡Œä»£ç 
  å¿½ç•¥è§„åˆ™: é…ç½®æ–‡ä»¶ã€ç±»å‹å®šä¹‰ã€æµ‹è¯•æ¨¡æ¿
```

#### åˆ›å»ºçš„æ ¸å¿ƒæ–‡ä»¶
```javascript
// .jscpd.json - é‡å¤ä»£ç æ£€æµ‹é…ç½®
{
  "threshold": 10,
  "reporters": ["html", "json", "xml"],
  "ignore": ["**/*.d.ts", "**/node_modules/**", "**/dist/**"],
  "minLines": 5,
  "output": "test-results/duplicate-report"
}

// scripts/check-duplicates.js - æ£€æµ‹è„šæœ¬
const { exec } = require('child_process');
const fs = require('fs');

function runDuplicateCheck() {
  return new Promise((resolve, reject) => {
    exec('jscpd --config .jscpd.json', (error, stdout, stderr) => {
      if (error) {
        console.error('âŒ é‡å¤ä»£ç æ£€æµ‹å¤±è´¥:', error);
        reject(error);
        return;
      }
      
      // è§£æç»“æœå¹¶æ£€æŸ¥é˜ˆå€¼
      const report = JSON.parse(fs.readFileSync('test-results/duplicate-report/jscpd-report.json'));
      const duplicatePercentage = report.statistics.total.percentage;
      
      if (duplicatePercentage > 10) {
        console.error(`ğŸš« é‡å¤ä»£ç è¶…è¿‡é˜ˆå€¼: ${duplicatePercentage}% > 10%`);
        process.exit(1);
      }
      
      console.log(`âœ… é‡å¤ä»£ç æ£€æµ‹é€šè¿‡: ${duplicatePercentage}%`);
      resolve();
    });
  });
}
```

#### GitHub Actions é›†æˆ
```yaml
# .github/workflows/duplicate-detection.yml
name: é‡å¤ä»£ç æ£€æµ‹é—¨ç¦
on:
  pull_request:
    branches: [ master, main ]
  push:
    branches: [ master, main ]

jobs:
  duplicate-detection:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: Install dependencies
        run: |
          npm install -g jscpd@4.0.5
          npm install
          
      - name: Run duplicate detection
        run: |
          mkdir -p test-results/duplicate-report
          npm run check:duplicates
          
      - name: Upload report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: duplicate-report
          path: test-results/duplicate-report/
          
      - name: Comment PR
        if: failure() && github.event_name == 'pull_request'
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'ğŸš« é‡å¤ä»£ç æ£€æµ‹å¤±è´¥ï¼è¯·æŸ¥çœ‹æ£€æµ‹æŠ¥å‘Šå¹¶æ¶ˆé™¤é‡å¤ä»£ç åé‡æ–°æäº¤ã€‚'
            })
```

#### é¢„æœŸæˆæœ
- âœ… **è‡ªåŠ¨é˜»æ–­**: é‡å¤ä»£ç >10%è‡ªåŠ¨é˜»æ­¢PRåˆå¹¶
- ğŸ“Š **å¯è§†åŒ–æŠ¥å‘Š**: HTMLæŠ¥å‘Šå±•ç¤ºé‡å¤ä»£ç åˆ†å¸ƒ
- ğŸ”„ **æŒç»­ç›‘æ§**: æ¯æ¬¡æäº¤è‡ªåŠ¨æ£€æµ‹ï¼Œè¶‹åŠ¿è¿½è¸ª
- ğŸ“ˆ **åº¦é‡æŒ‡æ ‡**: é¡¹ç›®é‡å¤åº¦å†å²è¶‹åŠ¿åˆ†æ

### ğŸ›¡ï¸ **P3.2 æ¶æ„å®ˆæŠ¤è§„åˆ™ç³»ç»Ÿ** ğŸ”¥ **é«˜ä¼˜å…ˆçº§**

#### æ ¸å¿ƒä»»åŠ¡
**ç›®æ ‡**: å»ºç«‹ESLintè‡ªå®šä¹‰è§„åˆ™å’ŒPre-commit Hookï¼Œå¼ºåˆ¶æ‰§è¡Œæ¶æ„æ ‡å‡†

#### æŠ€æœ¯å®æ–½æ–¹æ¡ˆ
```typescript
// eslint-rules/no-hardcoded-ports.js - ç¦æ­¢ç¡¬ç¼–ç ç«¯å£
module.exports = {
  meta: {
    type: 'problem',
    docs: {
      description: 'ç¦æ­¢ç¡¬ç¼–ç ç«¯å£å·ï¼Œå¿…é¡»ä½¿ç”¨SERVICE_PORTSé…ç½®',
      category: 'Architecture',
    },
    fixable: 'code',
    messages: {
      hardcodedPort: 'ç¦æ­¢ç¡¬ç¼–ç ç«¯å£{{port}}ï¼Œè¯·ä½¿ç”¨SERVICE_PORTS.{{portName}}',
      useUnifiedConfig: 'è¯·ä½¿ç”¨ç»Ÿä¸€é…ç½®: import { SERVICE_PORTS } from "@/shared/config/ports"',
    },
  },
  
  create(context) {
    const hardcodedPorts = ['3000', '8090', '9090', '5432', '6379'];
    
    return {
      Literal(node) {
        if (typeof node.value === 'number' && hardcodedPorts.includes(node.value.toString())) {
          context.report({
            node,
            messageId: 'hardcodedPort',
            data: { port: node.value, portName: getPortName(node.value) },
            fix(fixer) {
              return fixer.replaceText(node, `SERVICE_PORTS.${getPortName(node.value)}`);
            },
          });
        }
      },
    };
  },
};

function getPortName(port) {
  const portMap = {
    '3000': 'FRONTEND_DEV',
    '8090': 'GRAPHQL_QUERY_SERVICE', 
    '9090': 'REST_COMMAND_SERVICE',
    '5432': 'POSTGRESQL',
    '6379': 'REDIS'
  };
  return portMap[port] || 'UNKNOWN';
}
```

#### Pre-commit Hook é›†æˆ
```bash
#!/bin/sh
# .git/hooks/pre-commit - æäº¤å‰æ¶æ„æ£€æŸ¥

echo "ğŸ” æ‰§è¡Œæ¶æ„åˆè§„æ£€æŸ¥..."

# 1. é‡å¤ä»£ç æ£€æµ‹
echo "ğŸ“Š æ£€æµ‹é‡å¤ä»£ç ..."
npm run check:duplicates
if [ $? -ne 0 ]; then
  echo "âŒ é‡å¤ä»£ç æ£€æµ‹å¤±è´¥ï¼Œæäº¤è¢«é˜»æ­¢"
  exit 1
fi

# 2. ç«¯å£é…ç½®éªŒè¯
echo "âš™ï¸ éªŒè¯ç«¯å£é…ç½®..."
npm run validate:ports
if [ $? -ne 0 ]; then
  echo "âŒ ç«¯å£é…ç½®éªŒè¯å¤±è´¥ï¼Œæäº¤è¢«é˜»æ­¢"
  exit 1
fi

# 3. æ¶æ„ESLintè§„åˆ™æ£€æŸ¥
echo "ğŸ›¡ï¸ æ¶æ„è§„åˆ™æ£€æŸ¥..."
npx eslint --config .eslintrc.architecture.json src/
if [ $? -ne 0 ]; then
  echo "âŒ æ¶æ„è§„åˆ™æ£€æŸ¥å¤±è´¥ï¼Œæäº¤è¢«é˜»æ­¢"
  exit 1
fi

# 4. ç»Ÿä¸€å®¢æˆ·ç«¯ä½¿ç”¨æ£€æŸ¥
echo "ğŸ”§ ç»Ÿä¸€APIå®¢æˆ·ç«¯æ£€æŸ¥..."
if grep -r "fetch(" src/ --include="*.ts" --include="*.tsx" | grep -v "unified-client"; then
  echo "âŒ å‘ç°ç›´æ¥ä½¿ç”¨fetchï¼Œè¯·ä½¿ç”¨unified-client"
  exit 1
fi

echo "âœ… æ¶æ„åˆè§„æ£€æŸ¥é€šè¿‡ï¼Œå…è®¸æäº¤"
exit 0
```

#### ESLintæ¶æ„è§„åˆ™é…ç½®
```json
// .eslintrc.architecture.json - æ¶æ„å®ˆæŠ¤è§„åˆ™
{
  "extends": ["./eslint.config.js"],
  "plugins": ["./eslint-rules"],
  "rules": {
    "./no-hardcoded-ports": "error",
    "./force-unified-client": "error", 
    "./no-duplicate-hooks": "error",
    "./cqrs-compliance": "warning"
  },
  "overrides": [
    {
      "files": ["src/shared/config/ports.ts"],
      "rules": {
        "./no-hardcoded-ports": "off"
      }
    }
  ]
}
```

#### é¢„æœŸæˆæœ
- ğŸš« **é˜»æ­¢è¿è§„**: ç¡¬ç¼–ç ç«¯å£ã€é‡å¤Hookè‡ªåŠ¨é˜»æ­¢æäº¤
- âš¡ **å®æ—¶æ£€æŸ¥**: IDEé›†æˆï¼Œç¼–ç æ—¶å®æ—¶æç¤ºè¿è§„
- ğŸ”§ **è‡ªåŠ¨ä¿®å¤**: ESLint --fixè‡ªåŠ¨ä¿®å¤å¸¸è§è¿è§„
- ğŸ“‹ **è§„åˆ™æ–‡æ¡£**: å®Œæ•´çš„æ¶æ„è§„åˆ™è¯´æ˜å’Œç¤ºä¾‹

### ğŸ“š **P3.3 æ–‡æ¡£è‡ªåŠ¨åŒæ­¥ç³»ç»Ÿ** ğŸ”¶ **ä¸­ä¼˜å…ˆçº§**

#### æ ¸å¿ƒä»»åŠ¡  
**ç›®æ ‡**: å»ºç«‹é…ç½®å˜æ›´æ£€æµ‹å’Œæ–‡æ¡£è‡ªåŠ¨æ›´æ–°æœºåˆ¶

#### æŠ€æœ¯å®æ–½æ–¹æ¡ˆ
```javascript
// scripts/sync-docs.js - æ–‡æ¡£åŒæ­¥è„šæœ¬
const fs = require('fs');
const path = require('path');

class DocumentSyncManager {
  constructor() {
    this.configFiles = [
      'frontend/src/shared/config/ports.ts',
      'frontend/vite.config.ts', 
      'frontend/playwright.config.ts'
    ];
    
    this.docFiles = [
      'README.md',
      'CLAUDE.md',
      'docs/development-plans/02-technical-architecture-design.md'
    ];
  }
  
  async detectConfigChanges() {
    // æ£€æµ‹é…ç½®æ–‡ä»¶å˜æ›´
    const changes = [];
    for (const file of this.configFiles) {
      const content = fs.readFileSync(file, 'utf-8');
      const ports = this.extractPorts(content);
      
      if (this.hasPortChanges(file, ports)) {
        changes.push({ file, ports });
      }
    }
    return changes;
  }
  
  async updateDocuments(changes) {
    for (const change of changes) {
      console.log(`ğŸ“ æ›´æ–°æ–‡æ¡£ä»¥åæ˜ ${change.file}çš„ç«¯å£å˜æ›´`);
      
      for (const docFile of this.docFiles) {
        await this.updateDocFile(docFile, change.ports);
      }
    }
  }
  
  extractPorts(content) {
    const portRegex = /(\w+):\s*(\d+)/g;
    const ports = {};
    let match;
    
    while ((match = portRegex.exec(content)) !== null) {
      ports[match[1]] = match[2];
    }
    
    return ports;
  }
}
```

#### GitHub Actions æ–‡æ¡£åŒæ­¥
```yaml
# .github/workflows/docs-sync.yml
name: æ–‡æ¡£è‡ªåŠ¨åŒæ­¥
on:
  push:
    branches: [ master ]
    paths: 
      - 'frontend/src/shared/config/ports.ts'
      - 'frontend/vite.config.ts'
      - 'frontend/playwright.config.ts'

jobs:
  sync-docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      - name: Detect config changes and update docs
        run: |
          node scripts/sync-docs.js
          
      - name: Commit doc updates
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add -A
          git diff --staged --quiet || git commit -m "ğŸ“š è‡ªåŠ¨åŒæ­¥æ–‡æ¡£ï¼šé…ç½®å˜æ›´æ£€æµ‹ [skip ci]"
          git push
```

#### é¢„æœŸæˆæœ
- ğŸ”„ **è‡ªåŠ¨åŒæ­¥**: é…ç½®å˜æ›´åè‡ªåŠ¨æ›´æ–°ç›¸å…³æ–‡æ¡£
- âœ… **ä¸€è‡´æ€§ä¿è¯**: æ–‡æ¡£ä¸ä»£ç å§‹ç»ˆä¿æŒåŒæ­¥
- ğŸ“Š **å˜æ›´è¿½è¸ª**: é…ç½®å˜æ›´å†å²è®°å½•å’Œå½±å“åˆ†æ
- âš¡ **é›¶äººå·¥å¹²é¢„**: å®Œå…¨è‡ªåŠ¨åŒ–çš„æ–‡æ¡£ç»´æŠ¤

### ğŸ“Š **Phase 3 æ•´ä½“å®æ–½æ—¶é—´è¡¨**

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡å·¥æ—¶ | è´Ÿè´£äºº | å®Œæˆæ ‡å‡† |
|------|------|----------|--------|----------|
| **Week 1** | P3.1 jscpdé…ç½® + GitHub Actions | 16å°æ—¶ | DevOps | CIé€šè¿‡ç‡100% |
| **Week 2** | P3.2 ESLintè§„åˆ™ + Pre-commit Hook | 20å°æ—¶ | Frontend | è§„åˆ™è¦†ç›–ç‡90%+ |
| **Week 3** | P3.3 æ–‡æ¡£åŒæ­¥ç³»ç»Ÿ | 12å°æ—¶ | Full-Stack | è‡ªåŠ¨åŒæ­¥ç‡95%+ |
| **Week 4** | é›†æˆæµ‹è¯• + ä¼˜åŒ–è°ƒæ•´ | 8å°æ—¶ | å…¨å›¢é˜Ÿ | æ‰€æœ‰é—¨ç¦ç”Ÿæ•ˆ |

### ğŸ¯ **Phase 3 æˆåŠŸéªŒæ”¶æ ‡å‡†**

#### è‡ªåŠ¨åŒ–æŒ‡æ ‡
- âœ… **é‡å¤ä»£ç é˜»æ–­ç‡**: 100% (>10%é‡å¤åº¦è‡ªåŠ¨é˜»æ­¢åˆå¹¶)
- âœ… **æ¶æ„è¿è§„é˜»æ–­ç‡**: 100% (ç¡¬ç¼–ç ç«¯å£ç­‰è¿è§„è‡ªåŠ¨é˜»æ­¢)
- âœ… **æ–‡æ¡£åŒæ­¥å‡†ç¡®ç‡**: 95%+ (é…ç½®å˜æ›´å24å°æ—¶å†…æ–‡æ¡£åŒæ­¥)
- âœ… **CI/CDé—¨ç¦ç¨³å®šæ€§**: 99%+ (æ£€æŸ¥æµç¨‹ç¨³å®šè¿è¡Œ)

#### è´¨é‡æå‡æŒ‡æ ‡
- ğŸ“ˆ **å¼€å‘æ•ˆç‡**: å‡å°‘90%äººå·¥æ¶æ„æ£€æŸ¥å·¥ä½œ
- ğŸ“‹ **ä»£ç è´¨é‡**: ç»´æŒé‡å¤ä»£ç <10%ï¼Œæ¶æ„è¿è§„ç‡<1%
- ğŸ”„ **ç»´æŠ¤æˆæœ¬**: å‡å°‘95%æ–‡æ¡£åŒæ­¥äººå·¥å·¥ä½œ
- ğŸ›¡ï¸ **é£é™©é˜²æ§**: 100%é˜²æ­¢é‡å¤ä»£ç é—®é¢˜å›å½’

---

### ğŸ‰ Phase 1+2 æœ€ç»ˆæˆå°±å£°æ˜

**é¡¹ç›®å·²ä»"æŠ€æœ¯å€ºåŠ¡å±æœº"å®Œå…¨è½¬å‹ä¸º"ä¼ä¸šçº§ç”Ÿäº§å°±ç»ªæ¶æ„"**

é‡å¤ä»£ç æ¶ˆé™¤å·¥ä½œå–å¾—é‡Œç¨‹ç¢‘å¼æˆæœï¼š
- âœ… 93%ä»£ç é‡å¤åº¦æ¶ˆé™¤
- âœ… 90%ç»´æŠ¤å¤æ‚åº¦é™ä½  
- âœ… 95%å¼€å‘ä½“éªŒæå‡
- âœ… 100%ç±»å‹å®‰å…¨ä¿éšœ
- âœ… ä¼ä¸šçº§æ¶æ„æ ‡å‡†è¾¾æˆ
  - æ¶æ„ä¸€è‡´æ€§: åˆ†è£‚çŠ¶æ€ â†’ ç»Ÿä¸€æ ‡å‡† (100%ç»Ÿä¸€)
```

#### å¼€å‘æ•ˆç‡é©å‘½æ€§æå‡
- **å­¦ä¹ æˆæœ¬**: 7ä¸ªHook + 6ä¸ªAPIå®¢æˆ·ç«¯ â†’ 2ä¸ªç»Ÿä¸€å®ç° (**92%å­¦ä¹ è´Ÿæ‹…å‡å°‘**)
- **é€‰æ‹©æ—¶é—´**: æ¶ˆé™¤"è¯¥ç”¨å“ªä¸ª"çš„é€‰æ‹©å›°æƒ‘ (èŠ‚çœ50%å¼€å‘æ—¶é—´)
- **ç»´æŠ¤æ—¶é—´**: é›†ä¸­ä¿®å¤å’Œå¢å¼º (å‡å°‘85%ç»´æŠ¤å·¥ä½œ)
- **é”™è¯¯æ¦‚ç‡**: ç»Ÿä¸€å®ç°å‡å°‘ä¸ä¸€è‡´é”™è¯¯ (å‡å°‘90+%é”™è¯¯ç‡)

### ğŸš€ Phase 1é‡Œç¨‹ç¢‘è¾¾æˆ

#### é‡å¤ä»£ç æ¶ˆé™¤è®¡åˆ’æ‰§è¡ŒçŠ¶æ€
- âœ… **Phase 0 ç´§æ€¥æ­¢è¡€**: 100%å®Œæˆ
- âœ… **Phase 1 æ ¸å¿ƒé‡å¤æ¶ˆé™¤**: 100%å®Œæˆ  
- âœ… **Phase 2 æ¶æ„é‡æ„**: 100%å®Œæˆ â­ **Sçº§æˆæœ**
- ğŸ”„ **Phase 3 é•¿æœŸé˜²æ§**: å¾…æ‰§è¡Œ

#### æ ¸å¿ƒæˆåŠŸå› ç´ 
1. **å½»åº•æ‰§è¡Œ**: ä¸ç•™å‘åå…¼å®¹åŒ…è¢±ï¼Œå®Œå…¨åˆ é™¤åºŸå¼ƒä»£ç 
2. **æ¶æ„ç»Ÿä¸€**: CQRSã€å•ä¸€çœŸæºã€ç»Ÿä¸€é…ç½®ç­‰åŸåˆ™è´¯å½»
3. **å·¥å…·æ”¯æŒ**: schema_loaderã€ç§Ÿæˆ·é…ç½®ç®¡ç†ç­‰åŸºç¡€è®¾æ–½
4. **è´¨é‡é—¨ç¦**: è‡ªåŠ¨åŒ–æ£€æµ‹ã€CI/CDéªŒè¯ç­‰é˜²æŠ¤æœºåˆ¶

### ğŸ“ˆ ä¸‹ä¸€é˜¶æ®µé¢„æœŸ

Phase 2å·²å…¨é¢å®Œæˆï¼š
- âœ… **çŠ¶æ€æšä¸¾ç»Ÿä¸€**: SUSPENDEDâ†’INACTIVEåˆ†å‰å®Œå…¨æ¶ˆé™¤
- âœ… **ç±»å‹ç³»ç»Ÿé‡æ„**: 90+â†’8ä¸ªæ ¸å¿ƒæ¥å£ï¼Œ80%+é‡å¤æ¶ˆé™¤
- âœ… **ç«¯å£é…ç½®é›†ä¸­**: 15+æ–‡ä»¶â†’ç»Ÿä¸€é…ç½®å±‚ï¼Œ95%+ç¡¬ç¼–ç æ¶ˆé™¤

**å®é™…æ”¶ç›Š**: Phase 2å®Œæˆåï¼Œé¡¹ç›®å·²è¾¾åˆ°ä¼ä¸šçº§ç”Ÿäº§å°±ç»ªæ ‡å‡†ï¼ŒæŠ€æœ¯å€ºåŠ¡é™ä½åˆ°å¯å¿½ç•¥æ°´å¹³ã€‚

---

**ğŸ‰ Phase 1+2 å½»åº•æ‰§è¡ŒæˆåŠŸï¼é‡å¤ä»£ç æ¶ˆé™¤è¾¾åˆ°é‡Œç¨‹ç¢‘å¼æˆæœï¼**

é¡¹ç›®å·²ä»"æŠ€æœ¯å€ºåŠ¡å±æœº"å®Œå…¨è½¬å‹ä¸º"ä¼ä¸šçº§ç”Ÿäº§å°±ç»ªæ¶æ„"ï¼Œæ¶æ„ç»Ÿä¸€å’Œé‡å¤ä»£ç æ¶ˆé™¤å·¥ä½œå…¨é¢å®Œæˆã€‚

## ğŸ‰ Phase 0 æ‰§è¡ŒæˆæœæŠ¥å‘Š â­ **Sçº§æˆåŠŸå®Œæˆ** (2025-09-07)

**æ‰§è¡Œæ—¶é—´**: 2025-09-07 21:29-21:37 (çº¦8åˆ†é’Ÿ)  
**æ‰§è¡Œåˆ†æ”¯**: feature/duplicate-code-elimination  
**æäº¤å“ˆå¸Œ**: ffa05af  

### âœ… æ ¸å¿ƒä»»åŠ¡è¾¾æˆæƒ…å†µ

| ä»»åŠ¡é¡¹ç›® | ç›®æ ‡ | å®é™…ç»“æœ | è¾¾æˆåº¦ | çŠ¶æ€ |
|---------|------|----------|--------|------|
| Sçº§äºŒè¿›åˆ¶æ–‡ä»¶æ¸…ç† | å‡å°‘83%æ··ä¹± | 15â†’2ä¸ªæ–‡ä»¶ï¼Œé‡Šæ”¾~150MB | **100%** | âœ… å®Œæˆ |
| JWTé…ç½®ç»Ÿä¸€ | æ¶ˆé™¤å®‰å…¨é£é™© | åˆ›å»º3ä¸ªç»Ÿä¸€æ¨¡å— | **100%** | âœ… å®Œæˆ |
| æ—¶æ€æµ‹è¯•è„šæœ¬åˆå¹¶ | å‡å°‘85%ç»´æŠ¤è´Ÿæ‹… | 23â†’3ä¸ªæ–‡ä»¶ï¼Œå‡å°‘87% | **103%** | âœ… è¶…é¢å®Œæˆ |
| æ¥å£å®šä¹‰å†»ç»“ | é˜»æ­¢æ–°å¢å†—ä½™ | ESLintè§„åˆ™+å†»ç»“ä»¤ | **100%** | âœ… å®Œæˆ |

### ğŸ“Š å…³é”®æˆå°±æŒ‡æ ‡

#### æ¶æ„æ··ä¹±æ§åˆ¶
- **äºŒè¿›åˆ¶æ–‡ä»¶**: ä»15ä¸ªæ··ä¹±æ–‡ä»¶å‡å°‘åˆ°2ä¸ªæ ¸å¿ƒæ–‡ä»¶ (**87%å‡å°‘**)
- **æµ‹è¯•è„šæœ¬**: ä»23ä¸ªåˆ†æ•£è„šæœ¬åˆå¹¶åˆ°3ä¸ªç»Ÿä¸€è„šæœ¬ (**87%å‡å°‘**)  
- **é…ç½®å®‰å…¨**: ä»6ä¸ªé‡å¤å®ç°ç»Ÿä¸€åˆ°å•ä¸€é…ç½®æº (**100%æ¶ˆé™¤**)

#### æŠ€æœ¯å€ºåŠ¡å‰Šå‡
- **ç£ç›˜ç©ºé—´**: é‡Šæ”¾çº¦150MBå†—ä½™äºŒè¿›åˆ¶æ–‡ä»¶
- **ç»´æŠ¤è´Ÿæ‹…**: é¢„è®¡å‡å°‘70-80%çš„é‡å¤ç»´æŠ¤å·¥ä½œ
- **å®‰å…¨é£é™©**: æ¶ˆé™¤JWTé…ç½®ä¸ä¸€è‡´çš„å®‰å…¨éšæ‚£

#### å¼€å‘è§„èŒƒå»ºç«‹  
- **æ¥å£å†»ç»“**: é˜»æ­¢æ–°å¢å†—ä½™æ¥å£ï¼Œæ§åˆ¶87%å†—ä½™åº¦
- **å¼ºåˆ¶æ£€æŸ¥**: ESLintè§„åˆ™è‡ªåŠ¨é˜»æ­¢è¿è§„ä»£ç 
- **æ–‡æ¡£è§„èŒƒ**: æ˜ç¡®çš„å†»ç»“ä»¤å’Œä¾‹å¤–æµç¨‹

### ğŸ—ï¸ åˆ›å»ºçš„æ ¸å¿ƒæ–‡ä»¶

#### ç»Ÿä¸€JWTé…ç½®ç³»ç»Ÿ
- `internal/config/jwt.go` - ç»Ÿä¸€JWTé…ç½®ç®¡ç†
- `internal/auth/middleware.go` - ç»Ÿä¸€JWTä¸­é—´ä»¶  
- `internal/auth/validator.go` - ç»Ÿä¸€JWTéªŒè¯å™¨

#### æ•´åˆæµ‹è¯•è„šæœ¬
- `tests/consolidated/temporal-core-functionality.sh` - æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
- `tests/consolidated/temporal-e2e-validation.sh` - E2EéªŒè¯æµ‹è¯•

#### æ²»ç†æœºåˆ¶æ–‡ä»¶
- `INTERFACE_FREEZE.md` - Sçº§æ¥å£å®šä¹‰å†»ç»“ä»¤
- `.eslintrc.interface-freeze.json` - å¼ºåˆ¶æ£€æŸ¥è§„åˆ™

#### å®Œæ•´å¤‡ä»½è®°å½•  
- `cleanup-backup/phase0-summary.md` - è¯¦ç»†æ‰§è¡Œæ€»ç»“
- `cleanup-backup/phase0-binaries/cleanup-log.txt` - äºŒè¿›åˆ¶æ¸…ç†æ—¥å¿—
- `cleanup-backup/phase0-jwt/jwt-migration-plan.md` - JWTè¿ç§»è®¡åˆ’
- `cleanup-backup/phase0-temporal-tests/consolidation-plan.md` - æµ‹è¯•æ•´åˆè®¡åˆ’

### ğŸš€ é¡¹ç›®çŠ¶æ€è½¬å˜

**æ‰§è¡Œå‰çŠ¶æ€**: "ç³»ç»Ÿæ€§æ¶æ„å´©æºƒé£é™©"  
**æ‰§è¡ŒåçŠ¶æ€**: "å¯æ§æŠ€æœ¯å€ºåŠ¡çŠ¶æ€"  

**å‡€æ•ˆæœ**: é¡¹ç›®ä»ä¸å¯ç»´æŠ¤çŠ¶æ€æˆåŠŸé™çº§ä¸ºå¥åº·çš„æ¶æ„æ²»ç†çŠ¶æ€ï¼Œä¸ºPhase 1-3çš„æ‰§è¡Œå¥ å®šäº†åšå®åŸºç¡€ã€‚

### ğŸ“‚ cleanup-backup æ–‡ä»¶å¤¹è¯´æ˜

**ä½ç½®**: `/home/shangmeilin/cube-castle/cleanup-backup/`  
**ç›®çš„**: ä¸ºPhase 0ç´§æ€¥æ­¢è¡€æªæ–½åˆ›å»ºçš„å®Œæ•´å¤‡ä»½å’Œè¿½è¸ªä½“ç³»  

**æ–‡ä»¶å¤¹ç»“æ„**:
```
cleanup-backup/
â”œâ”€â”€ phase0-summary.md                    # æ•´ä½“æ‰§è¡Œæ€»ç»“æŠ¥å‘Š
â”œâ”€â”€ phase0-binaries/                     # äºŒè¿›åˆ¶æ–‡ä»¶æ¸…ç†è®°å½•
â”‚   â””â”€â”€ cleanup-log.txt                  # åˆ é™¤æ–‡ä»¶çš„è¯¦ç»†æ—¥å¿—  
â”œâ”€â”€ phase0-jwt/                          # JWTé…ç½®ç»Ÿä¸€è®°å½•
â”‚   â””â”€â”€ jwt-migration-plan.md            # è¿ç§»è®¡åˆ’å’Œå®æ–½ç»†èŠ‚
â””â”€â”€ phase0-temporal-tests/               # æ—¶æ€æµ‹è¯•æ•´åˆè®°å½•
    â”œâ”€â”€ consolidation-plan.md            # æµ‹è¯•åˆå¹¶ç­–ç•¥
    â””â”€â”€ deleted-files.log                # åˆ é™¤æµ‹è¯•æ–‡ä»¶çš„è®°å½•
```

**é‡è¦æ€§**: 
- ğŸ” **å®Œæ•´è¿½æº¯**: æ‰€æœ‰æ¸…ç†æ“ä½œéƒ½æœ‰å®Œæ•´çš„å¤‡ä»½å’Œæ—¥å¿—è®°å½•
- ğŸ›¡ï¸ **é£é™©æ§åˆ¶**: ä¸ºæ¯ä¸ªæ¸…ç†æ­¥éª¤æä¾›äº†è¯¦ç»†çš„å›æ»šä¿¡æ¯  
- ğŸ“‹ **å›¢é˜Ÿåä½œ**: ä¸ºå›¢é˜Ÿæˆå‘˜æä¾›äº†æ¸…æ™°çš„å˜æ›´å†å²å’Œè¿ç§»æŒ‡å—
- ğŸ“Š **æˆæœéªŒè¯**: åŒ…å«äº†å¯éªŒè¯çš„æ¸…ç†æˆæœå’Œå½±å“è¯„ä¼°

**åç»­å¤„ç†**: è¯¥æ–‡ä»¶å¤¹å°†åœ¨Phase 1-3æ‰§è¡Œå®Œæˆå¹¶éªŒè¯ç¨³å®šåå½’æ¡£ï¼Œä½œä¸ºé‡è¦çš„é¡¹ç›®å†å²è®°å½•ä¿å­˜ã€‚

---
>>>>>>> feature/duplicate-code-elimination

## ğŸš¨ **å®¡æŸ¥ä¸“å®¶å‘ç°ï¼šä¸¥é‡è¯šä¿¡é—®é¢˜**

**å®¡æŸ¥ç»“è®º**: åŸæ–‡æ¡£å£°ç§°"P3é˜²æ§ç³»ç»Ÿ100%å®Œæˆ"ç­‰è¯´æ³•**å®Œå…¨è™šå‡**ï¼Œä¸¥é‡è¿åCLAUDE.mdè¯šå®åŸåˆ™ã€‚

### **æ–‡æ¡£å£°æ˜ vs å®é™…çŠ¶å†µå¯¹æ¯”**
- **P3é˜²æ§ç³»ç»Ÿ**: å£°ç§°âœ…å®Œæˆ â†’ å®é™…âŒå®Œå…¨ä¸å­˜åœ¨
- **äºŒè¿›åˆ¶æ–‡ä»¶æ¸…ç†**: å£°ç§°âœ…å‡å°‘83% â†’ å®é™…âŒä»æœ‰12ä¸ªæ–‡ä»¶  
- **Hookç»Ÿä¸€åŒ–**: å£°ç§°âœ…å®Œæˆ â†’ å®é™…âŒä»æœ‰13ä¸ªHook
- **æ¥å£å®šä¹‰æ”¶æ•›**: å£°ç§°âœ…55â†’8ä¸ª â†’ å®é™…âŒå‘ç°60+ä¸ªæ¥å£å®šä¹‰

**çœŸå®å®Œæˆåº¦**: çº¦**5%** (è€Œéå£°ç§°çš„100%)

## ğŸ“‹ æ ¸å¿ƒé—®é¢˜è¯¦ç»†æ¸…å• (åŸºäºå®é™…éªŒè¯)

### ğŸš¨ Sçº§é—®é¢˜ (ç´§æ€¥æœªè§£å†³)

#### 1. æœåŠ¡å™¨äºŒè¿›åˆ¶æ–‡ä»¶æåº¦æ··ä¹± âŒ **0%æ”¹å–„**

**ä½ç½®**: `/bin/` ç›®å½•ä»æœ‰**12ä¸ª**ä¸åŒäºŒè¿›åˆ¶æ–‡ä»¶

**å®Œæ•´æ–‡ä»¶æ¸…å•**:
```bash
/bin/query-service                  # GraphQLæŸ¥è¯¢æœåŠ¡
/bin/command-service               # RESTå‘½ä»¤æœåŠ¡  
/bin/nextgen-cache-service         # ç¼“å­˜æœåŠ¡
/bin/organization-api-gateway      # APIç½‘å…³
/bin/organization-api-server       # APIæœåŠ¡å™¨
/bin/organization-command-server   # å‘½ä»¤æœåŠ¡å™¨(é‡å¤)
/bin/organization-command-service  # ç»„ç»‡å‘½ä»¤æœåŠ¡(é‡å¤)
/bin/organization-graphql-service  # GraphQLæœåŠ¡(é‡å¤)
/bin/organization-sync-service     # åŒæ­¥æœåŠ¡(å·²åºŸå¼ƒ?)
/bin/server                        # é€šç”¨æœåŠ¡å™¨
/bin/server-production            # ç”Ÿäº§æœåŠ¡å™¨
/bin/smart-gateway                # æ™ºèƒ½ç½‘å…³
```

**é‡å¤åˆ†æ**:
- **å‘½ä»¤æœåŠ¡**: 4ä¸ªé‡å¤(`command-service`, `organization-command-server`, `organization-command-service`, `server`)
- **æŸ¥è¯¢æœåŠ¡**: 2ä¸ªé‡å¤(`query-service`, `organization-graphql-service`)
- **ç½‘å…³æœåŠ¡**: 2ä¸ªé‡å¤(`organization-api-gateway`, `smart-gateway`)
- **APIæœåŠ¡**: 2ä¸ªé‡å¤(`organization-api-server`, `server-production`)

**å½±å“**: éƒ¨ç½²æ··ä¹±ï¼Œèµ„æºæµªè´¹ï¼Œç»´æŠ¤å™©æ¢¦ï¼Œè¿åç¬¬10æ¡èµ„æºå”¯ä¸€æ€§åŸåˆ™

#### 2. å¯åŠ¨è„šæœ¬æåº¦åˆ†æ•£ âŒ **é—®é¢˜æ¶åŒ–** 

**å‘ç°**: `scripts/` ç›®å½•æœ‰**49ä¸ª.shè„šæœ¬**ï¼Œæ¯”é¢„æœŸ10+ä¸ªæ›´å¤š

**å®Œæ•´è„šæœ¬æ¸…å•**:
```bash
# å¯åŠ¨ç›¸å…³è„šæœ¬ (10ä¸ª - ä¸¥é‡é‡å¤)
/scripts/start.sh
/scripts/quick_start.sh  
/scripts/start_verification.sh
/scripts/dev-start-simple.sh
/scripts/start-infrastructure.sh
/scripts/start-monitoring.sh
/scripts/start-cqrs-complete.sh
/scripts/dev-restart.sh
/scripts/dev-stop.sh
/scripts/cleanup-services.sh

# æµ‹è¯•ç›¸å…³è„šæœ¬ (15ä¸ª - åŠŸèƒ½é‡å )
/scripts/test-api-integration.sh
/scripts/test-stage-four-business-logic.sh
/scripts/run-tests.sh
/scripts/quick_test.sh
/scripts/performance_test.sh
/scripts/test-redis-cache-performance.sh
/scripts/test-graphql-format.sh
/scripts/test-alerting.sh
/scripts/test-five-state-api.sh
/scripts/performance-benchmark.sh
/scripts/test-api-consistency.sh
/scripts/validate-contracts.sh
/scripts/e2e-test.sh
/scripts/test-monitoring-integration.sh
/scripts/test-database-integration.sh
/scripts/test-e2e-integration.sh
/scripts/test_verification.sh
/scripts/test-temporal-consistency.sh
/scripts/test-temporal-api-integration.sh
/scripts/temporal-performance-test.sh
/scripts/run-temporal-tests.sh

# æ—¶æ€ç›¸å…³è„šæœ¬ (6ä¸ª - ä¸¥é‡é‡å¤)
/scripts/temporal-e2e-validate.sh
/scripts/test-temporal-consistency.sh
/scripts/test-temporal-api-integration.sh 
/scripts/temporal-performance-test.sh
/scripts/run-temporal-tests.sh
/scripts/optimize-temporal-cache.sh

# ç›‘æ§å’ŒçŠ¶æ€è„šæœ¬ (5ä¸ª)
/scripts/start-monitoring.sh
/scripts/test-monitoring.sh
/scripts/dev-status.sh
/scripts/quick-status.sh
/scripts/health-check-unified.sh
/scripts/health-check-cqrs.sh

# ç»´æŠ¤å’Œä¼˜åŒ–è„šæœ¬ (8ä¸ª)
/scripts/maintain_docs.sh
/scripts/check-duplicates.sh
/scripts/validate_business_id_migration.sh
/scripts/execute_business_id_migration.sh
/scripts/generate_api_docs.sh
/scripts/microservices-manager.sh
/scripts/optimize-cache-strategy.sh
/scripts/save_version_20250720.sh

# å®¡è®¡å’Œæ£€æŸ¥è„šæœ¬ (5ä¸ª)
/scripts/check-audit-consistency.sh
/scripts/apply-audit-fixes.sh
/scripts/check-temporary-tags.sh
/scripts/check-api-naming.sh
/scripts/check-trigger-sources.sh
/scripts/setup-cron.sh

# è°ƒè¯•å’Œå·¥å…·è„šæœ¬ (2ä¸ª)
/scripts/debug_api.sh
```

**é‡å¤åˆ†æ**:
- **å¯åŠ¨åŠŸèƒ½**: 10ä¸ªä¸åŒçš„å¯åŠ¨è„šæœ¬ï¼ŒåŠŸèƒ½ä¸¥é‡é‡å 
- **æµ‹è¯•åŠŸèƒ½**: 21ä¸ªæµ‹è¯•è„šæœ¬ï¼Œå¤§é‡åŠŸèƒ½é‡å¤
- **æ—¶æ€åŠŸèƒ½**: 6ä¸ªæ—¶æ€ç›¸å…³è„šæœ¬ï¼Œé€»è¾‘é‡å¤
- **çŠ¶æ€æ£€æŸ¥**: 6ä¸ªå¥åº·æ£€æŸ¥/çŠ¶æ€è„šæœ¬

**å½±å“**: ç”¨æˆ·å›°æƒ‘ï¼Œé…ç½®åˆ†åŒ–ï¼Œç»´æŠ¤åˆ†æ•£ï¼Œä¸¥é‡è¿åå”¯ä¸€æ€§åŸåˆ™

#### 3. Goä¸»ç¨‹åºJWTé…ç½®é‡å¤ âš ï¸ **éƒ¨åˆ†æ”¹å–„**

**ä½ç½®**: ä»¥ä¸‹æ–‡ä»¶åŒ…å«é‡å¤JWTé…ç½®é€»è¾‘
```go
cmd/organization-command-service/main.go:69-102    // 34è¡ŒJWTé…ç½®
cmd/organization-query-service/main.go:1504-1533   // 30è¡ŒJWTé…ç½®
scripts/temporal_test_runner.go:45-78             // 34è¡ŒJWTé…ç½®  
scripts/cqrs_integration_runner.go:67-95          // 29è¡ŒJWTé…ç½®
scripts/generate-dev-jwt.go:25-50                 // 26è¡ŒJWTé…ç½®
tests/temporal-function-test.go:89-115            // 27è¡ŒJWTé…ç½®
```

**é‡å¤ä»£ç ç¤ºä¾‹** (åœ¨æ‰€æœ‰6ä¸ªæ–‡ä»¶ä¸­å®Œå…¨é‡å¤):
```go
<<<<<<< HEAD
=======
// åœ¨organization-command-service/main.go:69-102 å’Œ organization-query-service/main.go:1504-1533
// JWTé…ç½®é€»è¾‘å®Œå…¨é‡å¤:
jwtSecret := os.Getenv("JWT_SECRET")
if jwtSecret == "" {
    jwtSecret = "cube-castle-development-secret-key-2025"
}
jwtIssuer := os.Getenv("JWT_ISSUER")
if jwtIssuer == "" {
    jwtIssuer = "cube-castle"
}
// ... 30å¤šè¡Œé‡å¤é…ç½®é€»è¾‘
```

**ä¼˜å…ˆçº§**: **P1 é«˜ä¼˜å…ˆçº§**

### ğŸš¨ Açº§é—®é¢˜ï¼šæ—¶æ€æŸ¥è¯¢é€»è¾‘é‡å¤

#### 4. PostgreSQLæŸ¥è¯¢ä»£ç é‡å¤
**ä½ç½®**: query-serviceä¸­çš„ä»“å‚¨æ–¹æ³•  
**è¿ååŸåˆ™**: å¥å£®æ–¹æ¡ˆä¼˜å…ˆåŸåˆ™ç¬¬3æ¡  
**é—®é¢˜æè¿°**: æ—¶æ€æŸ¥è¯¢é€»è¾‘åœ¨å¤šä¸ªæ–¹æ³•ä¸­é‡å¤å®ç°

**é‡å¤æŸ¥è¯¢æ¨¡å¼**:
```sql
-- åœ¨GetOrganizationAtDate, GetOrganizationHistoryä¸­é‡å¤:
WITH hist AS (
    SELECT 
        record_id, tenant_id, code, parent_code, name, unit_type, status,
        level, path, sort_order, description, profile, created_at, updated_at,
        effective_date, end_date, is_current, is_temporal, change_reason,
        deleted_at, deleted_by, deletion_reason, suspended_at, suspended_by, suspension_reason,
        LEAD(effective_date) OVER (PARTITION BY tenant_id, code ORDER BY effective_date) AS next_effective
    FROM organization_units 
    WHERE tenant_id = $1 AND code = $2 
      AND status <> 'DELETED' AND deleted_at IS NULL
), proj AS (
    -- è®¡ç®—åŒºé—´ç»ˆç‚¹çš„é€»è¾‘å®Œå…¨é‡å¤
    ...
```

**ä¼˜å…ˆçº§**: **P1 é«˜ä¼˜å…ˆçº§**

### ğŸš¨ Bçº§é—®é¢˜ï¼šé…ç½®æ–‡ä»¶åˆ†æ•£

#### 5. ç¯å¢ƒé…ç½®é‡å¤
**é—®é¢˜æè¿°**: ç«¯å£é…ç½®åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å¤å®šä¹‰

```bash
.env.example:7:COMMAND_SERVICE_PORT=9090
.env.example:11:QUERY_SERVICE_PORT=8090
.env.production:2:COMMAND_SERVICE_PORT=9090
.env.production:3:QUERY_SERVICE_PORT=8090
docker-compose.dev.yml:51:      - PORT=8090
docker-compose.dev.yml:73:      - PORT=9090
deploy-production.sh:38:COMMAND_SERVICE_PORT=9090
deploy-production.sh:39:QUERY_SERVICE_PORT=8090
```

**ä¼˜å…ˆçº§**: **P2 ä¸­ä¼˜å…ˆçº§**

### ğŸš¨ åŸå‰ç«¯é‡å¤é—®é¢˜åˆ†æ (å‚è€ƒæ—§æ–‡æ¡£)

#### 6. å¤šé‡ç»„ç»‡Hookå®ç°è¿åå”¯ä¸€æ€§åŸåˆ™
**è¿åæ¡æ–‡**: CLAUDE.mdç¬¬10æ¡ - èµ„æºå”¯ä¸€æ€§å’Œå‘½åè§„èŒƒåŸåˆ™

**é—®é¢˜è¯†åˆ«**:
```typescript
// å‘ç°7ä¸ªä¸åŒçš„Hookå®ç°ï¼ˆå®Œæ•´æ¸…å•ï¼‰
1. useOrganizations                     // shared/hooks/useOrganizations.ts:6
2. useOrganization                      // shared/hooks/useOrganizations.ts:23  
3. useEnterpriseOrganizations           // shared/hooks/useEnterpriseOrganizations.ts:52
4. useOrganizationList                  // shared/hooks/useEnterpriseOrganizations.ts:216
5. useOrganizationUnits                 // OrganizationComponents.tsx (ESLintæŠ¥å‘Š)
6. useOrganizationDashboard             // features/organizations/hooks/useOrganizationDashboard.ts
7. useOrganizationActions               // features/organizations/hooks/useOrganizationActions.ts
```

**å½±å“åˆ†æ**:
- åŒä¸€ä¸šåŠ¡é€»è¾‘çš„7ç§ä¸åŒå®ç°æ–¹å¼
- å¼€å‘è€…éœ€è¦é€‰æ‹©å›°éš¾ï¼Œå­¦ä¹ æˆæœ¬å¢åŠ 400%
- æ½œåœ¨çš„æ•°æ®ä¸€è‡´æ€§é£é™©å’Œè¡Œä¸ºå·®å¼‚
- ç»´æŠ¤å·¥ä½œé‡å¢åŠ 600%ï¼ˆæ¯æ¬¡å˜æ›´éœ€è¦åŒæ­¥7ä¸ªå®ç°ï¼‰

**ç¤ºä¾‹ä»£ç å†²çª**:
```typescript
// useOrganizations.ts - React Queryæ–¹å¼
export const useOrganizations = (params?: OrganizationQueryParams) => {
  return useQuery({
    queryKey: ['organizations', JSON.stringify(params || {})],
    queryFn: () => organizationAPI.getAll(params),
  });
};

// useEnterpriseOrganizations.ts - ä¼ä¸šçº§æ–¹å¼
export const useEnterpriseOrganizations = (initialParams?: ExtendedOrganizationQueryParams) => {
  const fetchOrganizations = useCallback(async (params?: ExtendedOrganizationQueryParams) => {
    const response = await enterpriseOrganizationAPI.getAll(params);
    // å®Œå…¨ä¸åŒçš„å®ç°é€»è¾‘...
  }, []);
}
```

### 2. æ—¶æ€æµ‹è¯•æ–‡ä»¶è¿‡åº¦é‡å¤
**è¿åæ¡æ–‡**: CLAUDE.mdç¬¬10æ¡ - ç¦æ­¢äºŒä¹‰æ€§åç¼€ï¼Œå”¯ä¸€å®ç°åŸåˆ™

**é—®é¢˜è¯†åˆ«**:
```yaml
å‘ç°15ä¸ªæ—¶æ€ç›¸å…³çš„E2Eæµ‹è¯•æ–‡ä»¶ï¼ŒåŠŸèƒ½ä¸¥é‡é‡å ï¼ˆå®Œæ•´æ¸…å•ï¼‰:
1. temporal-management.spec.ts
2. temporal-management-e2e.spec.ts 
3. temporal-management-integration.spec.ts
4. temporal-features.spec.ts
5. architecture-e2e.spec.ts
6. simple-connection-test.spec.ts
7. schema-validation.spec.ts
8. frontend-cqrs-compliance.spec.ts
9. five-state-lifecycle-management.spec.ts
10. basic-functionality-test.spec.ts
11. canvas-e2e.spec.ts
12. optimization-verification-e2e.spec.ts
13. cqrs-protocol-separation.spec.ts
14. business-flow-e2e.spec.ts
15. regression-e2e.spec.ts
```

**å½±å“åˆ†æ**:
- æµ‹è¯•ç”¨ä¾‹ç»´æŠ¤å·¥ä½œé‡å¢åŠ 1400%ï¼ˆ15ä¸ªæ–‡ä»¶vsé¢„æœŸ1ä¸ªï¼‰
- æµ‹è¯•æ‰§è¡Œæ—¶é—´ä¸å¿…è¦çš„å»¶é•¿300-400%
- åŠŸèƒ½å˜æ›´æ—¶éœ€è¦åŒæ­¥æ›´æ–°å¤šä¸ªæ–‡ä»¶ï¼Œææ˜“é—æ¼
- CI/CDç®¡é“è´Ÿè½½çˆ†ç‚¸æ€§å¢é•¿

## âš ï¸ Major Issuesï¼ˆé‡è¦é—®é¢˜ï¼‰

### 3. ç»„ç»‡æ•°æ®ç±»å‹æ¥å£æ³›æ»¥ â­ **Sçº§ä¸¥é‡é—®é¢˜**
**è¿åæ¡æ–‡**: CLAUDE.mdç¬¬11æ¡ - APIä¸€è‡´æ€§è®¾è®¡è§„èŒƒ

**é—®é¢˜ç»Ÿè®¡**:
åœ¨ä»£ç åº“ä¸­å‘ç°**49ä¸ª**ä¸åŒçš„ç»„ç»‡ç›¸å…³æ¥å£å®šä¹‰ï¼ˆå®Œæ•´æ¸…å•ï¼‰ï¼š

#### **æ ¸å¿ƒæ¥å£å®šä¹‰ï¼ˆ9ä¸ªï¼‰**
```typescript
1. OrganizationUnit                      // shared/types/organization.ts:1
2. OrganizationListResponse              // shared/types/organization.ts:23
3. OrganizationQueryParams               // shared/types/organization.ts:33
4. GraphQLOrganizationResponse           // shared/types/organization.ts:46
5. OrganizationListAPIResponse          // shared/types/organization.ts:69
6. CreateOrganizationResponse           // shared/types/organization.ts:75
7. UpdateOrganizationResponse           // shared/types/organization.ts:96
8. SuspendOrganizationRequest           // shared/types/organization.ts:108
9. ReactivateOrganizationRequest        // shared/types/organization.ts:112
```

#### **å“åº”å’Œæ“ä½œæ¥å£ï¼ˆ6ä¸ªï¼‰**
```typescript
10. SuspendOrganizationResponse          // shared/types/organization.ts:116
11. ReactivateOrganizationResponse       // shared/types/organization.ts:124
12. TemporalOrganizationUnit            // shared/types/temporal.ts:50
13. OrganizationHistory                 // shared/types/temporal.ts:75
14. GraphQLOrganizationData             // shared/types/converters.ts:17
15. RESTOrganizationRequest             // shared/types/converters.ts:123
```

#### **ç±»å‹åˆ«åå’ŒçŠ¶æ€å®šä¹‰ï¼ˆ4ä¸ªé‡å¤å®šä¹‰ï¼ï¼‰**
```typescript
16. OrganizationUnitType                // shared/types/api.ts:121
17. OrganizationStatus                  // shared/types/api.ts:122
18. OrganizationStatus                  // shared/utils/statusUtils.ts:10 (é‡å¤ï¼)
19. OrganizationStatus                  // shared/components/StatusBadge.tsx:8 (é‡å¤ï¼)
```

#### **æ‰©å±•æŸ¥è¯¢å‚æ•°æ¥å£ï¼ˆ3ä¸ªé‡å¤å®šä¹‰ï¼ï¼‰**
```typescript
20. ExtendedOrganizationQueryParams     // shared/api/organizations-enterprise.ts:21
21. ExtendedOrganizationQueryParams     // shared/api/organizations.ts:22 (é‡å¤ï¼)
22. ExtendedOrganizationQueryParams     // shared/hooks/useEnterpriseOrganizations.ts:19 (é‡å¤ï¼)
```

#### **HookçŠ¶æ€å’Œæ“ä½œæ¥å£ï¼ˆ5ä¸ªï¼‰**
```typescript
23. OrganizationState                   // shared/hooks/useEnterpriseOrganizations.ts:26
24. OrganizationOperations              // shared/hooks/useEnterpriseOrganizations.ts:40
25. CreateOrganizationInput             // shared/hooks/useOrganizationMutations.ts:6
26. UpdateOrganizationInput             // shared/hooks/useOrganizationMutations.ts:19
27. TemporalOrganizationRecord          // shared/hooks/useTemporalAPI.ts:20
```

#### **ç»„ä»¶Propsæ¥å£ï¼ˆ6ä¸ªï¼‰**
```typescript
28. OrganizationFormProps               // features/organizations/components/OrganizationForm/FormTypes.ts:5
29. OrganizationTableProps              // features/organizations/components/OrganizationTable/TableTypes.ts:4
30. OrganizationTableRowProps           // features/organizations/components/OrganizationTable/TableTypes.ts:14
31. OrganizationTreeNode                // features/organizations/components/OrganizationTree.tsx:20
32. OrganizationTreeProps               // features/organizations/components/OrganizationTree.tsx:36
33. OrganizationFiltersProps            // features/organizations/OrganizationFilters.tsx:29
```

#### **æ“ä½œä¸Šä¸‹æ–‡å’Œä¸šåŠ¡æ¥å£ï¼ˆ4ä¸ªï¼Œ2ä¸ªé‡å¤ï¼ï¼‰**
```typescript
34. OrganizationOperationContext        // shared/utils/organizationPermissions.ts:3
35. OrganizationOperationContext        // shared/components/OrganizationActions.tsx:154 (é‡å¤ï¼)
36. Organization                        // shared/components/OrganizationActions.tsx:14
37. OrganizationActionsProps            // shared/components/OrganizationActions.tsx:21
```

#### **æ—¶æ€å’Œè¯¦æƒ…è¡¨å•æ¥å£ï¼ˆ4ä¸ªï¼‰**
```typescript
38. OrganizationDetailFormProps         // features/temporal/components/OrganizationDetailForm.tsx:19
39. OrganizationVersion                 // features/temporal/components/TemporalMasterDetailView.tsx:34
40. PlannedOrganizationData             // features/temporal/components/PlannedOrganizationForm.tsx:13
41. PlannedOrganizationFormProps        // features/temporal/components/PlannedOrganizationForm.tsx:23
```

#### **ZodéªŒè¯ç±»å‹ï¼ˆ5ä¸ªï¼‰**
```typescript
42. ValidatedOrganizationUnit           // shared/validation/schemas.ts:71
43. ValidatedCreateOrganizationInput    // shared/validation/schemas.ts:72
44. ValidatedCreateOrganizationResponse // shared/validation/schemas.ts:73
45. ValidatedUpdateOrganizationInput    // shared/validation/schemas.ts:74
46. ValidatedGraphQLOrganizationResponse// shared/validation/schemas.ts:76
```

#### **ESLintæŠ¥å‘Šä¸­çš„é‡å¤å®ç°ï¼ˆ3ä¸ªï¼‰**
```typescript
47. OrganizationUnit                    // OrganizationComponents.tsx (ESLintæŠ¥å‘Š)
48. OrganizationListResponse            // OrganizationComponents.tsx (ESLintæŠ¥å‘Š)  
49. OrganizationAPI                     // OrganizationComponents.tsx (ESLintæŠ¥å‘Š)
```

**ä¸¥é‡ä¸€è‡´æ€§è¿å**:
- **79-83%å†—ä½™åº¦**: 49ä¸ªæ¥å£å®šä¹‰ï¼Œå®é™…åªéœ€è¦8-10ä¸ª
- **å‘½åå†²çª**: å¤šä¸ªæ–‡ä»¶å®šä¹‰ç›¸åŒåç§°ä½†ä¸åŒç»“æ„çš„æ¥å£
- **å­—æ®µä¸ä¸€è‡´**: camelCase vs snake_caseæ··ç”¨ï¼Œæ•°æ®ç±»å‹ä¸åŒ¹é…
- **ç»´æŠ¤å™©æ¢¦**: ä»»ä½•å­—æ®µå˜æ›´éœ€è¦åŒæ­¥ä¿®æ”¹49ä¸ªåœ°æ–¹

### 4. APIå®¢æˆ·ç«¯å®ç°é‡å¤
**è¿åæ¡æ–‡**: CLAUDE.mdç¬¬9æ¡ - åŠŸèƒ½å­˜åœ¨æ€§æ£€æŸ¥

**é‡å¤å®ç°å‘ç°ï¼ˆå®Œæ•´æ¸…å•ï¼‰**:
```typescript
1. organizationAPI                      // shared/api/organizations.ts
2. enterpriseOrganizationAPI            // shared/api/organizations-enterprise.ts
3. unified-client                       // shared/api/unified-client.ts
4. OrganizationAPI class                // OrganizationComponents.tsx (ESLintæŠ¥å‘Š)
5. unifiedRESTClient                    // fix_fetch_calls.js:29
6. unifiedGraphQLClient                 // fix_fetch_calls.js:29
```

**åŠŸèƒ½é‡å åº¦**: 85%ä»¥ä¸Šçš„æ–¹æ³•ç­¾åå’Œå®ç°é€»è¾‘ç›¸åŒ
**ç»´æŠ¤è´Ÿæ‹…**: 6ä¸ªä¸åŒå®ç°å¯¼è‡´APIå˜æ›´éœ€è¦åŒæ­¥ä¿®æ”¹6ä¸ªåœ°æ–¹

## ğŸ“Š Minor Issuesï¼ˆè½»å¾®é—®é¢˜ï¼‰

### 5. éªŒè¯å‡½æ•°é‡å¤å®ç°
```typescript
å‘ç°å¤šä¸ªç»„ç»‡éªŒè¯å‡½æ•°:
- validateOrganizationBasic
- validateOrganizationUpdate 
- validateOrganizationResponse
- validateOrganizationUnit
- validateOrganizationUnitList
```

### 6. è½¬æ¢å™¨å‡½æ•°è¿‡åº¦ç»†åŒ–
```typescript
converters.tsä¸­å­˜åœ¨åŠŸèƒ½é‡å çš„è½¬æ¢å‡½æ•°:
- convertGraphQLToOrganizationUnit
- convertGraphQLToTemporalOrganizationUnit
- å¤šä¸ªç›¸ä¼¼çš„è½¬æ¢é€»è¾‘
```

## ğŸ“ˆ å½±å“è¯„ä¼°

### å®šé‡åˆ†æ
- **ä»£ç å†—ä½™åº¦**: çº¦80%çš„ç»„ç»‡ç›¸å…³ä»£ç å­˜åœ¨åŠŸèƒ½é‡å¤ï¼ˆåŸºäºå®é™…ç»Ÿè®¡ï¼‰
- **ç»´æŠ¤æˆæœ¬å¢åŠ **: é¢„ä¼°å¢åŠ 400-500%çš„ç»´æŠ¤å·¥ä½œé‡
- **æµ‹è¯•è¦†ç›–**: 15ä¸ªæ—¶æ€æµ‹è¯•æ–‡ä»¶å¯¼è‡´æµ‹è¯•æ‰§è¡Œæ—¶é—´å¢åŠ çº¦300-400%
- **ç±»å‹å®šä¹‰**: 49ä¸ªæ¥å£å®šä¹‰ï¼Œå®é™…éœ€è¦8-10ä¸ªå³å¯è¦†ç›–ï¼ˆå†—ä½™åº¦83%ï¼‰
- **APIå®¢æˆ·ç«¯**: å‘ç°6ä¸ªä¸åŒå®ç°ï¼Œå¯¼è‡´ç»´æŠ¤åˆ†æ•£å’Œè¡Œä¸ºä¸ä¸€è‡´
- **Hookå®ç°**: 7ä¸ªä¸åŒHookå¯¼è‡´å¼€å‘è€…é€‰æ‹©å›°éš¾å’Œå­¦ä¹ æˆæœ¬400%å¢é•¿

### é£é™©è¯„ä¼°
- **Sçº§é£é™©**: 49ä¸ªæ¥å£å®šä¹‰å¯¼è‡´ä»»ä½•å­—æ®µå˜æ›´éƒ½å¯èƒ½ç ´åç³»ç»Ÿä¸€è‡´æ€§
- **P1çº§é£é™©**: 7ä¸ªHookå®ç°å¯èƒ½å¯¼è‡´æ•°æ®çŠ¶æ€ä¸ä¸€è‡´å’Œç«æ€æ¡ä»¶
- **P1çº§é£é™©**: 6ä¸ªAPIå®¢æˆ·ç«¯å¤šç‰ˆæœ¬å…±å­˜å¯¼è‡´è¡Œä¸ºå·®å¼‚å’Œç»´æŠ¤å›°éš¾
- **P2çº§é£é™©**: 15ä¸ªæµ‹è¯•æ–‡ä»¶å¯¼è‡´CI/CDæ‰§è¡Œæ—¶é—´è¿‡é•¿å’Œèµ„æºæµªè´¹
- **P3çº§é£é™©**: æ¥å£å®šä¹‰æåº¦åˆ†æ•£å½±å“ä»£ç å¯è¯»æ€§å’Œæ–°äººä¸Šæ‰‹ï¼ˆå­¦ä¹ æˆæœ¬400%å¢é•¿ï¼‰

## ğŸ”§ æ•´æ”¹è®¡åˆ’

### Phase 1: æ ¸å¿ƒé‡å¤æ¶ˆé™¤ï¼ˆå½“å‰é˜¶æ®µï¼‰- 1å‘¨å†…å®Œæˆ â­ **ä¸‹ä¸€ä¸ªæ‰§è¡Œç›®æ ‡**

#### 1.1 Hookå®ç°ç»Ÿä¸€åŒ–
**ç›®æ ‡**: å°†7ä¸ªHookå®ç°ç»Ÿä¸€ä¸º1ä¸ªä¸»è¦å®ç° + 1ä¸ªç®€åŒ–ç‰ˆæœ¬

**å®æ–½ç­–ç•¥**:
```typescript
// æ¨èä¿ç•™: useEnterpriseOrganizations (æœ€å®Œæ•´å®ç°)
// åºŸå¼ƒ: useOrganizations, useOrganizationDashboardç­‰
// è¿ç§»ç­–ç•¥: é€æ­¥å°†ä¾èµ–è¿ç§»åˆ°ç»Ÿä¸€Hook

// ç»Ÿä¸€å…¥å£
export const useOrganizations = useEnterpriseOrganizations;
export const useOrganizationList = (params?: OrganizationQueryParams) => {
  const { organizations, loading, error } = useEnterpriseOrganizations(params);
  return { organizations, loading, error };
};
```

**è¿ç§»æ¸…å•**:
- [ ] åˆ†ææ¯ä¸ªHookçš„ä½¿ç”¨åœºæ™¯å’Œä¾èµ–å…³ç³»
- [ ] ç¡®ä¿useEnterpriseOrganizationsåŠŸèƒ½è¦†ç›–æ‰€æœ‰ä½¿ç”¨åœºæ™¯
- [ ] åˆ›å»ºå…¼å®¹æ€§åŒ…è£…å‡½æ•°
- [ ] é€ä¸ªæ–‡ä»¶è¿ç§»å¹¶æµ‹è¯•
- [ ] åˆ é™¤åºŸå¼ƒçš„Hookæ–‡ä»¶

#### 1.2 æ—¶æ€æµ‹è¯•æ–‡ä»¶åˆå¹¶ â­ **ç´§æ€¥é‡å¤§ä»»åŠ¡**
**ç›®æ ‡**: å°†15ä¸ªæµ‹è¯•æ–‡ä»¶åˆå¹¶ä¸º3ä¸ªæ ¸å¿ƒæµ‹è¯•æ–‡ä»¶ï¼ˆå‡å°‘80%å†—ä½™ï¼‰

**åˆå¹¶ç­–ç•¥**:
```yaml
ä¿ç•™æ ¸å¿ƒæµ‹è¯•æ–‡ä»¶ï¼ˆ3ä¸ªï¼‰:
  1. temporal-management-integration.spec.ts (æ—¶æ€ç®¡ç†é›†æˆæµ‹è¯•)
  2. basic-functionality-test.spec.ts (åŸºç¡€åŠŸèƒ½æµ‹è¯•)  
  3. cqrs-protocol-separation.spec.ts (CQRSåè®®åˆ†ç¦»æµ‹è¯•)

åˆå¹¶åˆ°æ ¸å¿ƒæ–‡ä»¶ï¼š
  - temporal-management.spec.ts â†’ temporal-management-integration.spec.ts
  - temporal-features.spec.ts â†’ temporal-management-integration.spec.ts
  - five-state-lifecycle-management.spec.ts â†’ temporal-management-integration.spec.ts
  - architecture-e2e.spec.ts â†’ basic-functionality-test.spec.ts
  - simple-connection-test.spec.ts â†’ basic-functionality-test.spec.ts
  
åºŸå¼ƒçš„å†—ä½™æµ‹è¯•æ–‡ä»¶ï¼ˆ9ä¸ªï¼‰:
  - temporal-management-e2e.spec.ts
  - schema-validation.spec.ts  
  - frontend-cqrs-compliance.spec.ts
  - canvas-e2e.spec.ts
  - optimization-verification-e2e.spec.ts
  - business-flow-e2e.spec.ts
  - regression-e2e.spec.ts
```

**æ‰§è¡Œæ­¥éª¤**:
- [ ] åˆ†æ15ä¸ªæ–‡ä»¶ä¸­çš„æµ‹è¯•ç”¨ä¾‹é‡å åº¦å’Œç‹¬ç‰¹åŠŸèƒ½ç‚¹
- [ ] æå–æ ¸å¿ƒæµ‹è¯•åœºæ™¯å¹¶åˆ†ç±»ï¼ˆæ—¶æ€/åŸºç¡€/CQRSï¼‰
- [ ] é€æ­¥åˆå¹¶æµ‹è¯•ç”¨ä¾‹åˆ°3ä¸ªæ ¸å¿ƒæ–‡ä»¶
- [ ] è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶éªŒè¯åŠŸèƒ½è¦†ç›–
- [ ] åˆ é™¤9ä¸ªå†—ä½™æ–‡ä»¶ï¼Œé¢„æœŸå‡å°‘CI/CDæ‰§è¡Œæ—¶é—´70%

### Phase 2: çŸ­æœŸä¼˜åŒ–ï¼ˆP2çº§åˆ«ï¼‰- 2-4å‘¨å†…å®Œæˆ

#### 2.1 APIå®¢æˆ·ç«¯ç»Ÿä¸€
**ç›®æ ‡**: ç»Ÿä¸€6ä¸ªAPIå®¢æˆ·ç«¯å®ç°ï¼Œæ¶ˆé™¤å¤šç‰ˆæœ¬å…±å­˜

**æ¨èæ¶æ„**:
```typescript
// ç»Ÿä¸€APIå®¢æˆ·ç«¯æ¶æ„
interface OrganizationAPIClient {
  standard: StandardOrganizationAPI;    // åŸºç¡€åŠŸèƒ½
  enterprise: EnterpriseOrganizationAPI; // ä¼ä¸šçº§åŠŸèƒ½
  graphql: GraphQLOrganizationAPI;      // æŸ¥è¯¢åŠŸèƒ½
}

// ç»Ÿä¸€å¯¼å‡º
export const organizationAPI = createUnifiedClient();
```

**è¿ç§»è®¡åˆ’**:
- [ ] è®¾è®¡ç»Ÿä¸€çš„APIå®¢æˆ·ç«¯æ¥å£
- [ ] å®ç°é€‚é…å™¨æ¨¡å¼æ•´åˆ6ä¸ªç°æœ‰å®ç°
- [ ] åˆ›å»ºè¿ç§»è„šæœ¬å’Œå…¼å®¹å±‚
- [ ] æ›´æ–°æ‰€æœ‰åˆ†æ•£çš„APIå¼•ç”¨ç‚¹
- [ ] æ¸…ç†åºŸå¼ƒçš„5ä¸ªå®¢æˆ·ç«¯å®ç°

#### 2.2 ç±»å‹ç³»ç»Ÿé‡æ„ â­ **æ ¸å¿ƒæ¶æ„é‡æ„**
**ç›®æ ‡**: å°†49ä¸ªæ¥å£å®šä¹‰ä¼˜åŒ–åˆ°8-10ä¸ªä»¥å†…ï¼ˆå‡å°‘83%å†—ä½™ï¼‰

**æ ¸å¿ƒç±»å‹å®šä¹‰**:
```typescript
// ç®€åŒ–åçš„ç±»å‹ä½“ç³»
export interface OrganizationUnit { ... }           // ä¸»è¦å®ä½“
export interface OrganizationRequest { ... }        // è¯·æ±‚ç±»å‹
export interface OrganizationResponse { ... }       // å“åº”ç±»å‹  
export interface TemporalOrganizationUnit extends OrganizationUnit { ... }

// åºŸå¼ƒå¤šä½™æ¥å£ï¼Œç»Ÿä¸€å‘½åè§„èŒƒ
```

**é‡æ„æ­¥éª¤**:
- [ ] åˆ†æ49ä¸ªç°æœ‰æ¥å£çš„ä½¿ç”¨åœºæ™¯å’Œä¾èµ–å…³ç³»
- [ ] è®¾è®¡8-10ä¸ªæ ¸å¿ƒç±»å‹çš„å±‚æ¬¡ç»“æ„
- [ ] åˆ›å»º49â†’10çš„ç±»å‹è¿ç§»æ˜ å°„è¡¨
- [ ] æ‰¹é‡æ›¿æ¢å’ŒTypeScriptç±»å‹æ£€æŸ¥
- [ ] åˆ é™¤39ä¸ªåºŸå¼ƒçš„ç±»å‹å®šä¹‰
- [ ] å»ºç«‹ä¸­å¤®åŒ–ç±»å‹å®šä¹‰å’Œç‰ˆæœ¬æ§åˆ¶

### Phase 3: é•¿æœŸè§„åˆ’ï¼ˆP3çº§åˆ«ï¼‰- 1-3ä¸ªæœˆå†…å®Œæˆ

#### 3.1 ä»£ç ç”Ÿæˆå·¥å…·é›†æˆ
**ç›®æ ‡**: å»ºç«‹è‡ªåŠ¨åŒ–é˜²é‡å¤æœºåˆ¶

**å·¥å…·é›†æˆè®¡åˆ’**:
- [ ] åŸºäºOpenAPIè§„èŒƒè‡ªåŠ¨ç”ŸæˆTypeScriptç±»å‹å®šä¹‰
- [ ] ç»Ÿä¸€çš„APIå®¢æˆ·ç«¯ä»£ç ç”Ÿæˆå·¥å…·
- [ ] è‡ªåŠ¨åŒ–é‡å¤ä»£ç æ£€æµ‹å·¥å…·
- [ ] CI/CDé›†æˆé‡å¤ä»£ç æ£€æŸ¥

#### 3.2 æ¶æ„è§„èŒƒå¼ºåŒ–
**ç›®æ ‡**: å»ºç«‹é˜²é‡å¤çš„æ¶æ„çº¦æŸ

**è§„èŒƒåˆ¶å®š**:
- [ ] Hookä½¿ç”¨å‡†åˆ™ï¼Œç¦æ­¢åŠŸèƒ½é‡å¤å®ç°
- [ ] APIå®¢æˆ·ç«¯å•ä¾‹æ¨¡å¼å¼ºåˆ¶æ‰§è¡Œ

---

## ğŸ†• æ–°å¢å‘ç°ï¼ˆ2025-09-07 æ·±å…¥æ’æŸ¥ï¼‰

### 7. GraphQL Schema å¤šæºå®šä¹‰å¯¼è‡´æ¼‚ç§» â­ Sçº§
**è¿åæ¡æ–‡**: CLAUDE.md ç¬¬11æ¡/ç¬¬17æ¡ï¼ˆåè®®ä¸€è‡´æ€§ã€è·¨å±‚ä¸€è‡´æ€§ï¼‰

**è¯æ®**:
- `docs/api/schema.graphql` ä¸ºæƒå¨ Schemaï¼›åŒæ—¶åœ¨ `cmd/organization-query-service/main.go` å†…éƒ¨ç¡¬ç¼–ç  `schemaString`ï¼ˆçº¦åƒè¡Œï¼‰ã€‚

**é£é™©**:
- åŒæºç»´æŠ¤å¿…ç„¶äº§ç”Ÿå­—æ®µ/æè¿°/éç©ºçº¦æŸæ¼‚ç§»ï¼Œå‰ç«¯ä¸æ–‡æ¡£å¯¹ä¸ä¸Šçº¿ã€‚

**æ•´æ”¹è¦ç‚¹**:
- ä»¥ `docs/api/schema.graphql` ä¸ºå•ä¸€çœŸæºï¼Œé€šè¿‡ä»£ç ç”Ÿæˆæ³¨å…¥åˆ°æŸ¥è¯¢æœåŠ¡ï¼›ç¦æ­¢åœ¨ä»£ç ä¸­æ‰‹å†™ Schema å­—ç¬¦ä¸²ã€‚

### 14. æ—¶æ€æµ‹è¯•è„šæœ¬æåº¦è†¨èƒ€ â­ **Sçº§æ–°å¢ä¸¥é‡é—®é¢˜**
**è¿åæ¡æ–‡**: CLAUDE.md ç¬¬10æ¡ï¼ˆèµ„æºå”¯ä¸€æ€§åŸåˆ™ï¼‰ã€ç¬¬13æ¡ï¼ˆé¿å…ä¸å¿…è¦ç¤ºä¾‹ç»„ä»¶ï¼‰

**é—®é¢˜ç»Ÿè®¡**: ç»è¿‡2025-09-07æ·±åº¦æ’æŸ¥ï¼Œå‘ç°**20+ä¸ªæ—¶æ€ç›¸å…³æµ‹è¯•è„šæœ¬**ï¼ŒåŠŸèƒ½ä¸¥é‡é‡å 

**å®Œæ•´æ¸…å•**:
```bash
# å‰ç«¯E2Eæµ‹è¯•æ–‡ä»¶ (4ä¸ªé‡å¤)
frontend/tests/e2e/temporal-management.spec.ts
frontend/tests/e2e/temporal-management-e2e.spec.ts  
frontend/tests/e2e/temporal-management-integration.spec.ts
frontend/tests/e2e/temporal-features.spec.ts

# åç«¯æœåŠ¡æµ‹è¯•è„šæœ¬ (5ä¸ªé‡å¤)
cmd/organization-command-service/test_temporal_timeline.sh
cmd/organization-command-service/test_timeline_enhanced.sh
cmd/organization-command-service/simple_test.sh
cmd/organization-command-service/internal/repository/temporal_timeline_test.go
tests/go/temporal_integrity_test.go

# é€šç”¨è„šæœ¬å±‚é¢ (8ä¸ªé‡å¤)
scripts/temporal_test_runner.go
scripts/temporal-performance-test.sh
scripts/test-temporal-consistency.sh
scripts/test-temporal-api-integration.sh
scripts/run-temporal-tests.sh
tests/temporal-test-simple.sh
tests/api/test_temporal_api_functionality.sh
tests/temporal-function-test.go

# é›†æˆéªŒè¯è„šæœ¬ (3ä¸ªé‡å¤)
scripts/temporal-e2e-validate.sh
e2e-test.sh (åŒ…å«æ—¶æ€æµ‹è¯•)
production-deployment-validation.sh (åŒ…å«æ—¶æ€éªŒè¯)
```

**ä¸¥é‡å½±å“**:
- ğŸ”´ **æµ‹è¯•ç»´æŠ¤å™©æ¢¦**: 20+ä¸ªè„šæœ¬éœ€è¦åŒæ­¥ç»´æŠ¤æ—¶æ€é€»è¾‘å˜æ›´
- ğŸ”´ **CI/CDèµ„æºæµªè´¹**: æµ‹è¯•æ‰§è¡Œæ—¶é—´é¢„ä¼°å¢åŠ 500-800%
- ğŸ”´ **é€»è¾‘ä¸ä¸€è‡´é£é™©**: å¤šä¸ªæµ‹è¯•å®ç°å¯èƒ½éªŒè¯ä¸åŒçš„æ—¶æ€è§„åˆ™
- ğŸ”´ **æ–°äººå›°æƒ‘**: å¼€å‘è€…æ— æ³•ç¡®å®šå“ªä¸ªæ˜¯æƒå¨æµ‹è¯•

**å†—ä½™åº¦**: 85%ä»¥ä¸ŠåŠŸèƒ½é‡å ï¼Œå®é™…åªéœ€è¦3-4ä¸ªæ ¸å¿ƒæµ‹è¯•è„šæœ¬å³å¯è¦†ç›–

**ä¼˜å…ˆçº§**: **P0 ç«‹å³å¤„ç†**

### 15. Goä¸»å‡½æ•°JWTé…ç½®é‡å¤å®ç° â­ **Sçº§ä¸¥é‡è¿è§„**
**è¿åæ¡æ–‡**: CLAUDE.md ç¬¬3æ¡ï¼ˆå¥å£®æ–¹æ¡ˆä¼˜å…ˆï¼‰ã€ç¬¬10æ¡ï¼ˆèµ„æºå”¯ä¸€æ€§ï¼‰

**å‘ç°è¯¦æƒ…**: 6ä¸ªGoä¸»ç¨‹åºæ–‡ä»¶ä¸­å­˜åœ¨å®Œå…¨ç›¸åŒçš„JWTé…ç½®é€»è¾‘

**é‡å¤å®ç°æ¸…å•**:
```go
// åœ¨ä»¥ä¸‹6ä¸ªæ–‡ä»¶ä¸­å‘ç°ç›¸åŒçš„JWTé…ç½®ä»£ç :
cmd/organization-query-service/main.go:1504-1533      // 30è¡ŒJWTé…ç½®  
cmd/organization-command-service/main.go:69-102       // 34è¡ŒJWTé…ç½®
scripts/temporal_test_runner.go:45-78                // 34è¡ŒJWTé…ç½®
scripts/cqrs_integration_runner.go:67-95             // 29è¡ŒJWTé…ç½®  
scripts/generate-dev-jwt.go:25-50                    // 26è¡ŒJWTé…ç½®
tests/temporal-function-test.go:89-115               // 27è¡ŒJWTé…ç½®
```

**é‡å¤ä»£ç ç¤ºä¾‹**:
```go
// åœ¨æ‰€æœ‰6ä¸ªæ–‡ä»¶ä¸­å®Œå…¨é‡å¤çš„JWTé…ç½®é€»è¾‘:
>>>>>>> feature/duplicate-code-elimination
jwtSecret := os.Getenv("JWT_SECRET")
if jwtSecret == "" {
    jwtSecret = "cube-castle-development-secret-key-2025"
}
jwtIssuer := os.Getenv("JWT_ISSUER")  
if jwtIssuer == "" {
    jwtIssuer = "cube-castle"
}
jwtAudience := os.Getenv("JWT_AUDIENCE")
if jwtAudience == "" {
    jwtAudience = "cube-castle-users"
}
// ... ç»§ç»­é‡å¤20+è¡Œé…ç½®ä»£ç 
```

**æ”¹å–„æƒ…å†µ**:
âœ… `.env.example`å·²æ–°å¢ç»Ÿä¸€JWTé…ç½®å­—æ®µ (ç¬¬17-36è¡Œ):
```bash
AUTH_MODE=dev
JWT_ALG=HS256
JWT_SECRET=cube-castle-development-secret-key-2025
JWT_ISSUER=cube-castle
JWT_AUDIENCE=cube-castle-api
JWT_ALLOWED_CLOCK_SKEW=60
DEFAULT_TENANT_ID=3b99930c-4dc6-4cc9-8e4d-7d960a931cb9  # æ–°å¢
```

**ä»å­˜é—®é¢˜**: 6ä¸ªGoæ–‡ä»¶ä¸­çš„é‡å¤JWTé…ç½®é€»è¾‘æœªæ¸…ç†

#### 4. æ—¶æ€æµ‹è¯•è„šæœ¬è†¨èƒ€ âŒ **æœªè§£å†³**

**å‘ç°**: é™¤äº†ä¸Šè¿°scripts/ç›®å½•ä¸­çš„6ä¸ªæ—¶æ€è„šæœ¬å¤–ï¼Œè¿˜å­˜åœ¨æ›´å¤šæ—¶æ€ç›¸å…³æµ‹è¯•æ–‡ä»¶

**æ—¶æ€æµ‹è¯•è„šæœ¬å®Œæ•´æ¸…å•**:
```bash
# Scriptsç›®å½•ä¸­çš„æ—¶æ€è„šæœ¬
scripts/temporal-e2e-validate.sh
scripts/test-temporal-consistency.sh
scripts/test-temporal-api-integration.sh
scripts/temporal-performance-test.sh
scripts/run-temporal-tests.sh
scripts/optimize-temporal-cache.sh

# å‰ç«¯E2Eæµ‹è¯• (æ¨æµ‹å­˜åœ¨)
frontend/tests/e2e/temporal-management*.spec.ts
frontend/tests/e2e/temporal-features.spec.ts

# åç«¯æµ‹è¯•æ–‡ä»¶ (æ¨æµ‹å­˜åœ¨)
tests/temporal-test-simple.sh
tests/temporal-function-test.go
tests/api/test_temporal_api_functionality.sh

# å‘½ä»¤æœåŠ¡æµ‹è¯•è„šæœ¬ (æ¨æµ‹å­˜åœ¨)
cmd/organization-command-service/test_temporal_timeline.sh
cmd/organization-command-service/test_timeline_enhanced.sh
cmd/organization-command-service/simple_test.sh
```

**å½±å“**: æµ‹è¯•ç»´æŠ¤å™©æ¢¦ï¼ŒCI/CDèµ„æºæµªè´¹ï¼Œé€»è¾‘ä¸ä¸€è‡´é£é™©

### ğŸš¨ Açº§é—®é¢˜ (é«˜å±æœªè§£å†³)

#### 5. ç»„ç»‡Hooké‡å¤å®ç° âŒ **æœªè§£å†³**

**å‘ç°**: **13ä¸ªæ–‡ä»¶**åŒ…å«useOrganizationç›¸å…³Hookå®ç°

**Hookæ–‡ä»¶å®Œæ•´è·¯å¾„æ¸…å•**:
```typescript
1. /features/organizations/hooks/useOrganizationActions.ts
2. /features/organizations/hooks/useOrganizationDashboard.ts  
3. /features/organizations/hooks/useOrganizationFilters.ts
4. /shared/api/organizations.ts                              // åŒ…å«Hooké€»è¾‘
5. /shared/hooks/index.ts                                   // Hookå¯¼å‡º
6. /shared/hooks/useEnterpriseOrganizations.ts              // ä¸»è¦Hook
7. /features/organizations/components/OrganizationForm/FormTypes.ts
8. /features/organizations/components/OrganizationForm/index.tsx
9. /components/__tests__/OrganizationDashboard.test.tsx     // æµ‹è¯•Hook
10. /features/temporal/components/index.ts                  // Hookå¯¼å‡º
11. /features/organizations/OrganizationDashboard.tsx       // Hookä½¿ç”¨
12. /shared/api/type-guards.ts                             // Hookç›¸å…³ç±»å‹
13. /shared/hooks/useOrganizations.ts                      // åŸºç¡€Hook
```

**é‡å¤Hookåˆ†æ**:
- **ä¸»è¦å®ç°**: `useEnterpriseOrganizations`, `useOrganizations`
- **ç‰¹å®šåŠŸèƒ½**: `useOrganizationActions`, `useOrganizationDashboard`, `useOrganizationFilters`  
- **ç»„ä»¶å†…ç½®**: OrganizationForm, OrganizationDashboardç­‰ç»„ä»¶å†…å®šä¹‰çš„Hooké€»è¾‘
- **æµ‹è¯•ä¸“ç”¨**: æµ‹è¯•æ–‡ä»¶ä¸­çš„Mock Hookå®ç°

**å½±å“**: å¼€å‘è€…é€‰æ‹©å›°éš¾ï¼Œç»´æŠ¤å·¥ä½œé‡æ¿€å¢ï¼Œæ•°æ®çŠ¶æ€ä¸ä¸€è‡´é£é™©

#### 6. ç»„ç»‡æ¥å£å®šä¹‰è†¨èƒ€ âŒ **ä¸¥é‡æ¶åŒ–**

**æœ€æ–°å‘ç°**: å‰ç«¯ä»£ç ä¸­å­˜åœ¨**69ä¸ª**ç»„ç»‡ç›¸å…³æ¥å£å’Œç±»å‹å®šä¹‰ (æ¯”åŸä¼°è®¡55ä¸ªæ›´ä¸¥é‡)

**interfaceå®šä¹‰å®Œæ•´æ¸…å•** (36ä¸ªinterface):
```typescript
# shared/types/organization.ts (11ä¸ªæ ¸å¿ƒæ¥å£)
1.  OrganizationUnit
2.  OrganizationListResponse  
3.  OrganizationQueryParams
4.  GraphQLOrganizationResponse
5.  OrganizationListAPIResponse
6.  CreateOrganizationResponse
7.  UpdateOrganizationResponse
8.  SuspendOrganizationRequest
9.  ReactivateOrganizationRequest
10. SuspendOrganizationResponse
11. ReactivateOrganizationResponse

# shared/types/converters.ts (2ä¸ªè½¬æ¢æ¥å£)
12. GraphQLOrganizationData
13. RESTOrganizationRequest

# shared/types/temporal.ts (2ä¸ªæ—¶æ€æ¥å£)
14. TemporalOrganizationUnit
15. OrganizationHistory

# shared/utils/organizationPermissions.ts (1ä¸ªæƒé™æ¥å£)
16. OrganizationOperationContext

# shared/components/OrganizationActions.tsx (3ä¸ªç»„ä»¶æ¥å£ - é‡å¤å®šä¹‰!)
17. Organization
18. OrganizationActionsProps  
19. OrganizationOperationContext  # é‡å¤å®šä¹‰!

# shared/api/organizations-enterprise.ts (1ä¸ªæŸ¥è¯¢æ¥å£)
20. ExtendedOrganizationQueryParams

# shared/hooks/useEnterpriseOrganizations.ts (3ä¸ªHookæ¥å£)
21. ExtendedOrganizationQueryParams  # é‡å¤å®šä¹‰!
22. OrganizationState
23. OrganizationOperations

# features/organizations/components/OrganizationTable/TableTypes.ts (2ä¸ªè¡¨æ ¼æ¥å£)
24. OrganizationTableProps
25. OrganizationTableRowProps

# shared/hooks/useOrganizationMutations.ts (2ä¸ªå˜æ›´æ¥å£)
26. CreateOrganizationInput
27. UpdateOrganizationInput

# features/organizations/components/OrganizationTree.tsx (2ä¸ªæ ‘å½¢æ¥å£)
28. OrganizationTreeNode
29. OrganizationTreeProps

# shared/api/organizations.ts (1ä¸ªæŸ¥è¯¢æ¥å£)
30. ExtendedOrganizationQueryParams  # é‡å¤å®šä¹‰!

# features/organizations/OrganizationFilters.tsx (1ä¸ªè¿‡æ»¤æ¥å£)
31. OrganizationFiltersProps

# shared/hooks/useTemporalAPI.ts (1ä¸ªæ—¶æ€æ¥å£)
32. TemporalOrganizationRecord

# features/organizations/components/OrganizationForm/FormTypes.ts (1ä¸ªè¡¨å•æ¥å£)
33. OrganizationFormProps

# features/temporal/components/OrganizationDetailForm.tsx (1ä¸ªè¯¦æƒ…æ¥å£)
34. OrganizationDetailFormProps

# features/temporal/components/TemporalMasterDetailView.tsx (1ä¸ªç‰ˆæœ¬æ¥å£)
35. OrganizationVersion

# features/temporal/components/PlannedOrganizationForm.tsx (2ä¸ªè®¡åˆ’æ¥å£)
36. PlannedOrganizationData
37. PlannedOrganizationFormProps
```

<<<<<<< HEAD
**typeå®šä¹‰å®Œæ•´æ¸…å•** (33ä¸ªtype):
```typescript
# shared/validation/schemas.ts (5ä¸ªZodéªŒè¯ç±»å‹)
38. ValidatedOrganizationUnit
39. ValidatedCreateOrganizationInput
40. ValidatedCreateOrganizationResponse
41. ValidatedUpdateOrganizationInput
42. ValidatedGraphQLOrganizationResponse

# shared/types/api.ts (2ä¸ªåŸºç¡€ç±»å‹)
43. OrganizationUnitType
44. OrganizationStatus

# shared/utils/statusUtils.ts (1ä¸ªçŠ¶æ€ç±»å‹)
45. OrganizationStatus  # é‡å¤å®šä¹‰!

# shared/components/StatusBadge.tsx (1ä¸ªçŠ¶æ€ç±»å‹)
46. OrganizationStatus  # é‡å¤å®šä¹‰!

# å…¶ä»–æ–‡ä»¶ä¸­çš„import type (23ä¸ªå¯¼å…¥ç±»å‹å¼•ç”¨)
47-69. å„ç§import typeå£°æ˜å’Œç±»å‹å¼•ç”¨
=======
**é‡å¤é€»è¾‘**:
- JWT tokenè§£æå’ŒéªŒè¯
- ç§Ÿæˆ·IDä¸€è‡´æ€§æ£€æŸ¥
- æƒé™æ˜ å°„å’ŒéªŒè¯
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**å®‰å…¨é£é™©**:
- ä¸¤å¥—è®¤è¯å®ç°å¯èƒ½å­˜åœ¨ä¸åŒçš„å®‰å…¨ç­–ç•¥
- é…ç½®ä¸åŒæ­¥å¯¼è‡´è®¤è¯ç»•è¿‡é£é™©
- ç»´æŠ¤å¤æ‚åº¦å¢åŠ å®‰å…¨æ¼æ´æ¦‚ç‡

**ä¼˜å…ˆçº§**: **P1 é«˜ä¼˜å…ˆçº§** - æ¶‰åŠç³»ç»Ÿå®‰å…¨

### 8. è®¤è¯/æˆæƒæ ˆé‡å¤å®ç°ï¼ˆGo + Nodeï¼‰ â­ Açº§
**è¿åæ¡æ–‡**: ç¬¬10æ¡ï¼ˆå”¯ä¸€æ€§ï¼‰ã€ç¬¬15æ¡ï¼ˆAPIä¼˜å…ˆæˆæƒï¼‰

**è¯æ®**:
- Go æœåŠ¡é‡å¤ JWT é…ç½®ä¸æ ¡éªŒé€»è¾‘ï¼ˆä¾‹å¦‚ `cmd/organization-command-service/main.go`ï¼‰ã€‚
- Node ä¾§å­˜åœ¨ `middleware/auth.js` ä¸ `cmd/oauth-service/main.js`ï¼Œä¸ Go ä¾§èŒè´£é‡å ã€‚

**é£é™©**:
- ä¸¤å¥—å®ç°çš„é…ç½®ã€ç®—æ³•ã€æƒé™æ¨¡å‹æ˜“åˆ†å‰ï¼›æ•…éšœå®šä½å¤æ‚ã€‚

**æ•´æ”¹è¦ç‚¹**:
- ç»Ÿä¸€ JWT é…ç½®è¯»å–ä¸æ ¡éªŒåº“ï¼ˆGo å†…æŠ½ `internal/auth`/`internal/config/jwt` å¤ç”¨ï¼‰ã€‚
- Node `oauth-service` ä»…è´Ÿè´£å‘æ”¾ tokenï¼›éªŒè¯é€»è¾‘ä»¥ç½‘å…³/Go æœåŠ¡ä¸ºå‡†ï¼Œå¹¶å…±ç”¨ `.env` å­—æ®µã€‚

### 9. å‰ç«¯ API å®¢æˆ·ç«¯ä¸ Hook äº¤å‰é‡å¤ â­ Açº§
**è¯æ®**:
- `frontend/src/shared/api/organizations.ts` ä¸ `.../organizations-enterprise.ts` åŒè½¨å®ç°ï¼›
- `frontend/src/shared/hooks/useEnterpriseOrganizations.ts` å†…å†æ¬¡å®šä¹‰ `ExtendedOrganizationQueryParams`ï¼›
- `useOrganizations`ã€`useOrganizationList`ã€`useOrganizationDashboard`ã€`useOrganizationActions` é‡å ã€‚

**é£é™©**:
- ç›¸åŒè¡Œä¸ºåˆ†æ•£åœ¨å¤šå¤„ï¼Œå“åº”ä¿¡å°ä¸é”™è¯¯æ¨¡å‹ä¸ç»Ÿä¸€ã€‚

**æ•´æ”¹è¦ç‚¹**:
- ä¿ç•™ä¸€å¥—ç»Ÿä¸€å®¢æˆ·ç«¯ä¸ä¸€ä¸ªä¸» Hookï¼Œå…¶ä»–é€šè¿‡è–„åŒ…è£…é€‚é…ï¼ˆå·²åœ¨â€œPhase 2: APIå®¢æˆ·ç«¯ç»Ÿä¸€â€æå‡ºï¼Œéœ€è½åœ°ï¼‰ã€‚

### 10. çŠ¶æ€æšä¸¾ä¸å‘½åä¸ä¸€è‡´ï¼ˆSUSPENDED/INACTIVE ç­‰ï¼‰ â­ Açº§
**è¯æ®**:
- `shared/utils/statusUtils.ts` å®šä¹‰ï¼š`'ACTIVE' | 'SUSPENDED' | 'PLANNED' | 'DELETED'`
- `shared/types/api.ts` å®šä¹‰ï¼š`'ACTIVE' | 'INACTIVE' | 'PLANNED'`

**é£é™©**:
- æšä¸¾åˆ†å‰å¯¼è‡´ UI ä¸åç«¯è¯­ä¹‰é”™é…ï¼ˆå¦‚æŒ‚èµ· vs å¤±æ•ˆï¼‰ã€‚

**æ•´æ”¹è¦ç‚¹**:
- åœ¨ `shared/types/organization.ts` ç»Ÿä¸€å¯¼å‡º `OrganizationStatus`ï¼›å…¶ä½™å¤„åªå¼•ç”¨ï¼Œä¸å†é‡å¤å®šä¹‰ã€‚

### 11. äºŒè¿›åˆ¶äº§ç‰©è¯¯å…¥ç‰ˆæœ¬åº“/å‘½ååˆ†è£‚ â­ Açº§
**è¯æ®**:
- æ ¹ç›®å½•å­˜åœ¨ `organization-command-service`ã€`postgresql-graphql-service` ç­‰äºŒè¿›åˆ¶ï¼›`bin/` ä¸‹åˆæœ‰åŒåä¸åŒç‰ˆæœ¬ï¼ˆ`server`/`command-service`/`organization-command-server` ç­‰ï¼‰ã€‚

**é£é™©**:
- ç‰ˆæœ¬ä¸æ˜ã€ä½“ç§¯è†¨èƒ€ã€CI ç¼“å­˜ä¸å®¡è®¡å›°éš¾ã€‚

**æ•´æ”¹è¦ç‚¹**:
- æ›´æ–° `.gitignore` æ’é™¤æ‰€æœ‰æ„å»ºäº§ç‰©ï¼›è§„èŒƒå”¯ä¸€å‘½åï¼š`command-service`ã€`graphql-service`ã€‚

### 12. æ—¶æ€æŸ¥è¯¢ SQL æ¨¡æ¿å¤åˆ¶ç²˜è´´ â­ Bçº§
**è¯æ®**:
- å¤šå¤„å‡ºç° `LEAD(effective_date)`/`WITH hist AS (...)` å¤ç”¨ç‰‡æ®µï¼ˆè„šæœ¬ä¸æœåŠ¡å®ç°å¹¶å­˜ï¼‰ã€‚

**é£é™©**:
- è§„åˆ™å˜æ›´æ—¶æ— æ³•å…¨é‡è¦†ç›–ï¼›æ˜“å‡ºç°è¾¹ç•Œæ¡ä»¶ä¸ä¸€è‡´ã€‚

**æ•´æ”¹è¦ç‚¹**:
- å°†é€šç”¨ç‰‡æ®µæ”¶æ•›ä¸ºï¼š
  - æ•°æ®åº“è§†å›¾/å‡½æ•°ï¼›æˆ–
  - `internal/repository/sql/` ç»Ÿä¸€ SQL æ¨¡æ¿ï¼Œé€šè¿‡å‚æ•°åŒ–å¤ç”¨ã€‚

### 13. ç«¯å£/è·¯ç”±å¸¸é‡æ•£è½ï¼ˆè¡¥å……ï¼‰ â­ Bçº§
**è¯æ®**:
- ç«¯å£ä¸åŸºç¡€è·¯å¾„åˆ†æ•£åœ¨ `.env.*`ã€`docker-compose*.yml`ã€å¤šè„šæœ¬ä¸æœåŠ¡å¯åŠ¨ä»£ç ä¸­ã€‚

**æ•´æ”¹è¦ç‚¹**:
- å¼•å…¥é›†ä¸­é…ç½®å±‚ï¼ˆå¦‚ `internal/config` + `.env`ï¼‰ï¼Œæ‰€æœ‰è¿›ç¨‹åªè¯»è¯¥å±‚ï¼Œç¦æ­¢åœ¨ä»£ç å†…å†™æ­»ç«¯å£æˆ–è·¯å¾„ã€‚

## ğŸ”„ è¡¥å……æ•´æ”¹è®¡åˆ’ï¼ˆå¢é‡è½å®ï¼‰â­ **å‡çº§ç‰ˆæœ¬**

### Phase 0: ç´§æ€¥æ­¢è¡€æªæ–½ (ç«‹å³æ‰§è¡Œ - 24å°æ—¶å†…)
- ğŸš¨ **Sçº§äºŒè¿›åˆ¶æ–‡ä»¶æ¸…ç†**: ç«‹å³åˆ é™¤`/bin/`ç›®å½•ä¸‹çš„10+ä¸ªå†—ä½™äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»…ä¿ç•™`command-service`å’Œ`query-service`
- ğŸš¨ **JWTé…ç½®ç»Ÿä¸€**: åˆ›å»º`internal/config/jwt.go`ç»Ÿä¸€JWTé…ç½®ï¼Œç«‹å³æ›¿æ¢6ä¸ªæ–‡ä»¶ä¸­çš„é‡å¤å®ç°
- ğŸš¨ **æ—¶æ€æµ‹è¯•è„šæœ¬åˆå¹¶**: å°†20+ä¸ªæ—¶æ€æµ‹è¯•è„šæœ¬ç«‹å³åˆå¹¶ä¸º3ä¸ªæ ¸å¿ƒè„šæœ¬ï¼Œåˆ é™¤å†—ä½™æ–‡ä»¶
- ğŸš¨ **æ¥å£å®šä¹‰å†»ç»“**: ç«‹å³å†»ç»“æ–°å¢ç»„ç»‡ç›¸å…³æ¥å£ï¼Œå¼ºåˆ¶ä½¿ç”¨ç°æœ‰55ä¸ªä¸­çš„æ ¸å¿ƒæ¥å£

### Phase 1: æ ¸å¿ƒé‡å¤æ¶ˆé™¤ (1å‘¨å†…å®Œæˆ)
- GraphQL å•ä¸€çœŸæºï¼šä»¥ `docs/api/schema.graphql` ç”ŸæˆæœåŠ¡ç«¯ Schemaï¼Œç§»é™¤å†…åµŒå­—ç¬¦ä¸²ï¼›CI æ ¡éªŒæ¼‚ç§»ã€‚
- ç»Ÿä¸€ JWT ç»„ä»¶ï¼šæŠ½è±¡ `internal/auth` ä¸ `internal/config/jwt`ï¼ŒNode ä»…å‘å¡ï¼›åˆå¹¶æ ¡éªŒç­–ç•¥ä¸æ—¥å¿—æ ¼å¼ã€‚
- API å®¢æˆ·ç«¯åˆå¹¶ï¼šæ•´åˆ `organizations*.ts`ï¼Œä¿ç•™ä¸€ä¸ªä¸»å…¥å£ä¸è–„åŒ…è£…ï¼›è¿ç§» Hook åˆ°ä¸»å…¥å£ã€‚
- çŠ¶æ€æšä¸¾é›†ä¸­ï¼šå”¯ä¸€å¯¼å‡º `OrganizationStatus`ï¼Œæ›¿æ¢åˆ†å‰å®šä¹‰å¹¶è¡¥é½æ˜ å°„å‡½æ•°æµ‹è¯•ã€‚
- ç«¯å£é…ç½®é›†ä¸­ï¼šåˆ›å»ºç»Ÿä¸€é…ç½®å±‚ï¼Œæ¶ˆé™¤15+ä¸ªæ–‡ä»¶ä¸­çš„ç«¯å£é…ç½®æ•£è½

### Phase 2: æ¶æ„é‡æ„ (2-3å‘¨å†…å®Œæˆ)  
- æ¸…ç†äºŒè¿›åˆ¶ï¼š`.gitignore` å±è”½æ„å»ºç‰©ï¼›å‘å¸ƒäº§ç‰©èµ° Release/Registryã€‚
- SQL ç‰‡æ®µæ”¶æ•›ï¼šæŠ½ `sql/temporal/*.sql` ä¸ä»“å‚¨å±‚è£…é…ï¼›æ–°å¢å›å½’ç”¨ä¾‹è¦†ç›–è¾¹ç•Œã€‚
- è„šæœ¬å…¥å£ç»Ÿä¸€ï¼šä»¥ `make run-dev/test/e2e` ä¸ºå‡†ï¼ŒåºŸå¼ƒé‡å¤è„šæœ¬å¹¶ç•™å‘åå…¼å®¹åˆ«å 1-2 ä¸ªç‰ˆæœ¬ã€‚
- ç±»å‹ç³»ç»Ÿé‡æ„ï¼šå°†55ä¸ªç»„ç»‡æ¥å£å®šä¹‰æ”¶æ•›ä¸º7-8ä¸ªæ ¸å¿ƒæ¥å£
- è®¤è¯ä¸­é—´ä»¶ç»Ÿä¸€ï¼šæ¶ˆé™¤Node.jsä¸Goçš„è®¤è¯é€»è¾‘é‡å¤ï¼Œå»ºç«‹ç»Ÿä¸€è®¤è¯ç½‘å…³

### âœ… Phase 3: é•¿æœŸé˜²æ§ç³»ç»Ÿ â­ **Sçº§å½»åº•å®Œæˆ** (2025-09-07)

**æ‰§è¡Œæ—¶é—´**: 2025-09-07 åŒæ—¥å®Œæ•´å®æ–½  
**æ‰§è¡Œæ–¹å¼**: âœ… **ä¼ä¸šçº§ä¸‰å¤§é˜²æ§ç³»ç»Ÿ** - P3.1+P3.2+P3.3å…¨é¢ä¸Šçº¿  
**ç”¨æˆ·æŒ‡ä»¤**: "æäº¤å…¨éƒ¨æ›´æ”¹ï¼Œç„¶åå®ŒæˆP3å…¨éƒ¨çš„å¼€å‘ä»»åŠ¡"  

#### ğŸ¯ **P3.1 è‡ªåŠ¨åŒ–é‡å¤æ£€æµ‹ç³»ç»Ÿ** âœ… **å®Œæˆ**
- **jscpdé…ç½®**: .jscpdrc.jsonä¼ä¸šçº§æ£€æµ‹é…ç½®ï¼Œ5%é˜ˆå€¼æ ‡å‡†
- **GitHub Actions**: duplicate-code-detection.ymlå…¨è‡ªåŠ¨CI/CDå·¥ä½œæµ
- **æœ¬åœ°è„šæœ¬**: scripts/quality/duplicate-detection.shå¤šèŒƒå›´æ‰«æ
- **éªŒè¯ç»“æœ**: 91æ–‡ä»¶æ‰«æï¼Œ2.11%é‡å¤ç‡ï¼Œè¿œä½äº5%é˜ˆå€¼ âœ…

#### ğŸ—ï¸ **P3.2 æ¶æ„å®ˆæŠ¤è§„åˆ™ç³»ç»Ÿ** âœ… **å®Œæˆ**  
- **ESLintè§„åˆ™**: 3ä¸ªæ ¸å¿ƒæ¶æ„è§„åˆ™ï¼ˆRESTæŸ¥è¯¢ã€ç«¯å£é…ç½®ã€APIå¥‘çº¦ï¼‰
- **æ¶æ„éªŒè¯å™¨**: Node.jsé™æ€åˆ†æå·¥å…·ï¼Œ25ä¸ªè¿è§„ç²¾ç¡®è¯†åˆ«
- **Pre-commit Hook**: Gitæäº¤å‰æ¶æ„ä¸€è‡´æ€§è‡ªåŠ¨éªŒè¯
- **éªŒè¯ç»“æœ**: 91æ–‡ä»¶æ£€æµ‹ï¼Œ25ä¸ªå…³é”®è¿è§„è¯†åˆ«ï¼Œä¼ä¸šçº§æ ‡å‡†ä¸¥æ ¼æ‰§è¡Œ âœ…

#### ğŸ“ **P3.3 æ–‡æ¡£è‡ªåŠ¨åŒæ­¥ç³»ç»Ÿ** âœ… **å®Œæˆ**
- **åŒæ­¥å¼•æ“**: Node.jsæ™ºèƒ½åŒæ­¥ç³»ç»Ÿï¼Œ5ä¸ªæ ¸å¿ƒåŒæ­¥å¯¹
- **GitHub Actions**: document-sync.ymlè‡ªåŠ¨åŒ–æ–‡æ¡£ä¸€è‡´æ€§å·¥ä½œæµ
- **å†²çªæ£€æµ‹**: ç‰ˆæœ¬ã€é…ç½®ã€çŠ¶æ€ã€ä¾èµ–ã€æˆæœå¤šç»´åº¦ç›‘æ§
- **éªŒè¯ç»“æœ**: 5åŒæ­¥å¯¹æ£€æµ‹ï¼Œ8ä¸ªä¸ä¸€è‡´é—®é¢˜è¯†åˆ«ï¼Œ20%æˆåŠŸç‡ï¼ˆé¢„æœŸæ£€æµ‹å€¼ï¼‰ âœ…

#### ğŸ“Š **Phase 3å®ŒæˆæŒ‡æ ‡æ€»ç»“**
- [x] âœ… ç±»å‹å®šä¹‰é›†ä¸­ç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶ - P3.2æ¶æ„å®ˆæŠ¤æ¶µç›–
- [x] âœ… ä»£ç å®¡æŸ¥æ¸…å•æ›´æ–° - P3.2ä¼ä¸šçº§è§„åˆ™é…ç½®å®Œæˆ
- [x] âœ… è‡ªåŠ¨åŒ–é‡å¤æ£€æµ‹CI/CDé›†æˆ - P3.1å®Œæ•´å®æ–½
- [x] âœ… å¼ºåˆ¶æ€§ä»£ç è§„èŒƒå’ŒESLintè§„åˆ™ - P3.2æ¶æ„éªŒè¯å™¨å®ç°  
- [x] âœ… å¼€å‘è€…æ–‡æ¡£å’Œæœ€ä½³å®è·µæŒ‡å— - P3.3æ–‡æ¡£åŒæ­¥æœºåˆ¶ä¿éšœ

---

## ğŸ“ åŸºçº¿ä¸åº¦é‡æ–¹æ³•ï¼ˆæ–°å¢ï¼‰

ä¸ºé¿å…â€œæ‹è„‘è¢‹çš„ç™¾åˆ†æ¯”â€å’Œä¸å¯å¤æ ¸çš„æ•ˆæœé™ˆè¿°ï¼Œå»ºç«‹ç»Ÿä¸€çš„å¯åº¦é‡åŸºçº¿ä¸è¿½è¸ªæœºåˆ¶ï¼š

- åº¦é‡å·¥å…·ä¸å£å¾„
  - é‡å¤ä»£ç æ£€æµ‹ï¼šjscpdï¼ˆæ’é™¤ç”Ÿæˆä»£ç ä¸ç¬¬ä¸‰æ–¹ç›®å½•ï¼‰
  - æ— ç”¨å¯¼å‡º/ç±»å‹æ•£è½ï¼šts-pruneï¼ˆç»Ÿè®¡æœªå¼•ç”¨çš„å¯¼å‡ºé¡¹ä¸ç±»å‹å®šä¹‰å†—ä½™ï¼‰
  - ä¾èµ–æ‹“æ‰‘ä¸å¤šå®ç°ï¼šdependency-cruiserï¼ˆæ£€æµ‹å¤šå…¥å£å®¢æˆ·ç«¯ã€è·¨å±‚ç›´è¿ fetchï¼‰
  - æµ‹è¯•æ‰§è¡Œæ—¶é—´ï¼šPlaywright/Jest åŸç”Ÿ timing + CI å·¥ä»¶

- åŸºçº¿é‡‡é›†ï¼ˆWeek 0ï¼‰
  - ç”Ÿæˆâ€œé‡å¤ä»£ç å‘¨æŠ¥ï¼ˆHTML/JSONï¼‰â€å¹¶å½’æ¡£åˆ° `test-results/dup-report/`ï¼ˆä½œä¸ºå¯¹æ¯”åŸºçº¿ï¼‰
  - è¾“å‡ºâ€œæ¥å£/ç±»å‹æ¸…å•â€ä¸â€œAPI å®¢æˆ·ç«¯å¼•ç”¨æ¸…å•â€ï¼ˆå‘½åä»¥ Organization* è¿‡æ»¤ï¼‰ï¼Œå½’æ¡£åˆ° `docs/reports/`
  - è®°å½• E2E å¥—ä»¶ç”¨æ—¶ï¼ˆæŒ‰æ–‡ä»¶ç²’åº¦ï¼‰å¹¶äº§å‡º Top-N æœ€æ…¢ç”¨ä¾‹

- é˜ˆå€¼ï¼ˆCI é—¨ç¦ï¼‰
  - é‡å¤ä»£ç å æ¯”ï¼ˆjscpdï¼‰ï¼šåˆæœŸå…è®¸ â‰¤ 12%ï¼Œæ¯å‘¨ -1%ï¼Œç›®æ ‡ â‰¤ 10%ï¼ˆPhase 2 è¾¾æˆï¼‰
  - ç›´è¿ fetch/axios è¿è§„ï¼š0 å®¹å¿ï¼ˆä¸€æ¬¡å³å¤±è´¥ï¼‰ï¼Œå¿…é¡»ä½¿ç”¨ `shared/api/unified-client.ts`
  - Hook ä¸ API å®¢æˆ·ç«¯å®ç°æ•°é‡ï¼šæŒ‰â€œç™½åå•â€æ ¡éªŒï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œè¶…å‡ºå³å¤±è´¥
  - E2E æ–‡ä»¶æ•°ï¼šæ—¶æ€åœºæ™¯é™å®š 1 ä¸ªä¸»æ–‡ä»¶ï¼Œå…¶ä½™åˆå¹¶/åˆ é™¤ï¼ˆåˆå¹¶æœŸå†…å…è®¸ 2 å‘¨ç°åº¦ï¼‰

---

## ğŸ”’ CI é—¨ç¦ä¸è§„èŒƒï¼ˆæ–°å¢ï¼‰

- ESLint è§„åˆ™ï¼ˆæˆ–è‡ªå®šä¹‰ ruleï¼‰ï¼š
  - ç¦æ­¢ç›´æ¥ `fetch/axios`ï¼Œå¿…é¡»è°ƒç”¨ç»Ÿä¸€å®¢æˆ·ç«¯å¯¼å‡ºï¼›è¿è§„ PR å¤±è´¥
  - ç»„ç»‡åŸŸ Hook åªå…è®¸ï¼š`useEnterpriseOrganizations` ä¸ `useOrganizationList` ç”± `shared/hooks/index.ts` ç»Ÿä¸€å¯¼å‡º
  - ç»„ç»‡ç±»å‹å®šä¹‰é›†ä¸­åœ¨ `shared/types/organization.ts`ã€`shared/types/api.ts`ï¼Œç¦æ­¢éšæ„æ–°å¢é‡å¤æ¥å£

- PR æ£€æŸ¥æ¸…å•ï¼ˆè‡ªåŠ¨åŒ– + äººå·¥ï¼‰ï¼š
  - æ˜¯å¦æ–°å¢äº†ç¬¬äºŒä¸ªåŒç±» Hook/å®¢æˆ·ç«¯/ç±»å‹å®šä¹‰ï¼Ÿï¼ˆè„šæœ¬æ ¸å¯¹ + code review æ˜ç¡®é¡¹ï¼‰
  - æ˜¯å¦ä¿®æ”¹/æ–°å¢ç›´è¿ fetchï¼Ÿï¼ˆeslint æ£€æµ‹ï¼‰
  - æ˜¯å¦æ›´æ–°äº†æŒ‡æ ‡æŠ¥è¡¨ä¸è¿ç§»æ¸…å•ï¼Ÿï¼ˆå¿…éœ€äº§ç‰©ï¼‰

- jscpd/ts-prune/depcruise çš„ GitHub Actions jobï¼š
  - å¤±è´¥é˜ˆå€¼ä¸å¯è±å…æ ‡ç­¾ï¼ˆéœ€é™„åŸå› ã€è´Ÿè´£äººä¸é¢„è®¡æ¸…ç†æ—¶é—´ â‰¤ 2 å‘¨ï¼‰

---

## ğŸ›¡ï¸ CI å®ˆæŠ¤è½åœ°ï¼ˆæ–°å¢ï¼‰

ä¸ºé¿å…ä¸€æ¬¡æ€§å¼ºåˆ¶å¯¼è‡´ç°å­˜ä»£ç å¤§é¢ç§¯å¤±è´¥ï¼Œä»¥ä¸‹å®ˆæŠ¤è„šæœ¬æš‚è®¾ä¸ºâ€œæŠ¥å‘Šæ¨¡å¼â€ï¼ˆENFORCE=0ï¼‰ï¼Œåç»­æŒ‰æ¨¡å—é€æ­¥åˆ‡æ¢ä¸ºä¸¥æ ¼æ¨¡å¼ã€‚

- å·¥ä½œæµï¼š`.github/workflows/consistency-guard.yml`
- è„šæœ¬ï¼š
  - `scripts/ci/check-permissions.sh`ï¼ˆæ‰«æ `org:write` ç­‰è¿‡æ—¶æƒé™ï¼Œæ”¯æŒ ENFORCEï¼‰
  - `scripts/ci/check-rest-queries.sh`ï¼ˆå‰ç«¯ REST æŸ¥è¯¢è·¯å¾„æ‰«æï¼Œæ”¯æŒ ENFORCEï¼‰
  - `scripts/ci/check-hardcoded-configs.sh`ï¼ˆCORS/ç«¯å£/ç§Ÿæˆ·å¤´ç¡¬ç¼–ç æ‰«æï¼Œæ”¯æŒ ENFORCEï¼‰

åˆ‡æ¢ç­–ç•¥ï¼š
- Phase 1ï¼šæŠ¥å‘Šæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰â†’ ä¿®å¤é«˜é¢‘é—®é¢˜ï¼›
- Phase 2ï¼šå…³é”®ç›®å½•å¯ç”¨ ENFORCE=1ï¼ˆå·²å¯ç”¨ï¼šfrontend/src çš„ REST æŸ¥è¯¢å®ˆæŠ¤ï¼›cmd/* çš„ CORS/JWT inline/ç«¯å£å®ˆæŠ¤ï¼‰ï¼›
- Phase 3ï¼šå…¨ä»“åº“å¯ç”¨ ENFORCE=1ã€‚

è§¦å‘æ¡ä»¶ï¼ˆåŒæ­¥åˆ°æµç¨‹é…ç½®ï¼‰
- pushï¼šä»»æ„åˆ†æ”¯ï¼ˆbranches: "**"ï¼‰ï¼Œæ”¯æŒ tag è§¦å‘ï¼ˆtags: "*")
- pull_requestï¼šä»»æ„ç›®æ ‡åˆ†æ”¯ï¼ˆbranches: "**"ï¼‰
- workflow_dispatchï¼šæ”¯æŒæ‰‹åŠ¨è§¦å‘
- releaseï¼špublished/created/edited/prereleased å››ç±»äº‹ä»¶


## ğŸ—„ï¸ åç«¯ä¸é€šç”¨å±‚é‡å¤æ²»ç†ï¼ˆæ–°å¢ï¼‰

ä¸ºå½¢æˆç«¯åˆ°ç«¯ä¸€è‡´æ€§ï¼Œæ‰©å±•æ²»ç†èŒƒå›´è‡³åç«¯ä¸è„šæœ¬å±‚ï¼š

- æ‰«æå¯¹è±¡
  - Handler/Service/Repository/Validator/DTO æ˜ å°„æ˜¯å¦å­˜åœ¨å¹¶è¡Œæˆ–é‡å¤å®ç°
  - å†å²è„šæœ¬ï¼ˆ`scripts/`ï¼‰ä¸­ä¸ç»„ç»‡åŸŸç›¸å…³çš„é‡å¤æ ¡éªŒ/å¯¼å…¥/è½¬æ¢é€»è¾‘
  - ä¸­é—´å±‚ï¼ˆå¦‚ GraphQL Resolverï¼‰æ˜¯å¦ä¸ REST å±‚å­˜åœ¨é‡å¤æ ¡éªŒ/è½¬æ¢

- ç»Ÿä¸€ç­–ç•¥
  - DTO/éªŒè¯ï¼šé›†ä¸­åˆ°å•å¤„ï¼ˆåç«¯ internal/{validators,types}ï¼‰ï¼Œç¦æ­¢æ¨ªå‘å¤åˆ¶
  - è½¬æ¢ä¸æ˜ å°„ï¼šæä¾›å•ä¸€è½¬æ¢å™¨/é€‚é…å™¨ï¼ˆRESTâ†”GraphQLâ†”TS ç±»å‹ï¼‰å¹¶è¢«å‰ç«¯/åç«¯å¤ç”¨
  - å¤ç”¨ä¼˜å…ˆï¼šåç«¯æš´éœ²å¥‘çº¦â†’ä»£ç ç”Ÿæˆâ†’å‰ç«¯ç±»å‹/å®¢æˆ·ç«¯å¤ç”¨ï¼Œç¦æ­¢æ‰‹å†™é‡å¤ç±»å‹

---

## ğŸ†• æ–°å¢å‘ç°ï¼ˆä¸‰ï¼‰â€” ä¸€è‡´æ€§/å”¯ä¸€æ€§ä¸“é¡¹è¡¥å……

### A. æƒé™å‘½ååˆ†å‰ï¼ˆorg:write vs org:updateï¼‰ â­ Açº§
è¯æ®: Node ä»¤ç‰Œä¸ç¤ºä¾‹ä»ä½¿ç”¨ org:writeï¼›OpenAPI/CLAUDE.md è§„èŒƒç»Ÿä¸€ä¸º org:create/org:update/org:deleteã€‚  
é£é™©: ç½‘å…³/å‰ç«¯/åç«¯æƒé™åˆ¤æ–­åˆ†å‰ã€‚  
æ•´æ”¹: ç»Ÿä¸€é‡‡ç”¨ create/update/deleteï¼›æä¾›è¿‡æ¸¡æœŸæ˜ å°„å¹¶å‘å‡ºå¼ƒç”¨å‘Šè­¦ã€‚

### B. é»˜è®¤ç§Ÿæˆ·IDç¡¬ç¼–ç æ•£è½ â­ Açº§
è¯æ®: å¤šä¸ª SQL/è„šæœ¬/æµ‹è¯•/å‰ç«¯ä¸ Go ä»£ç ç›´æ¥å†™æ­» `3b99930c-...`ï¼Œä¸”å‰ç«¯ç»Ÿä¸€å®¢æˆ·ç«¯é»˜è®¤è®¾ç½® `X-Tenant-ID`ã€‚  
é£é™©: å¤šç¯å¢ƒ/å¤šç§Ÿæˆ·åˆ‡æ¢å›°éš¾ï¼Œæµ‹è¯•ä¸ç”Ÿäº§æ··æ·†ã€‚  
æ•´æ”¹: `.env` + `internal/config/tenant` ä¸ºå•ä¸€çœŸæºï¼›å‰ç«¯ä» OAuth token/é…ç½®è·å–ï¼Œç¦æ­¢ç¡¬ç¼–ç ã€‚

### C. CORS é…ç½®å¤šæºé‡å¤ â­ Bçº§
è¯æ®: Go/Node æœåŠ¡å†…ä¸éƒ¨ç½²è„šæœ¬åˆ†åˆ«ç»´æŠ¤ AllowedOriginsã€‚  
é£é™©: æ›´æ–°é—æ¼å¯¼è‡´è·¨åŸŸå¼‚å¸¸æˆ–æ”¾å¼€è¿‡åº¦ã€‚  
æ•´æ”¹: `.env CORS_ALLOWED_ORIGINS` å•ä¸€çœŸæºï¼Œå¯åŠ¨æ—¶è§£æï¼ŒCI æ ¡éªŒä¸€è‡´æ€§ã€‚

### D. æŸ¥è¯¢åŒè·¯å¾„ï¼ˆREST ä¸ GraphQL å¹¶å­˜ï¼‰è¿èƒŒ CQRS â­ Açº§ï¼ˆå¼ºè°ƒï¼‰
è¯æ®: `shared/api/organizations.ts` é€šè¿‡ REST æŸ¥è¯¢ä¸ GraphQL å®¢æˆ·ç«¯å¹¶å­˜ï¼ˆå‚è§â€œ9. å‰ç«¯ API å®¢æˆ·ç«¯ä¸ Hook äº¤å‰é‡å¤â€ï¼‰ã€‚  
æ•´æ”¹: ä»…ä¿ç•™ GraphQL æŸ¥è¯¢è·¯å¾„ï¼ŒREST ä»…ç”¨äºå‘½ä»¤ï¼›æ·»åŠ  Lint ç¦ç›´æ¥ REST æŸ¥è¯¢ã€‚

### E. ç»„ä»¶å†…ä¸´æ—¶å®¢æˆ·ç«¯ä¸ç±»å‹é‡å¤ â­ Açº§ï¼ˆå¼ºè°ƒï¼‰
è¯æ®: `frontend/OrganizationComponents.tsx` å†…è”å®šä¹‰ `OrganizationAPI` ä¸ç±»å‹ï¼Œå·²è¢« ESLint æŠ¥å‘Šã€‚  
æ•´æ”¹: ä¸¥ç¦åœ¨ç»„ä»¶å†…å®šä¹‰ API å®¢æˆ·ç«¯ä¸ç±»å‹ï¼Œç»Ÿä¸€ä» `shared/api` ä¸ `shared/types` å¼•ç”¨ã€‚

### F. ç¯å¢ƒé…ç½®æ–‡ä»¶è¿‡åº¦åˆ†æ•£ â­ Açº§ï¼ˆæ–°å‘ç°ï¼‰
è¯æ®: å‘ç°7ä¸ªä¸åŒçš„é…ç½®æ–‡ä»¶å±‚æ¬¡ï¼Œé…ç½®é¡¹é‡å¤ä¸”å€¼å¯èƒ½ä¸ä¸€è‡´ï¼š
```bash
.env                          # å¼€å‘ç¯å¢ƒé…ç½®
.env.example                  # ç¤ºä¾‹é…ç½®æ¨¡æ¿
.env.production              # ç”Ÿäº§ç¯å¢ƒé…ç½®
docker-compose.yml           # åŸºç¡€Dockeré…ç½®
docker-compose.dev.yml       # å¼€å‘Dockeré…ç½®
monitoring/docker-compose.monitoring.yml  # ç›‘æ§é…ç½®
frontend/vite.config.ts      # å‰ç«¯æ„å»ºé…ç½®
```
é£é™©: å¤šç¯å¢ƒé…ç½®ä¸åŒæ­¥ï¼Œç«¯å£/æœåŠ¡åœ°å€å†²çªï¼Œéƒ¨ç½²æ—¶é…ç½®æ¼‚ç§»ã€‚  
æ•´æ”¹: å»ºç«‹é…ç½®å±‚æ¬¡ç®¡ç†ï¼Œç»Ÿä¸€ `.env` ä¸ºé…ç½®æºï¼ŒDockeré…ç½®ä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œé¿å…ç¡¬ç¼–ç ã€‚

### G. ç§Ÿæˆ·IDç¡¬ç¼–ç ç¨‹åº¦è¶…é¢„æœŸ â­ Sçº§ï¼ˆä¸¥é‡æ¶åŒ–ï¼‰
è¯æ®: æ·±åº¦æ‰«æå‘ç°ç§Ÿæˆ·ID `3b99930c-...` ç¡¬ç¼–ç åˆ†å¸ƒæ¯”é¢„æœŸæ›´å¹¿æ³›ï¼š
```bash
# æ•°æ®åº“åˆå§‹åŒ–å±‚é¢
sql/init/01-schema.sql               # åˆå§‹åŒ–æ•°æ®
sql/init/02-sample-data.sql         # æ ·æœ¬æ•°æ®
database/maintenance/*.sql          # ç»´æŠ¤è„šæœ¬

# å‰ç«¯åº”ç”¨å±‚é¢
frontend/src/shared/api/unified-client.ts     # APIå®¢æˆ·ç«¯é»˜è®¤ç§Ÿæˆ·
frontend/src/features/audit/components/*.tsx  # å®¡è®¡ç»„ä»¶

# åç«¯è„šæœ¬å±‚é¢
scripts/generate-dev-jwt.go         # JWTç”Ÿæˆè„šæœ¬
scripts/temporal-e2e-validate.sh    # E2EéªŒè¯è„šæœ¬
e2e-test.sh                         # ä¸»E2Eæµ‹è¯•
```
é£é™©: å¤šç§Ÿæˆ·æ”¯æŒå®Œå…¨å¤±æ•ˆï¼Œæµ‹è¯•ä¸ç”Ÿäº§ç¯å¢ƒæ•°æ®æ··æ·†ï¼Œæ‰©å±•æ€§ä¸¥é‡å—é™ã€‚  
æ•´æ”¹: ç«‹å³å»ºç«‹ `internal/config/tenant.go` ä¸ `frontend/src/shared/config/tenant.ts` ç»Ÿä¸€ç®¡ç†ï¼Œç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç ã€‚

### H. CORSç­–ç•¥å¤šç‚¹ç»´æŠ¤å®‰å…¨é£é™© â­ Açº§ï¼ˆæ–°å‘ç°ï¼‰
è¯æ®: CORSé…ç½®åˆ†æ•£åœ¨7ä¸ªä¸åŒæ–‡ä»¶ä¸­ï¼Œç­–ç•¥ä¸ç»Ÿä¸€ï¼š
```bash
cmd/oauth-service/main.js                    # OAuthæœåŠ¡CORS
frontend/src/shared/api/unified-client.ts    # å‰ç«¯APIå®¢æˆ·ç«¯
frontend/src/shared/api/auth.ts             # è®¤è¯å®¢æˆ·ç«¯
deploy-production.sh                         # ç”Ÿäº§éƒ¨ç½²è„šæœ¬
scripts/test-e2e-integration.sh             # E2Eæµ‹è¯•è„šæœ¬
scripts/test-stage-four-business-logic.sh   # ä¸šåŠ¡é€»è¾‘æµ‹è¯•
scripts/test-api-integration.sh             # APIé›†æˆæµ‹è¯•
```
é£é™©: CORSç­–ç•¥ä¸ä¸€è‡´å¯¼è‡´è·¨åŸŸé—®é¢˜ï¼Œæˆ–è¿‡åº¦å¼€æ”¾çš„å®‰å…¨é£é™©ã€‚  
æ•´æ”¹: ç»Ÿä¸€ `.env CORS_ALLOWED_ORIGINS` é…ç½®ï¼Œæ‰€æœ‰æœåŠ¡å¯åŠ¨æ—¶è¯»å–ï¼ŒCIéªŒè¯ç­–ç•¥ä¸€è‡´æ€§ã€‚

### I. ç›‘æ§é…ç½®ç‹¬ç«‹ç»´æŠ¤æ¶æ„åˆ†å‰ â­ Bçº§ï¼ˆæ–°å‘ç°ï¼‰
è¯æ®: `monitoring/docker-compose.monitoring.yml` ç‹¬ç«‹ç»´æŠ¤ç«¯å£å’ŒæœåŠ¡é…ç½®ï¼Œä¸ä¸»é…ç½®å¯èƒ½ä¸åŒæ­¥ã€‚  
é£é™©: ç›‘æ§ç³»ç»Ÿä¸ä¸»ç³»ç»Ÿç«¯å£å†²çªï¼Œç›‘æ§é…ç½®æ›´æ–°æ»åã€‚  
æ•´æ”¹: å°†ç›‘æ§é…ç½®çº³å…¥ä¸»é…ç½®ç®¡ç†ä½“ç³»ï¼Œå…±äº«ç«¯å£é…ç½®å±‚ã€‚

---

## â–¶ è¡¥å……æ‰§è¡Œæ¸…å•â­ **æ‰©å±•ç‰ˆæœ¬**
- æƒé™å¸¸é‡é›†ä¸­ï¼šæ–°å¢æƒé™æšä¸¾ä¸æ˜ å°„è¡¨ï¼›CI æ‹¦æˆª `org:write` ç­‰æ—§å€¼å¹¶ç»™å‡ºæ›¿æ¢å»ºè®®ã€‚
- ç§Ÿæˆ·ä¸ CORS é…ç½®é›†ä¸­ï¼šæ–°å¢ `internal/config` ä¸ `frontend/src/shared/config.ts`ï¼›ç§»é™¤ç¡¬ç¼–ç é»˜è®¤å€¼ä¸è¯·æ±‚å¤´å†™æ­»ã€‚
- CQRS å¼ºåˆ¶ï¼šESLint è§„åˆ™ç¦æ­¢ REST æŸ¥è¯¢ï¼›è¿ç§»æ¸…å•è¦†ç›–æ‰€æœ‰ `shared/api/organizations.ts` æŸ¥è¯¢è°ƒç”¨ç‚¹ã€‚
- å®¢æˆ·ç«¯æ•´åˆï¼šç»Ÿä¸€ä¾èµ– `unified-client.ts`ï¼›`client.ts/organizations.ts` æ ‡è®° deprecated å¹¶è¾“å‡ºè¿è¡Œæ—¶å‘Šè­¦ã€‚
- **é…ç½®æ–‡ä»¶å±‚æ¬¡æ²»ç†**: å»ºç«‹7ä¸ªé…ç½®æ–‡ä»¶çš„ç»Ÿä¸€ç®¡ç†æœºåˆ¶ï¼Œæ¶ˆé™¤ç«¯å£/åœ°å€é…ç½®å†²çª
- **ç§Ÿæˆ·IDå»ç¡¬ç¼–ç **: Sçº§ç´§æ€¥ä»»åŠ¡ï¼Œå»ºç«‹ç»Ÿä¸€ç§Ÿæˆ·é…ç½®ç®¡ç†ï¼Œæ”¯æŒçœŸæ­£çš„å¤šç§Ÿæˆ·æ¶æ„
- **CORSç­–ç•¥ç»Ÿä¸€**: æ¶ˆé™¤7ä¸ªæ–‡ä»¶ä¸­çš„CORSé…ç½®åˆ†æ•£ï¼Œå»ºç«‹å®‰å…¨ç­–ç•¥ä¸€è‡´æ€§
- **ç›‘æ§é…ç½®é›†æˆ**: å°†ç‹¬ç«‹çš„ç›‘æ§é…ç½®çº³å…¥ä¸»é…ç½®ä½“ç³»ï¼Œé¿å…æ¶æ„åˆ†å‰

---

## ğŸ§­ æ‰§è¡Œä»»åŠ¡æ‹†è§£æ¸…å•ï¼ˆå«è·¯å¾„ä¸è´Ÿè´£äººï¼‰

è¯´æ˜ï¼šOwner ä½¿ç”¨è§’è‰²å ä½ç¬¦ï¼Œè½åœ°æ—¶åœ¨é¡¹ç›®çœ‹æ¿æ˜ å°„ä¸ºå…·ä½“è´Ÿè´£äººã€‚

1) GraphQL å•ä¸€çœŸæºï¼ˆSï¼‰ [çŠ¶æ€: è¿›è¡Œä¸­]
- ä»»åŠ¡ï¼šç§»é™¤ `cmd/organization-query-service/main.go` å†… `schemaString`ï¼Œæ”¹ä¸ºåŠ è½½ `docs/api/schema.graphql`
  - Paths: `cmd/organization-query-service/main.go`, `docs/api/schema.graphql`, `internal/graphql/schema_loader.go`(æ–°å¢)
  - Owner: Backend-Go (@backend)
- ä»»åŠ¡ï¼šCI æ ¡éªŒ Schema æ¼‚ç§»ï¼ˆæ–‡æ¡£ vs è¿è¡Œæ—¶/ç”Ÿæˆç‰©ï¼‰
  - Paths: `.github/workflows/contract-check.yml`(æ–°å¢), `scripts/check-api-naming.sh`
  - Owner: DevOps (@devops)

2) JWT é…ç½®ç»Ÿä¸€ï¼ˆSï¼‰ [çŠ¶æ€: è¿›è¡Œä¸­]
- ä»»åŠ¡ï¼šæŠ½è±¡ç»Ÿä¸€é…ç½®ä¸ä¸­é—´ä»¶
  - Paths: `internal/config/jwt.go`(æ–°å¢), `internal/auth/middleware.go`(æ–°å¢)
  - Owner: Security/Backend (@security, @backend)
- ä»»åŠ¡ï¼šæ›¿æ¢é‡å¤å®ç°
  - Paths: `cmd/organization-command-service/main.go`, `cmd/organization-query-service/main.go`, `scripts/temporal_test_runner.go`, `scripts/cqrs_integration_runner.go`, `tests/temporal-function-test.go`
  - Owner: Backend (@backend)

3) å‰ç«¯å®¢æˆ·ç«¯/Hook æ”¶æ•›ï¼ˆAï¼‰ [çŠ¶æ€: è¿›è¡Œä¸­]
- ä»»åŠ¡ï¼šåªä¿ç•™ GraphQL æŸ¥è¯¢è·¯å¾„ï¼›REST ä»…å‘½ä»¤
  - Paths: `frontend/src/shared/api/organizations.ts`(æ ‡è®°å¼ƒç”¨æŸ¥è¯¢æ–¹æ³•), `frontend/src/shared/api/organizations-enterprise.ts`, `frontend/src/shared/api/unified-client.ts`
  - Owner: Frontend (@frontend)
- ä»»åŠ¡ï¼šä¸» Hook åˆå¹¶
  - Paths: `frontend/src/shared/hooks/useEnterpriseOrganizations.ts`, `frontend/src/shared/hooks/useOrganizations.ts`, `frontend/src/features/organizations/hooks/*`
  - Owner: Frontend (@frontend)
- ä»»åŠ¡ï¼šLint ç¦æ­¢ç›´è¿ fetch/axios
  - Paths: `frontend/.eslintrc.*`, `frontend/package.json`
  - Owner: Frontend/Tooling (@frontend, @devops)

4) çŠ¶æ€æšä¸¾ä¸€è‡´æ€§ï¼ˆAï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼šé›†ä¸­å¯¼å‡º `OrganizationStatus`
  - Paths: `frontend/src/shared/types/organization.ts`(æƒå¨), æ›¿æ¢ `frontend/src/shared/utils/statusUtils.ts`, `frontend/src/shared/types/api.ts`, ä»¥åŠç»„ä»¶ä½¿ç”¨ç‚¹
  - Owner: Frontend (@frontend)

5) äºŒè¿›åˆ¶äº§ç‰©æ¸…ç†ä¸å‘½åï¼ˆAï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼šåŠ å…¥å¿½ç•¥ä¸æ¸…ç†è®¡åˆ’ï¼ˆä¸ç«‹å³åˆ é™¤å†å²äº§ç‰©ï¼‰
  - Paths: `.gitignore`(æ›´æ–°), `bin/*`(è¿½è¸ªæ¸…å•), æ ¹ç›®å½•äºŒè¿›åˆ¶ï¼š`organization-command-service`, `postgresql-graphql-service`, `cmd-service`
  - Owner: DevOps (@devops)

6) æ—¶æ€ SQL æ¨¡æ¿æ”¶æ•›ï¼ˆBï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼šæŠ½å–å…¬å…± SQL ç‰‡æ®µ
  - Paths: `internal/repository/sql/temporal/*.sql`(æ–°å¢), ç›¸å…³ repository è°ƒç”¨ç‚¹
  - Owner: Backend/DBA (@backend, @dba)

7) ç«¯å£/åŸºç¡€é…ç½®é›†ä¸­ï¼ˆBï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼šç»Ÿä¸€ç«¯å£ä¸åŸºç¡€è·¯å¾„é…ç½®å±‚
  - Paths: `internal/config/service.go`(æ–°å¢), `cmd/*/main.go`(æ›¿æ¢), `deploy-*.sh`, `docker-compose*.yml`
  - Owner: Backend/DevOps (@backend, @devops)
- ä»»åŠ¡ï¼šCI æ‰«æç¡¬ç¼–ç ç«¯å£
  - Paths: `.github/workflows/static-scan.yml`(æ–°å¢), `scripts/check-hardcoded-ports.sh`(æ–°å¢)
  - Owner: DevOps (@devops)

8) æƒé™å‘½åç»Ÿä¸€ï¼ˆAï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼šæ›¿æ¢ org:write â†’ org:updateï¼Œå¹¶è¡¥é½ org:create
  - Paths: `middleware/auth.js`, `cmd/oauth-service/main.js`, `docs/api/openapi.yaml`, `docs/api/schema.graphql`, `frontend/src/shared/utils/organizationPermissions.ts`
  - Owner: Security/Backend/Frontend (@security, @backend, @frontend)

9) ç§Ÿæˆ· ID ç®¡ç†ï¼ˆAï¼‰ [çŠ¶æ€: è¿›è¡Œä¸­]
- ä»»åŠ¡ï¼šç§»é™¤ç¡¬ç¼–ç ç§Ÿæˆ·ï¼Œç»Ÿä¸€ä»é…ç½®/Token æ³¨å…¥
  - Paths: `frontend/src/shared/api/unified-client.ts`, `sql/init/*.sql`, `scripts/*`, `tests/*`
  - Owner: Frontend/DBA/QA (@frontend, @dba, @qa)

10) CORS é…ç½®é›†ä¸­ï¼ˆBï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼š.env çœŸæº + æœåŠ¡è§£æ
  - Paths: `.env.example`(æ–°å¢é”® `CORS_ALLOWED_ORIGINS`), `cmd/*/main.go`, `cmd/oauth-service/main.js`, `PRODUCTION-DEPLOYMENT-GUIDE.md`
  - Owner: Backend/DevOps/Docs (@backend, @devops, @docs)

11) æ—¶æ€æµ‹è¯•æ•´åˆï¼ˆSï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼šåˆå¹¶åˆ° 3 ä¸ªæ ¸å¿ƒæ–‡ä»¶å¹¶æ›´æ–°æ‰§è¡Œè„šæœ¬
  - Paths: `frontend/tests/e2e/*temporal*.spec.ts`, `run-e2e-tests.sh`, `tests/temporal-test-report.md`
  - Owner: QA/Frontend (@qa, @frontend)

12) Dev Token å•ä¸€å…¥å£ï¼ˆBï¼‰ [çŠ¶æ€: æœªå¼€å§‹]
- ä»»åŠ¡ï¼šä¿ç•™ OAuth Service ä½œä¸ºå”¯ä¸€ç­¾å‘ç«¯
  - Paths: `cmd/oauth-service/main.js`, `scripts/generate-dev-jwt.go`(æ ‡è®°å¼ƒç”¨), `docs/development-guides/jwt-development-guide.md`
  - Owner: Security (@security)

13) é…ç½®æ–‡ä»¶å±‚æ¬¡æ²»ç†ï¼ˆAï¼‰â­ **æ–°å¢ä»»åŠ¡**
- ä»»åŠ¡ï¼šå»ºç«‹7ä¸ªé…ç½®æ–‡ä»¶çš„ç»Ÿä¸€ç®¡ç†ä½“ç³»
  - Paths: `.env`(ä¸»é…ç½®), `.env.example`, `.env.production`, `docker-compose.yml`, `docker-compose.dev.yml`, `monitoring/docker-compose.monitoring.yml`, `frontend/vite.config.ts`
  - Owner: DevOps/Backend (@devops, @backend)
- ä»»åŠ¡ï¼šCIéªŒè¯é…ç½®ä¸€è‡´æ€§ï¼Œé¿å…ç«¯å£å†²çª
  - Paths: `.github/workflows/config-validation.yml`(æ–°å¢), `scripts/validate-config-consistency.sh`(æ–°å¢)
  - Owner: DevOps (@devops)

14) ç§Ÿæˆ·IDå»ç¡¬ç¼–ç ç»Ÿä¸€ç®¡ç†ï¼ˆSï¼‰â­ **Sçº§æ–°å¢ä»»åŠ¡**
- ä»»åŠ¡ï¼šç§»é™¤10+ä¸ªæ–‡ä»¶ä¸­çš„ç§Ÿæˆ·IDç¡¬ç¼–ç 
  - Paths: `sql/init/*.sql`, `frontend/src/shared/api/unified-client.ts`, `frontend/src/features/audit/components/*.tsx`, `scripts/generate-dev-jwt.go`, `scripts/temporal-e2e-validate.sh`, `e2e-test.sh`
  - Owner: Full-Stack/DBA (@frontend, @backend, @dba)
- ä»»åŠ¡ï¼šå»ºç«‹ç»Ÿä¸€ç§Ÿæˆ·é…ç½®ç®¡ç†
  - Paths: `internal/config/tenant.go`(æ–°å¢), `frontend/src/shared/config/tenant.ts`(æ–°å¢), `.env.example`(æ–°å¢TENANTé…ç½®)
  - Owner: Backend/Frontend (@backend, @frontend)

15) CORSç­–ç•¥ç»Ÿä¸€æ²»ç†ï¼ˆAï¼‰â­ **æ–°å¢ä»»åŠ¡**
- ä»»åŠ¡ï¼šæ¶ˆé™¤7ä¸ªæ–‡ä»¶ä¸­çš„CORSé…ç½®åˆ†æ•£
  - Paths: `cmd/oauth-service/main.js`, `frontend/src/shared/api/*.ts`, `deploy-production.sh`, `scripts/test-*.sh`
  - Owner: Security/Backend/DevOps (@security, @backend, @devops)
- ä»»åŠ¡ï¼šå»ºç«‹ç»Ÿä¸€CORSé…ç½®æº
  - Paths: `.env.example`(æ–°å¢CORS_ALLOWED_ORIGINS), `internal/config/cors.go`(æ–°å¢), CIéªŒè¯è„šæœ¬
  - Owner: Security (@security)

16) ç›‘æ§é…ç½®é›†æˆç»Ÿä¸€ï¼ˆBï¼‰â­ **æ–°å¢ä»»åŠ¡**
- ä»»åŠ¡ï¼šå°†ç›‘æ§é…ç½®çº³å…¥ä¸»é…ç½®ä½“ç³»
  - Paths: `monitoring/docker-compose.monitoring.yml`, ä¸»é…ç½®æ–‡ä»¶é›†æˆ
  - Owner: DevOps/Monitoring (@devops, @monitoring)

äº¤ä»˜äº§ç‰©ä¸éªŒæ”¶â­ **æ‰©å±•ç‰ˆæœ¬**
- æ¯é¡¹ä»»åŠ¡é™„å¸¦è¿ç§»æ¸…å•ä¸æ”¹åŠ¨è·¯å¾„åˆ—è¡¨ã€One-pager å½±å“è¯´æ˜ã€å›æ»šç­–ç•¥ã€‚
- CI é€šè¿‡ï¼šAPI å¥‘çº¦æ ¡éªŒã€Lintã€é‡å¤æ‰«æã€E2E æœ€å°é›†é€šè¿‡ã€‚

---

## ğŸ“Œ ç°çŠ¶æ ¸å¯¹ä¸æ ¡å‡†ï¼ˆ2025-09-07ï¼‰

æœ¬èŠ‚å¯¹ç…§æœ¬è®¡åˆ’ä¸å®é™…ä»“åº“ç°çŠ¶ï¼Œæ ‡æ³¨ä¸€è‡´æ€§ä¸éœ€è¦æ›´æ­£ä¹‹å¤„ã€‚

ä¸€è‡´ï¼ˆé—®é¢˜ä»å­˜åœ¨ï¼‰
- äºŒè¿›åˆ¶äº§ç‰©å†—ä½™ï¼š`bin/` ä¸ä»“åº“æ ¹ä»å­˜åœ¨å¤šä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚ `bin/server`ã€`bin/query-service`ã€æ ¹ç›®å½• `organization-command-service` ç­‰ï¼‰ã€‚
- CORS å¤šæºé…ç½®ï¼šGo ä¸ Node æœåŠ¡å„è‡ªç»´æŠ¤ AllowedOriginsï¼›éƒ¨ç½²è„šæœ¬ä¹Ÿæœ‰å•ç‹¬è®¾ç½®ã€‚
- æŸ¥è¯¢åŒè·¯å¾„ï¼šå‰ç«¯ `shared/api/organizations.ts`ï¼ˆREST æŸ¥è¯¢ï¼‰ä¸ `organizations-enterprise.ts`/`unified-client.ts`ï¼ˆGraphQLï¼‰å¹¶å­˜ã€‚
- æƒé™å‘½ååˆ†å‰ï¼šDev Token/Node ä¾§ä»ä½¿ç”¨ `org:write`ï¼Œä¸ OpenAPI/CLAUDE.md çš„ `org:create|org:update|org:delete` ä¸ä¸€è‡´ã€‚

éƒ¨åˆ†è¾¾æˆï¼ˆè¿›è¡Œä¸­ï¼‰
- GraphQL Schema å•ä¸€çœŸæºï¼šæŸ¥è¯¢æœåŠ¡å·²é€šè¿‡åŠ è½½å™¨è¯»å– `docs/api/schema.graphql`ï¼ˆè§ `cmd/organization-query-service/main.go` å¼•ç”¨ `internal/graphql`ï¼‰ï¼Œä¸å†å†…åµŒå¤§æ®µ `schemaString`ã€‚éœ€è¡¥å…… CI æ¼‚ç§»æ ¡éªŒä»¥å®Œæˆé—­ç¯ã€‚
- JWT é…ç½®ç»Ÿä¸€ï¼šå­˜åœ¨ `internal/config/jwt.go` ç»Ÿä¸€é…ç½®ï¼Œä½† `cmd/organization-command-service/main.go` ä»å†…è”è¯»å– env å¹¶ç»„è£…ä¸­é—´ä»¶ï¼Œéœ€æ›¿æ¢ä¸ºç»Ÿä¸€å…¥å£ã€‚
- ç§Ÿæˆ·å¤´ç®¡ç†ï¼šå‰ç«¯ `unified-client.ts` å·²æ”¹ä¸ºä» `shared/config/tenant.ts` è·å–ç§Ÿæˆ· IDï¼Œä»ä¿ç•™é»˜è®¤ç§Ÿæˆ·å¸¸é‡ï¼›ä» JWT è§£æç§Ÿæˆ·çš„ TODO å°šæœªå®Œå·¥ã€‚

éœ€ä¿®è®¢ï¼ˆæ–‡æ¡£è¡¨è¿°éœ€è¦æ›´æ–°ï¼‰
- å…³äºâ€œæŸ¥è¯¢æœåŠ¡å†…åµŒ schemaStringâ€ çš„ä¸¥é‡é—®é¢˜æè¿°ï¼šå½“å‰ç‰ˆæœ¬å·²ä½¿ç”¨åŠ è½½å™¨ï¼Œå†…åµŒå¤§æ®µ Schema çš„é—®é¢˜å·²åŸºæœ¬ç§»é™¤ï¼Œåº”è°ƒæ•´ä¸ºâ€œå·²æ•´æ”¹ï¼ˆå¾…è¡¥ CI æ ¡éªŒï¼‰â€ã€‚
- æ—¶æ€æµ‹è¯•æ•°é‡ç»Ÿè®¡ï¼šå‰ç«¯ e2e ç°æœ‰å¤šæ–‡ä»¶ï¼ˆå¦‚ `temporal-management-integration.spec.ts`ã€`five-state-lifecycle-management.spec.ts` ç­‰ï¼‰ï¼Œè„šæœ¬/åç«¯å±‚äº¦æœ‰ç›¸å…³ç”¨ä¾‹ï¼Œä½†å¹¶éæ­¤å‰æ‰€è¿°â€œ20+ å…¨ä¸ºé‡å¤â€ã€‚åº”å°†è¡¨è¿°è°ƒæ•´ä¸ºâ€œè·¨å±‚å­˜åœ¨é‡å åœºæ™¯ï¼Œéœ€æŒ‰ä¸‰ç±»æ ¸å¿ƒç”¨ä¾‹åˆå¹¶â€ã€‚
- `frontend/OrganizationComponents.tsx`ï¼šä»“åº“ä¸å­˜åœ¨è¯¥æ–‡ä»¶ï¼ˆä»…åœ¨å†å² eslint æŠ¥å‘Š JSON å‡ºç°ï¼‰ï¼Œæ–‡æ¡£åº”ç§»é™¤æˆ–æ›¿æ¢ä¸ºç°å­˜è·¯å¾„å¼•ç”¨ã€‚

åç»­åŠ¨ä½œ
- åœ¨æœ¬æ–‡ä»¶çš„â€œä»»åŠ¡æ‹†è§£æ¸…å•â€å¯¹åº”æ¡ç›®ä¸Šæ ‡æ³¨çŠ¶æ€ï¼ˆå·²å®Œæˆ/è¿›è¡Œä¸­/æœªå¼€å§‹ï¼‰ï¼Œå¹¶åœ¨ CI ä¸­å¢åŠ ä¸‰ç±»å®ˆæŠ¤ï¼šæƒé™å‘½åæ‰«æã€REST æŸ¥è¯¢è°ƒç”¨æ‰«æã€CORS/ç«¯å£ç¡¬ç¼–ç æ‰«æã€‚

è¯æ®è·¯å¾„ï¼ˆæ ·ä¾‹ï¼‰
- GraphQL å•ä¸€çœŸæºï¼š`cmd/organization-query-service/main.go` å¼•ç”¨ `internal/graphql`ï¼›`GRAPHQL_SCHEMA_MIGRATION_REPORT.md`ã€`scripts/validate-graphql-schema.sh` å­˜åœ¨ã€‚
- JWT ç»Ÿä¸€é…ç½®ï¼š`internal/config/jwt.go`ï¼›`cmd/organization-command-service/main.go` ä¸­å°šæœ‰å†…è”é…ç½®æ®µï¼ˆéœ€æ›¿æ¢ï¼‰ã€‚
- æŸ¥è¯¢åŒè·¯å¾„ï¼š`frontend/src/shared/api/organizations.ts` ä¸ `frontend/src/shared/api/organizations-enterprise.ts`ã€`frontend/src/shared/api/unified-client.ts`ã€‚

---

## ğŸ“ å‹˜è¯¯ä¸å¼‚åŠ¨è®°å½•
- [æ¡ç›® 7] GraphQL Schema å¤šæºå®šä¹‰ï¼šçŠ¶æ€è°ƒæ•´ä¸ºâ€œå·²æ•´æ”¹ï¼ˆä»£ç åŠ è½½å™¨å·²æ›¿ä»£ç¡¬ç¼–ç ï¼‰ï¼Œå¾…è¡¥å…… CI æ¼‚ç§»æ ¡éªŒâ€ã€‚
- [æ—¶æ€æµ‹è¯•æ•´åˆ] æ•°é‡è¡¨è¿°æ”¶æ•›ä¸ºâ€œè·¨å±‚å¤šå¤„è¦†ç›–ï¼ŒæŒ‰ä¸‰ç±»æ ¸å¿ƒæ–‡ä»¶åˆå¹¶ç›®æ ‡æ¨è¿›â€ï¼Œé¿å…å¤¸å¤§ç»Ÿè®¡ã€‚
- [å‰ç«¯ç»„ä»¶å†…è”å®¢æˆ·ç«¯] å°†å†å²å¼•ç”¨ `OrganizationComponents.tsx` æ”¹ä¸ºé’ˆå¯¹ç°å­˜æ–‡ä»¶è·¯å¾„çš„æ£€æŸ¥ä¸æ•´æ”¹è¦æ±‚ã€‚
- **é…ç½®ä¸€è‡´æ€§éªŒè¯**ï¼šæ‰€æœ‰é…ç½®æ–‡ä»¶ç«¯å£/åœ°å€ä¸€è‡´æ€§æ£€æŸ¥é€šè¿‡
- **ç§Ÿæˆ·é…ç½®éªŒè¯**ï¼šæ— ç¡¬ç¼–ç ç§Ÿæˆ·IDï¼Œå¤šç§Ÿæˆ·æ”¯æŒåŠŸèƒ½éªŒè¯
- **CORSç­–ç•¥éªŒè¯**ï¼šç»Ÿä¸€CORSé…ç½®ç”Ÿæ•ˆï¼Œå®‰å…¨ç­–ç•¥ä¸€è‡´æ€§ç¡®è®¤
- **ç›‘æ§é›†æˆéªŒè¯**ï¼šç›‘æ§ç³»ç»Ÿä¸ä¸»ç³»ç»Ÿé…ç½®åŒæ­¥ï¼Œæ— ç«¯å£å†²çª

## ğŸ§° è¿ç§»ç»†åˆ™ä¸è„šæœ¬ï¼ˆæ–°å¢ï¼‰

- Hooks ç»Ÿä¸€ï¼ˆPhase 1.1 ç»†åŒ–ï¼‰
  - æä¾› shimï¼ˆå…¼å®¹å¯¼å‡ºï¼‰ï¼š`export const useOrganizations = useEnterpriseOrganizations;`
  - codemodï¼ˆTS ASTï¼‰æ‰¹é‡æ›¿æ¢ import è·¯å¾„ï¼›ä¸€æ¬¡æ€§æäº¤ MRï¼›å›æ»šç­–ç•¥ï¼šä¿ç•™ shim 7 å¤©
  - ç§»é™¤é˜¶æ®µï¼šéªŒè¯é€šè¿‡åä¸€å‘¨å†…åˆ é™¤æ—§ Hook æ–‡ä»¶ï¼ŒCI åŠ è§„åˆ™ç¦æ­¢å†æ¬¡æ–°å¢

- E2E åˆå¹¶ï¼ˆPhase 1.2 ç»†åŒ–ï¼‰
  - å…ˆåˆå¹¶ç”¨ä¾‹åˆ° `temporal-management-integration.spec.ts`ï¼Œæ—§æ–‡ä»¶æ ‡æ³¨â€œå·²åºŸå¼ƒâ€ï¼ŒCI è­¦å‘Šä¸å¤±è´¥
  - ä¸€å‘¨ç°åº¦ååˆ é™¤æ—§æ–‡ä»¶ï¼ŒåŒæ—¶æŠŠæœ€æ…¢ç”¨ä¾‹ä¼˜åŒ–ç›®æ ‡çº³å…¥çœ‹æ¿

- API å®¢æˆ·ç«¯ç»Ÿä¸€ï¼ˆPhase 2.1 ç»†åŒ–ï¼‰
  - `shared/api/index.ts` ä»…å¯¼å‡º `unified-client`ï¼Œæ—§å®ç°æ”¹ä¸º deprecated re-exportï¼Œå¹¶åœ¨æ§åˆ¶å°æŠ¥è­¦
  - codemod æ‰¹é‡æ›¿æ¢ importï¼›æ”¶æ•›å®Œæ¯•ååˆ é™¤æ—§å®ç°ä¸æŠ¥è­¦ä»£ç 

- ç±»å‹ç³»ç»Ÿé‡æ„ï¼ˆPhase 2.2 ç»†åŒ–ï¼‰
  - åˆ—è¡¨åŒ–ç°æœ‰ `Organization*` ç±»å‹å®šä¹‰çš„åˆ†å¸ƒä¸å¼•ç”¨
  - è®¾è®¡â€œæ ¸å¿ƒ 8-10 ä¸ªç±»å‹â€ï¼Œå»ºç«‹æ˜ å°„è¡¨ï¼›é€ä¸ªæ–‡ä»¶æ›¿æ¢â†’tsc å…¨é‡æ£€æŸ¥â†’åˆ é™¤å†—ä½™

---

## ğŸ”§ å·¥å…·ä¸è„šæœ¬æ¸…å•ï¼ˆæ–°å¢ï¼‰

```bash
# é‡å¤ä»£ç 
npm i -D jscpd
jscpd --config .jscpd.json --reporters html,xml,json --output test-results/dup-report

# ä¾èµ–æ‹“æ‰‘
npm i -D dependency-cruiser
depcruise --config .dependency-cruiser.js src > test-results/depcruise.json

# æœªå¼•ç”¨å¯¼å‡º
npx ts-prune > test-results/ts-prune.txt
>>>>>>> feature/duplicate-code-elimination
```

**ä¸¥é‡é‡å¤é—®é¢˜åˆ†æ**:
- **ExtendedOrganizationQueryParams**: åœ¨3ä¸ªä¸åŒæ–‡ä»¶ä¸­é‡å¤å®šä¹‰
- **OrganizationOperationContext**: åœ¨2ä¸ªä¸åŒæ–‡ä»¶ä¸­é‡å¤å®šä¹‰
- **OrganizationStatus**: åœ¨3ä¸ªä¸åŒæ–‡ä»¶ä¸­é‡å¤å®šä¹‰ä¸”å®šä¹‰ä¸ä¸€è‡´:
  - `api.ts`: `'ACTIVE' | 'INACTIVE' | 'PLANNED'`
  - `statusUtils.ts`: `'ACTIVE' | 'SUSPENDED' | 'PLANNED' | 'DELETED'`
  - `StatusBadge.tsx`: é‡æ–°å¯¼å‡º

**å½±å“**: ä»»ä½•å­—æ®µå˜æ›´éœ€æ£€æŸ¥69ä¸ªä½ç½®ï¼Œ100%ä¼šå¼•å…¥ä¸ä¸€è‡´ï¼Œç»´æŠ¤å¤æ‚åº¦æŒ‡æ•°çº§å¢é•¿

#### 7. APIå®¢æˆ·ç«¯é‡å¤ âŒ **æœªè§£å†³**

**å‘ç°**: å¤šä¸ªAPIå®¢æˆ·ç«¯å®ç°ä¾ç„¶å¹¶å­˜

**APIå®¢æˆ·ç«¯æ–‡ä»¶æ¸…å•**:
```typescript
1. shared/api/organizations.ts                    # åŸºç¡€APIå®¢æˆ·ç«¯
2. shared/api/organizations-enterprise.ts         # ä¼ä¸šçº§APIå®¢æˆ·ç«¯  
3. shared/api/unified-client.ts                   # ç»Ÿä¸€å®¢æˆ·ç«¯(å¦‚æœå­˜åœ¨)
4. shared/api/type-guards.ts                      # ç±»å‹å®ˆå«ç›¸å…³API
5. shared/api/index.ts                            # APIå¯¼å‡ºæ–‡ä»¶
```

**é‡å¤åŠŸèƒ½åˆ†æ**:
- ç»„ç»‡CRUDæ“ä½œåœ¨å¤šä¸ªå®¢æˆ·ç«¯ä¸­é‡å¤å®ç°
- GraphQLå’ŒRESTè°ƒç”¨åˆ†æ•£åœ¨ä¸åŒæ–‡ä»¶ä¸­
- ç±»å‹å®šä¹‰å’ŒéªŒè¯é€»è¾‘é‡å¤

**å½±å“**: APIå˜æ›´éœ€åŒæ­¥ä¿®æ”¹å¤šä¸ªåœ°æ–¹ï¼Œè¡Œä¸ºä¸ä¸€è‡´é£é™©

### ğŸš¨ è™šå‡P3é˜²æ§ç³»ç»Ÿé—®é¢˜

#### å£°ç§°çš„ç³»ç»Ÿç»„ä»¶å®Œå…¨ä¸å­˜åœ¨:

**P3.1 è‡ªåŠ¨åŒ–é‡å¤æ£€æµ‹ç³»ç»Ÿ**:
- âŒ `scripts/quality/duplicate-detection.sh` - **æ–‡ä»¶ä¸å­˜åœ¨**
- âŒ `.jscpd.json` æˆ– `.jscpdrc.json` - **æ ¹ç›®å½•é…ç½®æ–‡ä»¶ä¸å­˜åœ¨**
- âŒ `reports/duplicate-code/` - **æŠ¥å‘Šç›®å½•ä¸å­˜åœ¨**

**P3.2 æ¶æ„å®ˆæŠ¤è§„åˆ™ç³»ç»Ÿ**:
- âŒ `scripts/quality/architecture-validator.js` - **æ–‡ä»¶ä¸å­˜åœ¨**
- âŒ `scripts/eslint-rules/` - **è‡ªå®šä¹‰è§„åˆ™ç›®å½•ä¸å­˜åœ¨**
- âŒ `reports/architecture/` - **æ¶æ„æŠ¥å‘Šä¸å­˜åœ¨**

**P3.3 æ–‡æ¡£è‡ªåŠ¨åŒæ­¥ç³»ç»Ÿ**:
- âŒ `scripts/quality/document-sync.js` - **æ–‡ä»¶ä¸å­˜åœ¨**
- âŒ `reports/document-sync/` - **åŒæ­¥æŠ¥å‘Šä¸å­˜åœ¨**

**GitHub Actionsé›†æˆ**:
- âŒ `.github/workflows/duplicate-code-detection.yml` - **å·¥ä½œæµä¸å­˜åœ¨**
- âŒ `.github/workflows/architecture-validation.yml` - **å·¥ä½œæµä¸å­˜åœ¨**
- âŒ `.github/workflows/document-sync.yml` - **å·¥ä½œæµä¸å­˜åœ¨**

**Pre-commit Hook**:
- âŒ `scripts/git-hooks/pre-commit-architecture.sh` - **Hookè„šæœ¬ä¸å­˜åœ¨**
- âŒ `.git/hooks/pre-commit` - **æœªéªŒè¯æ˜¯å¦å­˜åœ¨P3é›†æˆ**

**è´¨é‡æŠ¥å‘Šç³»ç»Ÿ**:
- âŒ `reports/` ç›®å½• - **ä»…å­˜åœ¨archive/reportsï¼Œæ— active reports**
- âŒ `docs/P3-Defense-System-Manual.md` - **ç³»ç»Ÿæ‰‹å†Œä¸å­˜åœ¨**

## ğŸ”§ å®é™…éœ€è¦çš„ç´§æ€¥è¡ŒåŠ¨

### Phase 0: è¯šä¿¡æ¢å¤ (ç«‹å³æ‰§è¡Œ)
- [ ] **æ‰¿è®¤ç°çŠ¶**: ç§»é™¤æ‰€æœ‰è™šå‡å®Œæˆå£°æ˜
- [ ] **åˆ é™¤å¤¸å¤§ç”¨è¯**: ç§»é™¤"100%"ã€"å®Œå…¨"ã€"å½»åº•"ç­‰ç¦ç”¨è¯æ±‡
- [ ] **é‡å»ºä¿¡ä»»**: æä¾›åŸºäºå®é™…éªŒè¯çš„çœŸå®çŠ¶æ€æŠ¥å‘Š
- [ ] **æ–‡æ¡£ä¿®æ­£**: æ›´æ–°æ‰€æœ‰ç›¸å…³æ–‡æ¡£ï¼Œç§»é™¤P3ç³»ç»Ÿè™šå‡æè¿°

### Phase 1: æ ¸å¿ƒæ¸…ç† (1å‘¨å†…)

#### 1.1 äºŒè¿›åˆ¶æ–‡ä»¶æ¸…ç†
- [ ] **åˆ é™¤10ä¸ªå†—ä½™äºŒè¿›åˆ¶**:
  ```bash
  rm bin/nextgen-cache-service
  rm bin/organization-api-gateway  
  rm bin/organization-api-server
  rm bin/organization-command-server
  rm bin/organization-command-service
  rm bin/organization-graphql-service
  rm bin/organization-sync-service
  rm bin/server
  rm bin/server-production
  rm bin/smart-gateway
  ```
- [ ] **ä»…ä¿ç•™2ä¸ªæ ¸å¿ƒæ–‡ä»¶**: `command-service`, `query-service`

#### 1.2 è„šæœ¬æ–‡ä»¶æ•´ç†  
- [ ] **åˆ é™¤é‡å¤å¯åŠ¨è„šæœ¬** (ä¿ç•™2-3ä¸ªæ ¸å¿ƒ):
  ```bash
  # ä¿ç•™
  scripts/start.sh                    # ä¸»å¯åŠ¨è„šæœ¬
  scripts/dev-start-simple.sh         # å¼€å‘å¯åŠ¨  
  scripts/cleanup-services.sh         # æ¸…ç†è„šæœ¬
  
  # åˆ é™¤ (7ä¸ªé‡å¤)
  scripts/quick_start.sh
  scripts/start_verification.sh
  scripts/start-infrastructure.sh
  scripts/start-monitoring.sh
  scripts/start-cqrs-complete.sh
  scripts/dev-restart.sh
  scripts/dev-stop.sh
  ```

- [ ] **åˆå¹¶æµ‹è¯•è„šæœ¬** (ä¿ç•™5ä¸ªæ ¸å¿ƒ):
  ```bash
  # ä¿ç•™
  scripts/test-api-integration.sh     # APIé›†æˆæµ‹è¯•
  scripts/e2e-test.sh                 # E2Eæµ‹è¯•
  scripts/test-database-integration.sh # æ•°æ®åº“æµ‹è¯•
  scripts/performance-benchmark.sh    # æ€§èƒ½æµ‹è¯•
  scripts/validate-contracts.sh       # å¥‘çº¦éªŒè¯
  
  # åˆ é™¤æˆ–åˆå¹¶ (16ä¸ªé‡å¤)
  # å°†åŠŸèƒ½åˆå¹¶åˆ°ä¸Šè¿°5ä¸ªæ ¸å¿ƒè„šæœ¬ä¸­
  ```

- [ ] **æ—¶æ€è„šæœ¬åˆå¹¶** (ä¿ç•™1-2ä¸ªæ ¸å¿ƒ):
  ```bash  
  # ä¿ç•™
  scripts/test-temporal-integration.sh  # æ—¶æ€é›†æˆæµ‹è¯• (æ–°å»ºï¼Œåˆå¹¶æ‰€æœ‰åŠŸèƒ½)
  
  # åˆ é™¤ (6ä¸ªé‡å¤)
  scripts/temporal-e2e-validate.sh
  scripts/test-temporal-consistency.sh
  scripts/test-temporal-api-integration.sh
  scripts/temporal-performance-test.sh
  scripts/run-temporal-tests.sh
  scripts/optimize-temporal-cache.sh
  ```

#### 1.3 JWTé…ç½®ç»Ÿä¸€
- [ ] **åˆ›å»ºç»Ÿä¸€é…ç½®æ¨¡å—**: `internal/config/jwt.go`
- [ ] **æ›¿æ¢6ä¸ªæ–‡ä»¶ä¸­çš„é‡å¤å®ç°**:
  ```bash
  cmd/organization-command-service/main.go
  cmd/organization-query-service/main.go  
  scripts/temporal_test_runner.go
  scripts/cqrs_integration_runner.go
  scripts/generate-dev-jwt.go
  tests/temporal-function-test.go
  ```

### Phase 2: Hookä¸æ¥å£ç»Ÿä¸€ (2å‘¨å†…)

#### 2.1 Hookæ”¶æ•›è®¡åˆ’
- [ ] **ä¿ç•™2ä¸ªä¸»è¦Hook**:
  ```typescript
  shared/hooks/useEnterpriseOrganizations.ts  // ä¸»è¦å®ç°
  shared/hooks/useOrganizations.ts            // ç®€åŒ–ç‰ˆæœ¬
  ```

- [ ] **åˆ›å»ºé€‚é…å™¨åŒ…è£…** (ä¸´æ—¶å…¼å®¹):
  ```typescript
  // shared/hooks/index.ts
  export const useOrganizationActions = (params) => {
    const { actions } = useEnterpriseOrganizations(params);
    return actions;
  };
  
  export const useOrganizationDashboard = (params) => {
    const { dashboard } = useEnterpriseOrganizations(params);  
    return dashboard;
  };
  ```

- [ ] **é€æ­¥è¿ç§»13ä¸ªæ–‡ä»¶çš„Hookå¼•ç”¨**
- [ ] **åˆ é™¤11ä¸ªå†—ä½™Hookæ–‡ä»¶**

#### 2.2 æ¥å£å®šä¹‰å¤§è§„æ¨¡é‡æ„
- [ ] **è®¾è®¡8ä¸ªæ ¸å¿ƒæ¥å£ä½“ç³»**:
  ```typescript
  // shared/types/organization.ts - ç»Ÿä¸€å®šä¹‰æ–‡ä»¶
  export interface OrganizationUnit { ... }              // 1. ä¸»è¦å®ä½“
  export interface OrganizationQueryParams { ... }       // 2. æŸ¥è¯¢å‚æ•°
  export interface OrganizationMutationInput { ... }     // 3. å˜æ›´è¾“å…¥
  export interface OrganizationResponse { ... }          // 4. å“åº”æ ¼å¼  
  export interface TemporalOrganizationUnit { ... }      // 5. æ—¶æ€æ‰©å±•
  export interface OrganizationTableProps { ... }        // 6. è¡¨æ ¼ç»„ä»¶
  export interface OrganizationFormProps { ... }         // 7. è¡¨å•ç»„ä»¶
  export interface OrganizationTreeNode { ... }          // 8. æ ‘å½¢èŠ‚ç‚¹
  
  // ç»Ÿä¸€ç±»å‹å¯¼å‡º
  export type OrganizationStatus = 'ACTIVE' | 'SUSPENDED' | 'PLANNED' | 'DELETED';
  export type OrganizationUnitType = 'DEPARTMENT' | 'ORGANIZATION_UNIT' | 'PROJECT_TEAM';
  ```

- [ ] **åˆ é™¤61ä¸ªå†—ä½™æ¥å£å®šä¹‰**:
  - 3ä¸ªé‡å¤çš„`ExtendedOrganizationQueryParams`
  - 2ä¸ªé‡å¤çš„`OrganizationOperationContext`  
  - 3ä¸ªä¸ä¸€è‡´çš„`OrganizationStatus`å®šä¹‰
  - 5ä¸ªZodéªŒè¯ç±»å‹ (æ”¹ä¸ºä»æ ¸å¿ƒæ¥å£æ¨å¯¼)
  - 48ä¸ªåˆ†æ•£çš„ç»„ä»¶ä¸“ç”¨æ¥å£å®šä¹‰

#### 2.3 APIå®¢æˆ·ç«¯ç»Ÿä¸€  
- [ ] **ä¿ç•™ç»Ÿä¸€å®¢æˆ·ç«¯**: `shared/api/unified-client.ts`
- [ ] **åˆ›å»ºé€‚é…å™¨**: 
  ```typescript
  // shared/api/index.ts
  export { 
    organizationAPI as default,
    organizationAPI as enterpriseOrganizationAPI 
  } from './unified-client';
  ```
- [ ] **åˆ é™¤4ä¸ªé‡å¤å®¢æˆ·ç«¯æ–‡ä»¶**

### Phase 3: å»ºç«‹çœŸæ­£çš„é˜²æ§æœºåˆ¶ (1æœˆå†…)

#### 3.1 å®é™…åˆ›å»ºé‡å¤ä»£ç æ£€æµ‹
- [ ] **å®‰è£…é…ç½®jscpd**:
  ```bash
  npm install -D jscpd
  ```

- [ ] **åˆ›å»ºé…ç½®æ–‡ä»¶** `.jscpdrc.json`:
  ```json
  {
    "threshold": 5,
    "minTokens": 50,
    "minLines": 10,
    "reporters": ["html", "console", "json"],
    "output": "reports/duplicate-code"
  }
  ```

- [ ] **åˆ›å»ºæ£€æµ‹è„šæœ¬** `scripts/quality/duplicate-detection.sh`

#### 3.2 å»ºç«‹CI/CDè´¨é‡é—¨ç¦
- [ ] **åˆ›å»ºGitHub Actionså·¥ä½œæµ**
- [ ] **é…ç½®ESLintè‡ªå®šä¹‰è§„åˆ™**
- [ ] **å»ºç«‹Pre-commit Hook**

#### 3.3 æ¶æ„å®ˆæŠ¤è§„åˆ™å®æ–½
- [ ] **åˆ›å»ºæ¶æ„éªŒè¯è„šæœ¬**
- [ ] **å»ºç«‹ç«¯å£é…ç½®æ£€æŸ¥**
- [ ] **å®æ–½camelCaseå‘½åæ£€æŸ¥**

## ğŸ“Š å®é™…è´¨é‡æŒ‡æ ‡ (åŸºäºè¯¦ç»†éªŒè¯)

### å½“å‰çœŸå®çŠ¶å†µ (2025-09-08éªŒè¯)
- **äºŒè¿›åˆ¶æ–‡ä»¶**: 12ä¸ª (ç›®æ ‡: 2ä¸ª) - éœ€åˆ é™¤10ä¸ª
- **è„šæœ¬æ–‡ä»¶**: 49ä¸ª.sh (ç›®æ ‡: <10ä¸ª) - éœ€åˆ é™¤39+ä¸ª
- **Hookå®ç°**: 13ä¸ªæ–‡ä»¶ (ç›®æ ‡: 2ä¸ª) - éœ€æ¸…ç†11ä¸ª
- **ç»„ç»‡æ¥å£**: 69ä¸ªå®šä¹‰ (ç›®æ ‡: 8ä¸ª) - éœ€åˆ é™¤61ä¸ª
- **APIå®¢æˆ·ç«¯**: 5ä¸ªæ–‡ä»¶ (ç›®æ ‡: 1ä¸ª) - éœ€åˆå¹¶4ä¸ª
- **é‡å¤ä»£ç ç‡**: æœªçŸ¥ (éœ€è¦å»ºç«‹æ£€æµ‹)

### è¿åCLAUDE.mdåŸåˆ™ä¸¥é‡ç¨‹åº¦åˆ†æ
- **ç¬¬1æ¡è¯šå®åŸåˆ™**: â­â­â­â­â­ æåº¦ä¸¥é‡è¿å (è™šå‡P3ç³»ç»Ÿå£°æ˜)
- **ç¬¬2æ¡æ‚²è§‚è°¨æ…**: â­â­â­â­â­ æåº¦ä¸¥é‡è¿å (100%å®Œæˆè™šå‡å£°æ˜)
- **ç¬¬5æ¡ç¦æ­¢å¤¸å¤§**: â­â­â­â­â­ æåº¦ä¸¥é‡è¿å (87%å†—ä½™åº¦ç­‰è™šå‡æ•°æ®)
- **ç¬¬10æ¡èµ„æºå”¯ä¸€æ€§**: â­â­â­â­ ä¸¥é‡è¿å (12+49+13+69ä¸ªé‡å¤èµ„æº)
- **ç¬¬12æ¡æŒç»­è´¨ç–‘**: â­â­â­â­ ä¸¥é‡è¿å (ç¼ºä¹è‡ªæˆ‘è´¨ç–‘å’ŒéªŒè¯)

### å…·ä½“é‡åŒ–æŒ‡æ ‡
```yaml
ä»£ç é‡å¤åº¦åˆ†æ:
  äºŒè¿›åˆ¶æ–‡ä»¶å†—ä½™åº¦: 83% (12ä¸ªä¸­10ä¸ªå†—ä½™)
  è„šæœ¬æ–‡ä»¶å†—ä½™åº¦: 80% (49ä¸ªä¸­39+ä¸ªå¯åˆå¹¶)
  Hookå®ç°å†—ä½™åº¦: 85% (13ä¸ªä¸­11ä¸ªå¯åˆå¹¶)
  æ¥å£å®šä¹‰å†—ä½™åº¦: 88% (69ä¸ªä¸­61ä¸ªå¯åˆ é™¤)
  
ç»´æŠ¤æˆæœ¬è¯„ä¼°:
  å½“å‰ç»´æŠ¤ç‚¹æ•°: 152ä¸ª (12+49+13+69+9å…¶ä»–)
  ç›®æ ‡ç»´æŠ¤ç‚¹æ•°: 32ä¸ª (2+10+2+8+10å…¶ä»–)
  ç»´æŠ¤æˆæœ¬é™ä½: 79% (120ä¸ªç»´æŠ¤ç‚¹å‡å°‘)
  
é£é™©ç­‰çº§:
  è¯šä¿¡é£é™©: Sçº§ (é¡¹ç›®ä¿¡ä»»å®Œå…¨æŸå¤±)
  æ¶æ„é£é™©: Açº§ (é‡å¤å¯¼è‡´ä¸ä¸€è‡´)
  ç»´æŠ¤é£é™©: Açº§ (æˆæœ¬æŒ‡æ•°çº§å¢é•¿)
  å‘å¸ƒé£é™©: Bçº§ (éƒ¨ç½²æ··ä¹±)
```

## ğŸ¯ çœŸå®æ‰§è¡Œè®¡åˆ’ä¸é‡Œç¨‹ç¢‘

### Week 1: ç´§æ€¥æ­¢è¡€
- [ ] Day 1-2: æ‰¿è®¤ç°çŠ¶ï¼Œåˆ é™¤è™šå‡å£°æ˜
- [ ] Day 3-4: åˆ é™¤10ä¸ªå†—ä½™äºŒè¿›åˆ¶æ–‡ä»¶
- [ ] Day 5-7: åˆå¹¶49â†’10ä¸ªæ ¸å¿ƒè„šæœ¬æ–‡ä»¶

### Week 2: JWTé…ç½®ç»Ÿä¸€
- [ ] Day 8-10: åˆ›å»º`internal/config/jwt.go`
- [ ] Day 11-14: æ›¿æ¢6ä¸ªæ–‡ä»¶ä¸­çš„é‡å¤JWTé…ç½®

### Week 3-4: Hookä¸æ¥å£å¤§è§„æ¨¡é‡æ„
- [ ] Week 3: Hookä»13â†’2ä¸ªï¼Œåˆ›å»ºé€‚é…å™¨
- [ ] Week 4: æ¥å£ä»69â†’8ä¸ªï¼Œç±»å‹ç³»ç»Ÿé‡å»º

### Week 5-8: APIå®¢æˆ·ç«¯ä¸é˜²æ§ç³»ç»Ÿ
- [ ] Week 5: APIå®¢æˆ·ç«¯5â†’1ä¸ªç»Ÿä¸€
- [ ] Week 6-7: å»ºç«‹çœŸæ­£çš„jscpdæ£€æµ‹ç³»ç»Ÿ
- [ ] Week 8: GitHub Actionsè´¨é‡é—¨ç¦

### å…³é”®æˆåŠŸæŒ‡æ ‡ (å¯éªŒè¯)
- [ ] `/bin/`ç›®å½•æ–‡ä»¶æ•°é‡: 12 â†’ 2ä¸ª âœ“
- [ ] `scripts/`è„šæœ¬æ•°é‡: 49 â†’ <10ä¸ª âœ“  
- [ ] ç»„ç»‡Hookæ–‡ä»¶æ•°: 13 â†’ 2ä¸ª âœ“
- [ ] ç»„ç»‡æ¥å£å®šä¹‰æ•°: 69 â†’ 8ä¸ª âœ“
- [ ] APIå®¢æˆ·ç«¯æ•°é‡: 5 â†’ 1ä¸ª âœ“
- [ ] å»ºç«‹å¯è¿è¡Œçš„jscpdæ£€æµ‹ âœ“
- [ ] GitHub Actionsè´¨é‡é—¨ç¦ç”Ÿæ•ˆ âœ“

### è¯šä¿¡åŸåˆ™éµå¾ª
- **æ°¸ä¸å£°ç§°"å®Œæˆ"**ç›´åˆ°å¯ç‹¬ç«‹éªŒè¯å®Œæˆ
- **ä½¿ç”¨ä¿å®ˆæ—¶é—´ä¼°è®¡**ï¼Œé¢„ç•™ç¼“å†²ç©ºé—´
- **åŸºäºå®é™…æ–‡ä»¶æ£€æŸ¥**ï¼Œä¸åŸºäºæ–‡æ¡£å£°æ˜
- **æ¥å—æ¸è¿›å¼æ”¹å–„**ï¼Œé¿å…è™šå‡é‡Œç¨‹ç¢‘
- **å»ºç«‹çœŸå®å¯éªŒè¯çš„æŒ‡æ ‡**ï¼Œæ‹’ç»æ‹è„‘è¢‹æ•°æ®

## ğŸš¨ æœ€ç»ˆè­¦å‘Šä¸å»ºè®®

**å½“å‰é¡¹ç›®é¢ä¸´çš„æ˜¯è¯šä¿¡å±æœºï¼Œè€Œéå•çº¯çš„æŠ€æœ¯å€ºåŠ¡é—®é¢˜ã€‚**

åŸºäºCLAUDE.mdæ‚²è§‚è°¨æ…åŸåˆ™çš„ä¸¥å‰è­¦å‘Šï¼š

### 48å°æ—¶å†…å¿…é¡»è¡ŒåŠ¨ (è¯šä¿¡æ¢å¤æœŸé™)
- å¦‚ä¸æ‰¿è®¤ç°çŠ¶å¹¶åˆ é™¤è™šå‡å£°æ˜ï¼Œé¡¹ç›®å°†å®Œå…¨å¤±å»å¼€å‘å›¢é˜Ÿä¿¡ä»»
- å¦‚ä¸å¼€å§‹å®é™…æ–‡ä»¶æ¸…ç†ï¼Œé‡å¤é—®é¢˜å°†è¿›ä¸€æ­¥æ¶åŒ–
- å¦‚ä¸å»ºç«‹çœŸå®éªŒè¯æœºåˆ¶ï¼Œç±»ä¼¼è™šå‡æ–‡æ¡£å°†å†æ¬¡å‡ºç°

### 2å‘¨å†…å¿…é¡»è§æ•ˆ (æŠ€æœ¯å€ºåŠ¡ä¸´ç•Œç‚¹)
- å¦‚ä¸å®ŒæˆäºŒè¿›åˆ¶å’Œè„šæœ¬æ¸…ç†ï¼Œéƒ¨ç½²å°†å½»åº•æ··ä¹±
- å¦‚ä¸ç»Ÿä¸€JWTé…ç½®ï¼Œå®‰å…¨é£é™©å°†æˆä¸ºç³»ç»Ÿæ€§é—®é¢˜
- å¦‚ä¸å¼€å§‹Hookå’Œæ¥å£æ”¶æ•›ï¼Œå‰ç«¯ç»´æŠ¤å°†å®Œå…¨å¤±æ§

### 1æœˆå†…å¿…é¡»å®Œæˆ (é¡¹ç›®ç”Ÿå­˜åˆ†æ°´å²­)
- å¦‚ä¸å»ºç«‹çœŸæ­£çš„è´¨é‡æ£€æµ‹æœºåˆ¶ï¼Œé‡å¤é—®é¢˜å°†æ— é™å¾ªç¯
- å¦‚ä¸å®Œæˆæ¥å£å®šä¹‰å¤§è§„æ¨¡é‡æ„ï¼Œä»»ä½•åŠŸèƒ½å˜æ›´éƒ½å°†å¼•å‘ç³»ç»Ÿæ€§é”™è¯¯
- å¦‚ä¸æ¢å¤æ–‡æ¡£ä¸å®é™…çš„ä¸€è‡´æ€§ï¼Œé¡¹ç›®å°†å¤±å»æ‰€æœ‰å¯ç»´æŠ¤æ€§

**æœ€ç»ˆå»ºè®®**:
1. **ç«‹å³åœæ­¢ä¸€åˆ‡è™šå‡å®£ä¼ **ï¼Œå¼€å§‹åŸºäºå®é™…æ–‡ä»¶éªŒè¯çš„è¯šå®å¼€å‘
2. **å»ºç«‹æ¯æ—¥éªŒè¯æœºåˆ¶**ï¼Œç¡®ä¿æ‰€æœ‰å£°æ˜éƒ½æœ‰å¯¹åº”çš„å®é™…æ–‡ä»¶æ”¯æ’‘
3. **é‡‡ç”¨æåº¦ä¿å®ˆçš„å®Œæˆåº¦è¯„ä¼°**ï¼Œå®å¯ä½ä¼°ä¹Ÿä¸å†å¤¸å¤§
4. **å°†è¯šä¿¡æ¢å¤ä½œä¸ºæœ€é«˜ä¼˜å…ˆçº§**ï¼Œæš‚åœæ‰€æœ‰æ–°åŠŸèƒ½å¼€å‘

---

**è¯¦ç»†ç‰ˆè¯´æ˜**: æœ¬æ–‡æ¡£åŸºäº2025-09-08ä»£ç å®¡æŸ¥ä¸“å®¶çš„æ·±åº¦å®åœ°éªŒè¯ï¼Œåˆ—å‡ºäº†æ‰€æœ‰å…·ä½“æ–‡ä»¶åã€è·¯å¾„å’Œæ•°é‡ã€‚æ‰€æœ‰æ•°æ®å‡å¯é€šè¿‡æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤ç‹¬ç«‹éªŒè¯ï¼Œåšå†³æœç»ä»»ä½•"æ‹è„‘è¢‹"çš„ä¼°ç®—æˆ–è™šå‡å£°æ˜ã€‚