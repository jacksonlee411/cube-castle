# Plan 253 - 部署流水线简化

文档编号: 253  
标题: 部署流水线简化（来源：202 计划拆分）  
创建日期: 2025-11-15  
版本: v1.0  
关联计划: 202、203、221（Docker 基座）、CI

---

## 1. 目标
- 用最少的步骤完成构建、测试、验收与发布，保持环境一致性；
- 固化镜像标签、预拉取策略与测试基座在流水线中的复用。

## 2. 交付物
- CI 任务清单与依赖（只引用 .github/workflows/*）；
- 发布流程说明（镜像标签、回滚策略）；
- 证据：logs/plan253/*（流水线执行节选与耗时统计）。

## 3. 验收标准
- 构建/测试/验收任务可重入、可复用（冷/热启动下稳定）；
- 端到端执行时间达标（以 204 时间表为基准）；
- 关键步骤产物可追溯（报告、日志）。

---

维护者: DevOps（与 QA/后端协作）

---

## 4. 门禁（CI）
- 端口映射门禁：扫描 docker-compose*.yml，检测 5432/6379/9090/8090 容器端口映射变更；发现变更即阻断（须按 AGENTS 卸载宿主服务）
- 镜像标签门禁：PostgreSQL/Redis 镜像标签禁止使用 `latest`；必须为固定版本标签
- 预拉取与冷启动计时：记录镜像预拉取后冷启动<10s、数据库就绪<15s（首次 CI 运行登记至 215）
