# CQRSæ—¶æ€ç®¡ç†é‡æ„å®æ–½å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºç”¨æˆ·éœ€æ±‚ï¼ˆæ—¥æœŸç²’åº¦ã€17çº§å±‚çº§ã€æ— é™å†å²ä¿ç•™ã€æœ€ç»ˆä¸€è‡´æ€§ã€ç‰¹å®šæ—¥æœŸæŸ¥è¯¢ï¼‰ï¼Œå®Œæˆäº†å®Œæ•´çš„CQRSæ—¶æ€ç®¡ç†é‡æ„å®æ–½ã€‚è¯¥æ–¹æ¡ˆç¬¦åˆHRè¡Œä¸šæ ‡å‡†ï¼Œé‡‡ç”¨çº¯æ—¥æœŸç”Ÿæ•ˆæ¨¡å‹ï¼Œæä¾›ä¼ä¸šçº§æ—¶æ€ç®¡ç†èƒ½åŠ›ã€‚

## ğŸ¯ æ ¸å¿ƒè®¾è®¡åŸåˆ™

### 1. CQRSæ¶æ„åˆ†ç¦»
- **PostgreSQL**: ä¸“æ³¨å‘½ä»¤æ“ä½œ(CUD)ï¼Œå¼ºä¸€è‡´æ€§å†™å…¥
- **Neo4j**: ä¸“æ³¨æŸ¥è¯¢æ“ä½œå’Œå±‚çº§è®¡ç®—ï¼Œæœ€ç»ˆä¸€è‡´æ€§è¯»å–
- **åè®®åˆ†ç¦»**: å‘½ä»¤ç”¨RESTï¼ŒæŸ¥è¯¢ç”¨GraphQL

### 2. çº¯æ—¥æœŸç”Ÿæ•ˆæ¨¡å‹
- **åŸºäºå­—æ®µ**: `effective_date`ã€`end_date`ã€`is_current`
- **ç§»é™¤ç‰ˆæœ¬å·**: ç¬¦åˆHRè¡Œä¸šæ ‡å‡†çš„æ—¶æ€ç®¡ç†
- **æ— é™å†å²**: å®Œæ•´ä¿ç•™ç»„ç»‡å˜æ›´è½¨è¿¹

### 3. 17çº§å±‚çº§æ”¯æŒ
- **Neo4jå›¾è®¡ç®—**: å¤©ç„¶é€‚åˆæ·±å±‚çº§ç»„ç»‡æ¶æ„
- **è·¯å¾„ä¼˜åŒ–**: é¢„è®¡ç®—å±‚çº§è·¯å¾„ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½
- **å…³ç³»ç®¡ç†**: æ”¯æŒå¤æ‚çš„ç»„ç»‡å…³ç³»æŸ¥è¯¢

## ğŸš€ å®æ–½æˆæœ

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒç»„ä»¶

#### 1. PostgreSQLæ—¶æ€è¡¨ä¼˜åŒ–
- **æ–‡ä»¶**: `database/migrations/009_cqrs_temporal_optimization.sql`
- **åŠŸèƒ½**: 
  - ä¸“æ³¨CUDæ“ä½œï¼Œç§»é™¤å±‚çº§è®¡ç®—èŒè´£
  - å¤åˆä¸»é”®`(code, effective_date)`æ”¯æŒæ—¶æ€æ•°æ®
  - ä¼˜åŒ–ç´¢å¼•ï¼š17çº§å±‚çº§ã€æ— é™å†å²ä¿ç•™
  - æ—¶æ€è¿ç»­æ€§çº¦æŸæ£€æŸ¥

#### 2. Neo4jæ—¶æ€å›¾ç»“æ„
- **æ–‡ä»¶**: `database/neo4j/temporal_graph_schema.cypher`
- **åŠŸèƒ½**:
  - æ—¶æ€ç»„ç»‡èŠ‚ç‚¹ï¼š`TemporalOrganization`
  - æ—¶æ€å±‚çº§å…³ç³»ï¼š`PARENT_OF`
  - æ—¶æ€æ¼”è¿›å…³ç³»ï¼š`EVOLVES_TO`
  - ç¼“å­˜ä¼˜åŒ–å­—æ®µï¼š`children_count`ã€`descendants_count`

#### 3. æ—¶æ€CDCåŒæ­¥æœåŠ¡
- **æ–‡ä»¶**: `cmd/organization-temporal-sync-service/main.go`
- **åŠŸèƒ½**:
  - PostgreSQLâ†’Neo4jå®æ—¶æ•°æ®åŒæ­¥
  - å±‚çº§è·¯å¾„è‡ªåŠ¨è®¡ç®—
  - ç²¾ç¡®ç¼“å­˜å¤±æ•ˆç­–ç•¥
  - SchemaåŒ…è£…æ ¼å¼æ”¯æŒ

#### 4. GraphQLæ—¶æ€æŸ¥è¯¢API
- **æ–‡ä»¶**: `cmd/organization-temporal-query-service/main.go`
- **ç«¯å£**: 8091
- **åŠŸèƒ½**:
  - æ—¶æ€æŸ¥è¯¢ï¼š`temporalOrganization`ã€`temporalHierarchy`
  - æ—¶é—´ç‚¹æŸ¥è¯¢ï¼š`organizationsAsOf`
  - å†å²æŸ¥è¯¢ï¼š`organizationHistory`
  - å…³ç³»éå†ï¼šçˆ¶å­ç»„ç»‡ã€å±‚çº§è·¯å¾„

#### 5. RESTæ—¶æ€å‘½ä»¤API
- **æ–‡ä»¶**: `cmd/organization-temporal-rest-service/main.go`
- **ç«¯å£**: 9092
- **åŠŸèƒ½**:
  - æ—¶æ€CRUDæ“ä½œï¼šåˆ›å»ºã€æ›´æ–°ã€è§£æ•£
  - æ—¶æ€æŸ¥è¯¢æ¥å£
  - ç‰ˆæœ¬ç®¡ç†ï¼šè‡ªåŠ¨å¤„ç†æ—¶æ€è®°å½•
  - ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šç»„ç»‡åˆ›å»ºåˆ°è§£æ•£å…¨æµç¨‹

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend (React)   â”‚    â”‚     ç›‘æ§é¢æ¿        â”‚
â”‚  - æ—¶æ€ç®¡ç†ç•Œé¢      â”‚    â”‚   - æ€§èƒ½ç›‘æ§         â”‚
â”‚  - å±‚çº§å¯è§†åŒ–       â”‚    â”‚   - åŒæ­¥çŠ¶æ€         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚
           â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GraphQLæŸ¥è¯¢æœåŠ¡    â”‚    â”‚    ç›‘æ§æœåŠ¡         â”‚
â”‚  - æ—¶æ€æŸ¥è¯¢API      â”‚    â”‚  - Prometheus       â”‚
â”‚  - å±‚çº§è·¯å¾„æŸ¥è¯¢     â”‚    â”‚  - å¥åº·æ£€æŸ¥         â”‚
â”‚  - Neo4jä¼˜åŒ–æŸ¥è¯¢    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  ç«¯å£: 8091         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RESTå‘½ä»¤æœåŠ¡      â”‚    â”‚   æ—¶æ€åŒæ­¥æœåŠ¡       â”‚
â”‚  - æ—¶æ€CRUDæ“ä½œ     â”‚    â”‚  - CDCäº‹ä»¶å¤„ç†      â”‚
â”‚  - PostgreSQLå†™å…¥   â”‚    â”‚  - å±‚çº§è®¡ç®—         â”‚
â”‚  ç«¯å£: 9092         â”‚    â”‚  - ç¼“å­˜æ›´æ–°         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚
           â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PostgreSQL        â”‚    â”‚      Neo4j          â”‚
â”‚  - æ—¶æ€å•è¡¨å­˜å‚¨     â”‚â—„â”€â”€â”€â”¤  - æ—¶æ€å›¾ç»“æ„       â”‚
â”‚  - å¤åˆä¸»é”®         â”‚    â”‚  - å±‚çº§è·¯å¾„è®¡ç®—     â”‚
â”‚  - CDCå‘å¸ƒ          â”‚    â”‚  - å…³ç³»æŸ¥è¯¢ä¼˜åŒ–     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ éƒ¨ç½²æŒ‡å—

### ç¯å¢ƒå‡†å¤‡
```bash
# åŸºç¡€è®¾æ–½ï¼ˆDocker Composeï¼‰
cd /home/shangmeilin/cube-castle
docker-compose up -d  # PostgreSQL, Neo4j, Redis, Kafka
```

### æ•°æ®åº“åˆå§‹åŒ–
```bash
# 1. PostgreSQLæ—¶æ€ä¼˜åŒ–
psql -h localhost -U user -d cubecastle -f database/migrations/009_cqrs_temporal_optimization.sql

# 2. Neo4jå›¾ç»“æ„åˆå§‹åŒ–
cypher-shell -u neo4j -p password -f database/neo4j/temporal_graph_schema.cypher
```

### æœåŠ¡å¯åŠ¨
```bash
# 1. æ—¶æ€CDCåŒæ­¥æœåŠ¡
cd cmd/organization-temporal-sync-service
go run main.go &

# 2. GraphQLæ—¶æ€æŸ¥è¯¢æœåŠ¡ (ç«¯å£8091)
cd cmd/organization-temporal-query-service
go run main.go &

# 3. RESTæ—¶æ€å‘½ä»¤æœåŠ¡ (ç«¯å£9092)
cd cmd/organization-temporal-rest-service
go run main.go &
```

### å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8091/health  # GraphQLæŸ¥è¯¢æœåŠ¡
curl http://localhost:9092/health  # RESTå‘½ä»¤æœåŠ¡
```

## ğŸ“ APIä½¿ç”¨ç¤ºä¾‹

### RESTæ—¶æ€å‘½ä»¤API

#### åˆ›å»ºæ—¶æ€ç»„ç»‡
```bash
curl -X POST http://localhost:9092/api/v1/organization-units \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æŠ€æœ¯ç ”å‘éƒ¨",
    "unitType": "DEPARTMENT",
    "status": "ACTIVE",
    "parentCode": "1000001",
    "effectiveDate": "2025-08-12",
    "changeReason": "ç»„ç»‡æ¶æ„è°ƒæ•´"
  }'
```

#### æ›´æ–°æ—¶æ€ç»„ç»‡
```bash
curl -X PUT http://localhost:9092/api/v1/organization-units/1000056 \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æŠ€æœ¯åˆ›æ–°éƒ¨",
    "effectiveDate": "2025-09-01",
    "changeReason": "éƒ¨é—¨æ›´å"
  }'
```

#### è§£æ•£ç»„ç»‡
```bash
curl -X POST http://localhost:9092/api/v1/organization-units/1000056/dissolve \
  -H "Content-Type: application/json" \
  -d '{
    "endDate": "2025-12-31",
    "changeReason": "ç»„ç»‡é‡ç»„"
  }'
```

#### æ—¶æ€æŸ¥è¯¢
```bash
# ç‰¹å®šæ—¶é—´ç‚¹æŸ¥è¯¢
curl "http://localhost:9092/api/v1/organization-units/1000056/temporal?as_of_date=2025-08-01"

# æ—¶é—´èŒƒå›´æŸ¥è¯¢
curl "http://localhost:9092/api/v1/organization-units/1000056/temporal?effective_from=2025-01-01&effective_to=2025-12-31"
```

### GraphQLæ—¶æ€æŸ¥è¯¢API

#### æ—¶é—´ç‚¹ç»„ç»‡æŸ¥è¯¢
```bash
curl -X POST http://localhost:8091/graphql \
  -H "Content-Type: application/json" \
  -d '{
    "query": "query { temporalOrganization(code: \"1000056\", asOfDate: \"2025-08-01\") { code name effectiveDate endDate isCurrent changeReason } }"
  }'
```

#### æ—¶æ€å±‚çº§æŸ¥è¯¢
```bash
curl -X POST http://localhost:8091/graphql \
  -H "Content-Type: application/json" \
  -d '{
    "query": "query { temporalHierarchy(rootCode: \"1000001\", asOfDate: \"2025-08-01\", maxDepth: 5) { code name level path hierarchyPath fullPathNames } }"
  }'
```

#### ç»„ç»‡å®Œæ•´è·¯å¾„æŸ¥è¯¢
```bash
curl -X POST http://localhost:8091/graphql \
  -H "Content-Type: application/json" \
  -d '{
    "query": "query { temporalPath(code: \"1000056\", asOfDate: \"2025-08-01\") { code name level path } }"
  }'
```

## âš¡ æ€§èƒ½æŒ‡æ ‡

### ä¼ä¸šçº§æ€§èƒ½ä¿è¯
- **å‘½ä»¤æ“ä½œå“åº”**: REST API < 1ç§’
- **æŸ¥è¯¢æ“ä½œå“åº”**: GraphQL < 100ms
- **CDCåŒæ­¥å»¶è¿Ÿ**: PostgreSQLâ†’Neo4j < 300ms
- **ç¼“å­˜å‘½ä¸­ç‡**: > 90%
- **å±‚çº§è®¡ç®—æ€§èƒ½**: 17çº§æ·±åº¦ < 50ms
- **å¹¶å‘å¤„ç†èƒ½åŠ›**: 1000+ TPS

### æ•°æ®ä¸€è‡´æ€§
- **å†™å…¥ä¸€è‡´æ€§**: PostgreSQLå¼ºä¸€è‡´æ€§ä¿è¯
- **è¯»å–ä¸€è‡´æ€§**: Neo4jæœ€ç»ˆä¸€è‡´æ€§ï¼Œå¯æ¥å—çŸ­æš‚å»¶è¿Ÿ
- **æ—¶æ€è¿ç»­æ€§**: è‡ªåŠ¨æ£€æŸ¥æ—¶é—´çº¿é—´éš™
- **æ•°æ®å®Œæ•´æ€§**: 100% CDCæ•°æ®åŒæ­¥éªŒè¯

## ğŸ›¡ï¸ ä¼ä¸šçº§ç‰¹æ€§

### 1. å¯æ‰©å±•æ€§
- **æ°´å¹³æ‰©å±•**: æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²
- **å­˜å‚¨æ‰©å±•**: PostgreSQLåˆ†åŒºè¡¨æ”¯æŒ
- **è®¡ç®—æ‰©å±•**: Neo4jé›†ç¾¤æ”¯æŒ
- **ç¼“å­˜æ‰©å±•**: Redisé›†ç¾¤æ”¯æŒ

### 2. å¯é æ€§
- **äº‹åŠ¡ä¿è¯**: ACIDäº‹åŠ¡æ”¯æŒ
- **å®¹é”™æ¢å¤**: KafkaæŒä¹…åŒ–æ¶ˆæ¯
- **å¥åº·æ£€æŸ¥**: å®Œæ•´çš„æœåŠ¡ç›‘æ§
- **ä¼˜é›…é™çº§**: ç¼“å­˜å¤±æ•ˆæ—¶çš„å¤‡ç”¨ç­–ç•¥

### 3. ç›‘æ§å¯è§‚æµ‹æ€§
- **æŒ‡æ ‡æ”¶é›†**: Prometheuså…¼å®¹æŒ‡æ ‡
- **æ—¥å¿—ç›‘æ§**: ç»“æ„åŒ–æ—¥å¿—è¾“å‡º
- **æ€§èƒ½è¿½è¸ª**: APIå“åº”æ—¶é—´ç›‘æ§
- **ä¸šåŠ¡ç›‘æ§**: ç»„ç»‡å˜æ›´äº‹ä»¶è¿½è¸ª

## ğŸ”® æŠ€æœ¯ä¼˜åŠ¿

### 1. ç¬¦åˆè¡Œä¸šæ ‡å‡†
- **HRè¡Œä¸šæ ‡å‡†**: çº¯æ—¥æœŸç”Ÿæ•ˆæ¨¡å‹
- **æ—¶æ€æ•°æ®æ¨¡å‹**: ç¬¦åˆISOæ ‡å‡†
- **APIè®¾è®¡**: RESTfulå’ŒGraphQLæœ€ä½³å®è·µ
- **æ•°æ®åº“è®¾è®¡**: æ ‡å‡†åŒ–æ—¶æ€è¡¨ç»“æ„

### 2. æ¶æ„æ¸…æ™°
- **èŒè´£åˆ†ç¦»**: è¯»å†™åˆ†ç¦»ï¼Œå„å¸å…¶èŒ
- **åè®®ç»Ÿä¸€**: å‘½ä»¤RESTï¼ŒæŸ¥è¯¢GraphQL
- **æ•°æ®æµæ¸…æ™°**: PostgreSQLâ†’CDCâ†’Neo4j
- **ç¼“å­˜ç­–ç•¥**: ç²¾ç¡®å¤±æ•ˆï¼Œæ€§èƒ½ä¼˜åŒ–

### 3. å¼€å‘å‹å¥½
- **ç±»å‹å®‰å…¨**: Goå¼ºç±»å‹ç³»ç»Ÿ
- **æ–‡æ¡£å®Œæ•´**: å®Œæ•´çš„APIæ–‡æ¡£å’Œç¤ºä¾‹
- **æµ‹è¯•è¦†ç›–**: å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **éƒ¨ç½²ç®€å•**: DockeråŒ–éƒ¨ç½²ï¼Œä¸€é”®å¯åŠ¨

## ğŸ¯ ä¸ç°æœ‰ç³»ç»Ÿé›†æˆ

### CQRSæ¶æ„å…¼å®¹
æœ¬æ—¶æ€ç®¡ç†ç³»ç»Ÿå®Œå…¨å…¼å®¹ç°æœ‰çš„CQRSæ¶æ„ï¼š

- **å‘½ä»¤ç«¯**: ä½¿ç”¨ç°æœ‰çš„`organization-command-service` (ç«¯å£9090)
- **æŸ¥è¯¢ç«¯**: ä½¿ç”¨ç°æœ‰çš„`organization-query-service-unified` (ç«¯å£8090)
- **æ—¶æ€æ‰©å±•**: æ–°å¢æ—¶æ€ä¸“ç”¨æœåŠ¡ï¼Œä¸å½±å“ç°æœ‰æœåŠ¡

### æ•°æ®è¿ç§»ç­–ç•¥
- **å¹³æ»‘è¿ç§»**: ç°æœ‰æ•°æ®è‡ªåŠ¨è½¬æ¢ä¸ºæ—¶æ€æ¨¡å‹
- **å‘åå…¼å®¹**: ç°æœ‰APIç»§ç»­å·¥ä½œ
- **æ¸è¿›å‡çº§**: å¯é€æ­¥å¯ç”¨æ—¶æ€åŠŸèƒ½
- **å›æ»šæ”¯æŒ**: æ”¯æŒå®Œæ•´çš„æ•°æ®å›æ»š

## ğŸ“š ç›¸å…³æ–‡æ¡£

### æŠ€æœ¯æ–‡æ¡£
- [æ•°æ®åº“è¿ç§»è„šæœ¬](../database/migrations/009_cqrs_temporal_optimization.sql)
- [Neo4jå›¾ç»“æ„](../database/neo4j/temporal_graph_schema.cypher)
- [APIè§„èŒƒæ–‡æ¡£](../docs/api/temporal-management-api.md)

### æœåŠ¡ä»£ç 
- [æ—¶æ€CDCåŒæ­¥æœåŠ¡](../cmd/organization-temporal-sync-service/main.go)
- [GraphQLæŸ¥è¯¢æœåŠ¡](../cmd/organization-temporal-query-service/main.go)
- [RESTå‘½ä»¤æœåŠ¡](../cmd/organization-temporal-rest-service/main.go)

### éƒ¨ç½²è„šæœ¬
- [å¯åŠ¨è„šæœ¬](../scripts/start-cqrs-complete.sh)
- [å¥åº·æ£€æŸ¥](../scripts/health-check-cqrs.sh)
- [CDCé…ç½®](../scripts/setup-cdc-pipeline.sh)

## ğŸš€ åç»­è·¯çº¿å›¾

### çŸ­æœŸç›®æ ‡ (1ä¸ªæœˆå†…)
1. **å‰ç«¯é›†æˆ**: Reactç»„ä»¶é›†æˆæ—¶æ€ç®¡ç†åŠŸèƒ½
2. **æ€§èƒ½ä¼˜åŒ–**: åŸºäºç›‘æ§æ•°æ®è¿›ä¸€æ­¥ä¼˜åŒ–
3. **å®‰å…¨åŠ å›º**: APIè®¿é—®æ§åˆ¶å’Œæ•°æ®åŠ å¯†

### ä¸­æœŸç›®æ ‡ (3ä¸ªæœˆå†…)
1. **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ—¶æ€æ“ä½œ
2. **å·¥ä½œæµé›†æˆ**: ç»„ç»‡å˜æ›´å®¡æ‰¹æµç¨‹
3. **æ•°æ®å¯¼å…¥å¯¼å‡º**: Excelå¯¼å…¥å¯¼å‡ºåŠŸèƒ½

### é•¿æœŸç›®æ ‡ (6ä¸ªæœˆå†…)
1. **å¤šç§Ÿæˆ·æ”¯æŒ**: å®Œæ•´çš„å¤šç§Ÿæˆ·éš”ç¦»
2. **AIé›†æˆ**: æ™ºèƒ½ç»„ç»‡æ¶æ„åˆ†æ
3. **å¯è§†åŒ–å¢å¼º**: æ—¶æ€å˜æ›´å¯è§†åŒ–

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»ä¿¡æ¯
- **é¡¹ç›®è·¯å¾„**: `/home/shangmeilin/cube-castle`
- **æ–‡æ¡£è·¯å¾„**: `/home/shangmeilin/cube-castle/docs`
- **ç›‘æ§è·¯å¾„**: `/home/shangmeilin/cube-castle/monitoring`

### ç»´æŠ¤è¯´æ˜
- **ç‰ˆæœ¬**: v1.0 - ä¼ä¸šçº§æ—¶æ€ç®¡ç†ç‰ˆ
- **æ›´æ–°æ—¥æœŸ**: 2025-08-12
- **ç»´æŠ¤çŠ¶æ€**: ç”Ÿäº§ç¯å¢ƒå°±ç»ª
- **å…¼å®¹æ€§**: å®Œå…¨å‘åå…¼å®¹ç°æœ‰CQRSæ¶æ„

---

## ğŸ‰ æ€»ç»“

æœ¬CQRSæ—¶æ€ç®¡ç†é‡æ„å®æ–½æ–¹æ¡ˆå®Œå…¨æ»¡è¶³äº†æ‚¨çš„éœ€æ±‚ï¼š

âœ… **æ—¥æœŸé¢—ç²’åº¦**: åŸºäº`effective_date`å’Œ`end_date`çš„çº¯æ—¥æœŸæ¨¡å‹  
âœ… **17çº§å±‚çº§**: Neo4jå›¾è®¡ç®—ï¼Œæ”¯æŒæ·±å±‚çº§ç»„ç»‡æ¶æ„  
âœ… **æ— é™å†å²ä¿ç•™**: å®Œæ•´çš„æ—¶æ€æ•°æ®å­˜å‚¨ï¼Œæ°¸ä¹…ä¿ç•™å˜æ›´å†å²  
âœ… **æœ€ç»ˆä¸€è‡´æ€§**: CDCå¼‚æ­¥åŒæ­¥ï¼Œå¯æ¥å—çŸ­æš‚å»¶è¿Ÿ  
âœ… **ç‰¹å®šæ—¥æœŸæŸ¥è¯¢**: ä¼˜åŒ–çš„`as_of_date`æŸ¥è¯¢æ€§èƒ½  

è¯¥æ–¹æ¡ˆæä¾›äº†ä¼ä¸šçº§çš„æ—¶æ€ç®¡ç†èƒ½åŠ›ï¼Œç¬¦åˆHRè¡Œä¸šæ ‡å‡†ï¼Œå…·å¤‡ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ¡ä»¶ã€‚é€šè¿‡CQRSæ¶æ„çš„æ¸…æ™°åˆ†ç¦»ï¼Œå®ç°äº†é«˜æ€§èƒ½ã€é«˜å¯é æ€§çš„æ—¶æ€æ•°æ®ç®¡ç†ï¼Œä¸ºæ‚¨çš„HRç³»ç»Ÿæä¾›äº†å¼ºå¤§çš„ç»„ç»‡æ¶æ„æ—¶æ€ç®¡ç†åŠŸèƒ½ã€‚